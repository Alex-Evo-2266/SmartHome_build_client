(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(21),r=n.n(i),s=(n(28),n(8)),l=Object(c.createContext)(),o=n(0),u=function(){var e=Object(c.useContext)(l),t=e.alert,n=e.hide;return Object(o.jsx)("div",{className:"alert ".concat(t.visible?"show":"hide"," alert-").concat(t.type),children:Object(o.jsxs)("div",{className:"div-alert-container",children:[Object(o.jsx)("p",{children:t.text}),Object(o.jsxs)("div",{className:"div-alert-btnConteiner",children:["function"===typeof t.Ok?Object(o.jsx)("button",{className:"normalSelection button",onClick:function(){t.Ok(),n()},children:"Yes"}):null,"function"===typeof t.Ok&&t.No?Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:function(){"function"===typeof t.No&&t.No(),n()},children:"No"}):Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:n,children:"Cancel"})]})]})})},d=Object(c.createContext)(),j=n(3),b=function(e){var t=e.hide,n=e.title,a=e.text,i=e.active,r=e.placeholder,s=Object(c.useState)(""),l=Object(j.a)(s,2),u=l[0],d=l[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:t}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:n}),Object(o.jsxs)("div",{className:"dialogBody",children:[Object(o.jsx)("p",{children:a}),Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{required:!0,type:"text",name:"input",value:u,onChange:function(e){d(e.target.value)}}),Object(o.jsx)("label",{children:r})]})]}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){"function"===typeof i&&i(u),t()},children:"ok"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:t,children:"cancel"})]})]})]})},m=function(e){var t=e.title,n=e.hide,a=e.active,i=e.items,r=e.buttons,s=e.activeText,l=Object(c.useState)(""),u=Object(j.a)(l,2),d=u[0],b=u[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:n}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:t}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody scroll",children:null===i||void 0===i?void 0:i.map((function(e,t){return Object(o.jsxs)("label",{className:"dialogItem",children:[Object(o.jsx)("input",{type:"radio",name:"data",value:e.data,checked:d===e.data,onChange:function(){return b(e.data)}}),Object(o.jsx)("p",{children:e.title})]},t)}))}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[null===r||void 0===r?void 0:r.map((function(e,t){return Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:e.action,children:e.title},t)})),r?null:Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:n,children:"CANCEL"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){"function"===typeof a&&a(d)},disabled:""===d,children:s||"OK"})]})]})]})},v=function(e){var t=e.hide,n=e.text,c=e.title,a=e.buttons;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:t}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:c}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsx)("p",{children:n})}),Object(o.jsx)("div",{className:"dialogFooter",onClick:t,children:null===a||void 0===a?void 0:a.map((function(e,t){return Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:e.action,children:e.title},t)}))})]})]})},O=function(){var e=Object(c.useContext)(d),t=e.dialog,n=e.hide;return t.visible?"alert"===t.type?Object(o.jsx)(v,{hide:n,text:t.text,title:t.title,buttons:t.buttons}):"text"===t.type?Object(o.jsx)(b,{hide:n,text:t.text,title:t.title,active:t.active,placeholder:t.placeholder}):"confirmation"===t.type?Object(o.jsx)(m,{hide:n,text:t.text,title:t.title,active:t.active,items:t.items}):null:null},f=n(4),h=n.n(f),x=n(5),p=n(7),g=Object(c.createContext)();function y(){}var N,A,k,C,w,E=Object(c.createContext)({token:null,userId:null,userLavel:null,login:y,logout:y,isAuthenticated:!1}),B=function(){var e=Object(c.useContext)(E),t=Object(c.useState)(!1),n=Object(j.a)(t,2),a=n[0],i=n[1],r=Object(c.useState)(null),s=Object(j.a)(r,2),l=s[0],o=s[1],u=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/auth/refresh",{method:"GET",body:null,headers:{}});case 2:return n=t.sent,t.next=5,n.json();case 5:if(c=t.sent,n.ok){t.next=9;break}throw e.logout(),new Error(c.message||"\u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 9:return t.next=11,e.login(c.token,c.userId,c.userLavel);case 11:return t.abrupt("return",c.token);case 12:case"end":return t.stop()}}),t)}))),[e]),d=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var n,c,a,r,s,l,d,j=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j.length>1&&void 0!==j[1]?j[1]:"GET",c=j.length>2&&void 0!==j[2]?j[2]:null,a=j.length>3&&void 0!==j[3]?j[3]:{},r=j.length>4&&void 0!==j[4]&&j[4],i(!0),e.prev=5,a.Authorization&&(a["Authorization-Token"]=a.Authorization),c&&!r&&(a["Content-Type"]="application/json",c=JSON.stringify(c)),e.next=10,fetch(t,{method:n,body:c,headers:a});case 10:if(401!==(s=e.sent).status){e.next=19;break}return e.next=14,u();case 14:return l=e.sent,a["Authorization-Token"]="Bearer ".concat(l),e.next=18,fetch(t,{method:n,body:c,headers:a});case 18:s=e.sent;case 19:return e.next=21,s.json();case 21:if(d=e.sent,s.ok){e.next=24;break}throw new Error(d.message||"\u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 24:return i(!1),e.abrupt("return",d);case 28:e.prev=28,e.t0=e.catch(5),i(!1),o(e.t0.message);case 32:case"end":return e.stop()}}),e,null,[[5,28]])})));return function(t){return e.apply(this,arguments)}}(),[u]);return{loading:a,request:d,error:l,clearError:Object(c.useCallback)((function(){o(null)}),[])}},S=Object(c.createContext)(),D=function(e){var t=e.type,n=e.action,c=e.big;e.title;return Object(o.jsx)("div",{className:"specialActionButton ".concat(c?"big":""),onClick:n,children:"config"===t?Object(o.jsx)("i",{className:"fas fa-cog"}):"ok"===t?Object(o.jsx)("i",{className:"fas fa-check"}):"close"===t?Object(o.jsx)("i",{className:"fas fa-times"}):Object(o.jsx)("i",{className:"fas fa-plus"})})},T=function(e){var t=e.hide,n=(e.show,e.visible),a=e.insluedField,i=e.otherField,r=(e.user,Object(c.useContext)(E));return Object(o.jsxs)(o.Fragment,{children:[n?Object(o.jsx)("div",{className:"backGlass",onClick:function(){t()},style:{zIndex:96}}):null,Object(o.jsxs)("div",{onClick:function(e){e.target.closest("li[data-el=sub]")||t()},className:"navigationRail ".concat(n?"active":""),children:[Object(o.jsxs)("ul",{className:"baseMenu",children:[Object(o.jsx)("li",{children:Object(o.jsxs)(s.c,{to:"/home",children:[Object(o.jsx)("i",{className:"fas fa-home"}),Object(o.jsx)("span",{children:"Home"})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)(s.c,{to:"/devices",children:[Object(o.jsx)("i",{className:"fas fa-plug"}),Object(o.jsx)("span",{children:"Devices"})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)(s.c,{to:"/config",children:[Object(o.jsx)("i",{className:"fas fa-cogs"}),Object(o.jsx)("span",{children:"Options"})]})}),a?a.map((function(e,t){var n=e.url.indexOf("/");return Object(o.jsx)("li",{children:0!==n?Object(o.jsxs)("a",{href:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]}):Object(o.jsxs)(s.c,{to:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]})},t)})):null]}),n?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("ul",{className:"otherMenu",children:i?i.map((function(e,t){var n=e.url.indexOf("/");return Object(o.jsx)("li",{children:0!==n?Object(o.jsxs)("a",{href:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]}):Object(o.jsxs)(s.c,{to:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]})},t)})):null}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("ul",{className:"otherMenu",children:Object(o.jsx)("li",{children:Object(o.jsxs)("button",{className:"menu-btn",onClick:r.logout,children:[Object(o.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(o.jsx)("span",{children:"logout"})]})})})]}):null]})]})},q=function(e){var t,n=e.item,a=e.hide,i=Object(c.useState)(!1),r=Object(j.a)(i,2),s=r[0],l=r[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"contextmenuElement",onClick:function(e){n.sub?l(!s):a(),"function"===typeof n.onClick&&n.onClick(e)},children:[Object(o.jsx)("span",{className:"state",children:n.active?Object(o.jsx)("i",{className:"fas fa-check"}):n.sub?Object(o.jsx)("i",{className:"fas fa-chevron-left"}):null}),Object(o.jsx)("span",{className:"content",children:n.title})]}),s&&n.sub?Object(o.jsx)("div",{className:"contextSubMenu",children:null===(t=n.sub)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsxs)("div",{className:"contextmenuElement",onClick:e.onClick,children:[Object(o.jsx)("span",{className:"state",children:e.active?Object(o.jsx)("i",{className:"fas fa-check"}):null}),Object(o.jsx)("span",{className:"content",children:e.title})]},t)}))}):null]})},L=function(e){var t=e.buttons,n=void 0===t?[]:t,c=e.className,a=e.style,i=e.hide;return 0===(null===n||void 0===n?void 0:n.length)?null:Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsx)("div",{style:a,className:"contextmenu show ".concat(c),children:n.map((function(e,t){return"dividers"===e.type?Object(o.jsx)("div",{className:"dividers"},t):Object(o.jsx)(q,{item:e,hide:i},t)}))})]})},I=function(e){var t=e.buttons,n=void 0===t?[]:t,a=e.className,i=Object(c.useState)(!1),r=Object(j.a)(i,2),s=r[0],l=r[1];return 0===(null===n||void 0===n?void 0:n.length)?null:Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"menuTogleBtn",onClick:function(){return l(!s)},children:Object(o.jsx)("i",{className:"fas fa-ellipsis-v"})}),s?Object(o.jsx)(L,{hide:function(){return l(!1)},buttons:n,className:a}):null]})},F=function(e){var t=e.buttons,n=Object(c.useRef)(null),a=function(e){e.preventDefault()};return Object(o.jsx)("div",{ref:n,className:"tabsConteiner",children:Object(o.jsx)("div",{className:"tabs",children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(o.jsx)("div",{onContextMenu:a,className:"tabButton ".concat(e.active?"active":""),onClick:e.action,children:e.title},t)}))})})},z=function(e){var t=e.title,n=e.togle,c=e.buttons,a=e.controlButtons;return Object(o.jsxs)("div",{className:"topMenu",children:[n?Object(o.jsx)("div",{className:"burger",onClick:n,children:Object(o.jsx)("i",{className:"fas fa-bars"})}):null,Object(o.jsx)("h2",{children:t}),Object(o.jsx)(F,{buttons:c}),Object(o.jsxs)("div",{className:"controlConteiner",children:[(null===a||void 0===a?void 0:a.search)?Object(o.jsx)("div",{className:"search",onClick:a.search.togle,children:Object(o.jsx)("i",{className:"fas fa-search"})}):null,(null===a||void 0===a?void 0:a.dopmenu)?Object(o.jsx)(I,{buttons:a.dopmenu}):null]})]})},P=function(e){var t=e.hide,n=e.togle,a=e.visible,i=e.insluedField,r=e.controlButtons,l=e.otherField,u=Object(c.useRef)(null),d=Object(c.useContext)(E);return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{onClick:function(){u.current&&(u.current.scrollTop=0),t()},ref:u,className:"bottomMenuAll ".concat(a?"show":""),children:[Object(o.jsx)("div",{style:{height:"50vh",weight:"100%"}}),Object(o.jsxs)("ul",{className:"baseMenu",children:[Object(o.jsx)("li",{children:Object(o.jsxs)(s.c,{to:"/devices",children:[Object(o.jsx)("i",{className:"fas fa-plug"}),Object(o.jsx)("span",{children:"Devices"})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)(s.c,{to:"/config",children:[Object(o.jsx)("i",{className:"fas fa-cogs"}),Object(o.jsx)("span",{children:"Options"})]})}),i?i.map((function(e,t){var n=e.url.indexOf("/");return Object(o.jsx)("li",{children:0!==n?Object(o.jsxs)("a",{href:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]}):Object(o.jsxs)(s.c,{to:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]})},t)})):null,l?l.map((function(e,t){var n=e.url.indexOf("/");return Object(o.jsx)("li",{children:0!==n?Object(o.jsxs)("a",{href:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]}):Object(o.jsxs)(s.c,{to:e.url,children:[Object(o.jsx)("i",{className:e.iconClass}),Object(o.jsx)("span",{children:e.title})]})},t)})):null,Object(o.jsx)("li",{children:Object(o.jsxs)("button",{className:"menu-btn",onClick:d.logout,children:[Object(o.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(o.jsx)("span",{children:"logout"})]})})]})]}),Object(o.jsxs)("div",{className:"bottomMenu",children:[Object(o.jsx)("div",{className:"burger",onClick:n,children:Object(o.jsx)("i",{className:"fas fa-bars"})}),Object(o.jsx)("div",{className:"item",children:Object(o.jsx)(s.c,{to:"/home",children:Object(o.jsx)("i",{className:"fas fa-home"})})}),Object(o.jsxs)("div",{className:"controlConteiner",children:[(null===r||void 0===r?void 0:r.search)?Object(o.jsx)("div",{className:"search",onClick:r.search.togle,children:Object(o.jsx)("i",{className:"fas fa-search"})}):null,(null===r||void 0===r?void 0:r.dopmenu)?Object(o.jsx)(I,{className:"bottom",buttons:r.dopmenu}):null]})]})]})},M=[{title:"Scripts",iconClass:"fas fa-code-branch",url:"/scripts"},{title:"Nas",iconClass:"fas fa-hdd",url:"/nas"},{title:"MQTT",iconClass:"fas fa-network-wired",url:"/mqtt"},{title:"zigbee2mqtt",iconClass:"fas fa-network-wired",url:"/zigbee2mqtt"},{title:"profile",iconClass:"fas fa-user",url:"/profile"},{title:"Gallery",iconClass:"fas fa-images",url:"/gallery"},{title:"Terminal",iconClass:"fas fa-terminal",url:"/terminal"},{title:"Groups",iconClass:"fas fa-object-group",url:"/groups"},{title:"Rooms",iconClass:"fab fa-buromobelexperte",url:"/rooms"},{title:"Users",iconClass:"fas fa-users",url:"/users"}],U=function(){var e=Object(c.useContext)(g),t=B().request,n=Object(c.useContext)(S),a=Object(c.useContext)(E),i=Object(c.useContext)(d),r=Object(c.useState)({UserName:"",UserSurname:"",Mobile:"",Email:"",ImageId:""}),s=Object(j.a)(r,2),l=s[0],u=s[1],b=Object(c.useState)(""),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)(!1),y=Object(j.a)(f,2),N=y[0],A=y[1],k=Object(c.useState)([]),C=Object(j.a)(k,2),w=C[0],q=C[1],L=Object(c.useState)([]),I=Object(j.a)(L,2),F=I[0],U=I[1],G=Object(c.useState)(window.innerWidth),R=Object(j.a)(G,2),H=R[0],Y=R[1];Object(c.useEffect)((function(){function e(e){Y(e.target.innerWidth)}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var V=Object(c.useCallback)((function(e){var t,n=[],c=M.slice(),a=Object(p.a)(e);try{var i=function(){var e=t.value;c=c.filter((function(t){return t.title!==e.title})),n.push(e)};for(a.s();!(t=a.n()).done;)i()}catch(r){a.e(r)}finally{a.f()}return{include:n,other:c}}),[]);Object(c.useEffect)((function(){if(n.MenuElements){var e=V(n.MenuElements);q(e.include),U(e.other)}}),[n.MenuElements,V]);var K,J,W,_,Q,X,Z,$,ee,te,ne=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/user/get","GET",null,{Authorization:"Bearer ".concat(a.token)});case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:u({UserName:n.UserName,UserSurname:n.UserSurname,Mobile:n.Mobile,Email:n.Email,ImageId:n.ImageId});case 6:case"end":return e.stop()}}),e)}))),[t,a.token]);return Object(c.useEffect)((function(){ne()}),[ne]),H>700?Object(o.jsxs)(o.Fragment,{children:[(null===(K=e.menu.specialAction)||void 0===K?void 0:K.type)?Object(o.jsx)(D,{title:(null===(J=e.menu.specialAction)||void 0===J?void 0:J.title)||(null===(W=e.menu.specialAction)||void 0===W?void 0:W.type),type:null===(_=e.menu.specialAction)||void 0===_?void 0:_.type,action:null===(Q=e.menu.specialAction)||void 0===Q?void 0:Q.action}):null,Object(o.jsx)(z,{title:e.menu.title,togle:e.togle,controlButtons:{search:e.menu.search?{togle:function(){return A(!N)}}:null,dopmenu:e.menu.dopmenu},buttons:e.menu.buttons}),e.menu.search?Object(o.jsx)("div",{className:"toolbarConteainer ".concat(N?"show":"hide"),children:Object(o.jsxs)("div",{className:"search",children:[Object(o.jsx)("button",{onClick:function(){return A(!1)},className:"backBtn",children:Object(o.jsx)("i",{className:"fas fa-arrow-left"})}),Object(o.jsx)("input",{placeholder:"search",type:"search",name:"search",onChange:function(e){O(e.target.value)},onKeyDown:function(t){13===t.keyCode&&"function"===typeof e.menu.search&&e.menu.search(v)},value:v})]})}):null,Object(o.jsx)(T,{user:l,hide:e.hide,show:e.show,visible:e.menu.visible,insluedField:w,otherField:F})]}):Object(o.jsxs)(o.Fragment,{children:[(null===(X=e.menu.specialAction)||void 0===X?void 0:X.type)?Object(o.jsx)(D,{title:(null===(Z=e.menu.specialAction)||void 0===Z?void 0:Z.title)||(null===($=e.menu.specialAction)||void 0===$?void 0:$.type),big:e.menu.visible,type:null===(ee=e.menu.specialAction)||void 0===ee?void 0:ee.type,action:null===(te=e.menu.specialAction)||void 0===te?void 0:te.action}):null,e.menu.buttons?Object(o.jsx)(z,{buttons:e.menu.buttons}):null,Object(o.jsx)(P,{hide:e.hide,togle:e.togle,visible:e.menu.visible,insluedField:w,otherField:F,controlButtons:{search:e.menu.search?{togle:function(){return t=e.menu.search,N?i.hide():i.show("text",{title:"Search",placeholder:"name",active:function(e){"function"===typeof t&&t(e),A(!1)}}),void A(!N);var t}}:null,dopmenu:e.menu.dopmenu}})]})},G=Object(c.createContext)(),R=n(2),H=function(e){var t=e.style;return Object(o.jsxs)("div",{className:"loader",style:Object(R.a)({},t),children:[Object(o.jsx)("div",{className:"face face1",children:Object(o.jsx)("div",{className:"circle"})}),Object(o.jsx)("div",{className:"face face2",children:Object(o.jsx)("div",{className:"circle"})})]})},Y=function(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(c.useContext)(l),r=i.show,s=i.hide,o=Object(c.useCallback)((function(e,t,n,c){e&&(a(e),r(e,t,n,c))}),[r]),u=function(){a(""),s()};return{message:o,Message:n,clearMessage:u}},V=n(6),K=function(e){var t=e.children,n=e.title,a=e.show,i=void 0!==a&&a,r=Object(c.useState)(i),s=Object(j.a)(r,2),l=s[0],u=s[1];return Object(o.jsxs)("li",{name:"HidingLi",className:"hidingLi ".concat(l?"show":"hide"),onClick:function(e){"hidingLi"!==e.target.className.split(" ")[0]&&"hidingLi"!==e.target.parentNode.className.split(" ")[0]||u(!l)},children:[Object(o.jsx)("h3",{value:"HidingLi",className:"LiTitle",children:n}),Object(o.jsx)("i",{value:"HidingLi",className:"iconLI fas fa-chevron-down"}),Object(o.jsx)("div",{className:"LiContent",children:t})]})},J=["fas fa-lightbulb","far fa-lightbulb","fas fa-adjust","fas fa-bath","fas fa-sun","fas fa-broadcast-tower","fas fa-cog","fas fa-bell","fas fa-bolt","fas fa-city","fas fa-home","fas fa-desktop","fas fa-moon","fas fa-power-off","fas fa-rss","fas fa-door-closed","fas fa-door-open","fas fa-cogs","fas fa-circle-notch"],W=function(e){var t=e.value,n=e.onChange,a=e.dataId,i=Object(c.useState)(!1),r=Object(j.a)(i,2),s=r[0],l=r[1],u=function(e){n(e.target.dataset.val,a)};return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data-icon",onClick:function(){return l(!s)},children:[Object(o.jsxs)("div",{className:"IconChooseflex",children:[Object(o.jsx)("p",{children:"icon"}),Object(o.jsx)("div",{className:"iconEl",children:Object(o.jsx)("i",{className:t})})]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"chooseIcon ".concat(s?"show":""),children:Object(o.jsx)("div",{className:"iconConteiner",children:J.map((function(e,t){return Object(o.jsx)("div",{"data-id":a,onClick:u,"data-val":e,className:"iconEl",children:Object(o.jsx)("i",{className:e})},t)}))})})]})})})},_=function(e){var t=e.deviceData,n=e.hide,a=e.type,i=void 0===a?"edit":a,r=Object(c.useContext)(E),s=Y().message,l={USText:function(e){for(var t="1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;n<e.length;n++){for(var c=!1,a=0;a<t.length;a++)if(t[a]===e[n]){c=!0;break}if(!c)return!1}return!0}}.USText,u=B(),d=u.request,b=u.error,m=u.clearError;Object(c.useEffect)((function(){return s(b,"error"),function(){m()}}),[b,s,m]);var v=Object(c.useState)({information:t.information,name:t.name,systemName:t.systemName,newSystemName:t.systemName,type:t.type,address:t.address,typeConnect:t.typeConnect,RoomId:t.RoomId}),O=Object(j.a)(v,2),f=O[0],p=O[1],g=Object(c.useState)(t.fields||[]),y=Object(j.a)(g,2),N=y[0],A=y[1],k=function(e,t){var n=t,c=N.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,A(c)},C=function(e){p(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.value)))},w=function(){var e=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(R.a)(Object(R.a)({},f),{},{fields:N}),"edit"!==i){e.next=6;break}return e.next=4,d("/api/device/edit","POST",Object(R.a)({},t),{Authorization:"Bearer ".concat(r.token)});case 4:e.next=9;break;case 6:if("link"!==i){e.next=9;break}return e.next=9,d("/api/device/add","POST",Object(R.a)({},t),{Authorization:"Bearer ".concat(r.token)});case 9:n();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s("All dependent scripts and controls will be removed along with the device. Delete?","general",Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("/api/device/delete/".concat(f.systemName),"POST",null,{Authorization:"Bearer ".concat(r.token)});case 2:n();case 3:case"end":return e.stop()}}),e)}))),"no");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("ul",{className:"editDevice",children:[Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Type - ".concat(f.type)}),Object(o.jsx)("h5",{children:"Type connect - ".concat(f.typeConnect)})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Name"}),Object(o.jsx)("input",{className:"textInput",placeholder:"name",id:"name",type:"text",name:"name",value:f.name,onChange:C,required:!0})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"System name"}),Object(o.jsx)("input",{className:"textInput",placeholder:"system name",id:"newSystemName",type:"text",name:"newSystemName",value:f.newSystemName,onChange:function(e){l(e.target.value)?C(e):s("forbidden symbols","error")},required:!0})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Address"}),Object(o.jsx)("input",{className:"textInput",placeholder:"address",id:"address",type:"text",name:"address",value:f.address,onChange:C,required:!0})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"information"}),Object(o.jsx)("input",{className:"textInput",placeholder:"information",id:"information",type:"text",name:"information",value:f.information,onChange:C,required:!0})]})}),N.map((function(e,t){return Object(o.jsx)(K,{title:e.name,children:Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:k})},t)})),Object(o.jsxs)("div",{className:"controlForm",children:["edit"===i?Object(o.jsx)("button",{className:"formEditBtn Delete",onClick:S,children:"Delete"}):null,Object(o.jsx)("button",{className:"formEditBtn",onClick:w,children:"Save"})]})]})},Q=function(e){var t=e.deviceData,n=e.hide,a=e.type,i=void 0===a?"edit":a,r=Object(c.useContext)(E),s=Y().message,l={USText:function(e){for(var t="1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;n<e.length;n++){for(var c=!1,a=0;a<t.length;a++)if(t[a]===e[n]){c=!0;break}if(!c)return!1}return!0}}.USText,u=B(),d=u.request,b=u.error,m=u.clearError;Object(c.useEffect)((function(){return s(b,"error"),function(){m()}}),[b,s,m]);var v=Object(c.useState)({information:t.information||"",name:t.name||"",systemName:t.systemName||"",newSystemName:t.systemName||"",type:t.type||"other",valueType:t.valueType||"json",address:t.address||"",typeConnect:t.typeConnect||"mqtt",RoomId:t.RoomId}),O=Object(j.a)(v,2),f=O[0],g=O[1],y=Object(c.useState)(t.fields||[]),N=Object(j.a)(y,2),A=N[0],k=N[1],C=Object(c.useState)(t.fields.length),w=Object(j.a)(C,2),S=w[0],D=w[1];Object(c.useEffect)((function(){console.log(A)}),[A]);var T=function(e){g(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.value)))},q=function(e){var t=e.target.dataset.id,n=A.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.value));n[t]=c,k(n)},L=function(e,t){var n=t,c=A.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,k(c)};function I(){if(!f.systemName||!f.valueType||!f.name||!f.type||!f.typeConnect)return!1;if(!A||!A[0])return!1;var e,t=Object(p.a)(A);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!(null===n||void 0===n?void 0:n.type))return!1}}catch(c){t.e(c)}finally{t.f()}return!0}var F=function(){var e,t=[],n=Object(p.a)(A);try{for(n.s();!(e=n.n()).done;){var c,a=e.value,i=Object(p.a)(t);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(a.name===r)return s("\u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u043b\u044f","error"),!1}}catch(l){i.e(l)}finally{i.f()}t.push(a.name)}}catch(l){n.e(l)}finally{n.f()}return!0},z=function(){var e=Object(x.a)(h.a.mark((function e(){var t,c,a,l,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I()){e.next=2;break}return e.abrupt("return",s("\u043d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b","error"));case 2:if(F()){e.next=4;break}return e.abrupt("return");case 4:t=[],c=Object(p.a)(A);try{for(c.s();!(a=c.n()).done;)(l=a.value).address&&t.push(l)}catch(u){c.e(u)}finally{c.f()}if(o=Object(R.a)(Object(R.a)({},f),{},{fields:t}),"edit"!==i){e.next=13;break}return e.next=11,d("/api/device/edit","POST",Object(R.a)({},o),{Authorization:"Bearer ".concat(r.token)});case 11:e.next=16;break;case 13:if("link"!==i){e.next=16;break}return e.next=16,d("/api/device/add","POST",Object(R.a)({},o),{Authorization:"Bearer ".concat(r.token)});case 16:n();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s("All dependent scripts and controls will be removed along with the device. Delete?","general",Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("/api/device/delete/".concat(f.systemName),"POST",null,{Authorization:"Bearer ".concat(r.token)});case 2:n();case 3:case"end":return e.stop()}}),e)}))),"no");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("ul",{className:"editDevice",children:[Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Type - ".concat(f.type)}),Object(o.jsx)("h5",{children:"Type connect - ".concat(f.typeConnect)})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"name",type:"text",value:f.name}),Object(o.jsx)("label",{children:"Name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){l(e.target.value)?T(e):s("forbidden symbols","error")},required:!0,name:"newSystemName",type:"text",value:f.newSystemName}),Object(o.jsx)("label",{children:"System name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{name:"valueType",value:f.valueType,onChange:T,children:[Object(o.jsx)("option",{value:"json",children:"json"}),Object(o.jsx)("option",{value:"value",children:"value"})]}),Object(o.jsx)("label",{children:"Type value"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"information",type:"text",value:f.information}),Object(o.jsx)("label",{children:"Information"})]})}),A.map((function(e,t){return Object(o.jsxs)(K,{title:e.name,children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"name",value:e.name,onChange:q,required:!0}),Object(o.jsx)("label",{children:"name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{"data-id":t,name:"type",value:e.type,onChange:q,children:[Object(o.jsx)("option",{value:"binary",children:"binary"}),Object(o.jsx)("option",{value:"text",children:"text"}),Object(o.jsx)("option",{value:"number",children:"number"}),Object(o.jsx)("option",{value:"enum",children:"enum"})]}),Object(o.jsx)("label",{children:"type"})]})}),"number"===e.type||"binary"===e.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"low",value:e.low,onChange:q,required:!0}),Object(o.jsx)("label",{children:"min"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"high",value:e.high,onChange:q,required:!0}),Object(o.jsx)("label",{children:"max"})]})})]}):"enum"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"values",value:e.values,onChange:q,required:!0}),Object(o.jsx)("label",{children:"enum"})]})}):null,Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:L}),"number"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,name:"unit",value:e.unit,onChange:q,required:!0}),Object(o.jsx)("label",{children:"unit"})]})}):null,Object(o.jsx)("label",{children:Object(o.jsx)("button",{className:"delField",onClick:function(){return function(e){var t=A.slice();t=(t=t.filter((function(t,n){return e!==n}))).map((function(e,t){return Object(R.a)(Object(R.a)({},e),{},{type:"c"+t})})),D((function(e){return e-1})),k(t)}(t)},children:"delete"})})]},t)})),Object(o.jsx)("li",{children:Object(o.jsx)("button",{className:"addField",onClick:function(){var e=A.slice();e.push({address:"field"+S,name:"field"+S,type:"text",low:"0",high:"100",values:"",control:!0,icon:"",unit:""}),D((function(e){return e+1})),k(e)},children:"add"})}),Object(o.jsxs)("div",{className:"controlForm",children:["edit"===i?Object(o.jsx)("button",{className:"formEditBtn Delete",onClick:P,children:"Delete"}):null,Object(o.jsx)("button",{className:"formEditBtn",onClick:z,children:"Save"})]})]})},X=function(e){var t=e.deviceData,n=e.hide,a=e.type,i=void 0===a?"edit":a,r=Object(c.useContext)(E),s=Y().message,l={USText:function(e){for(var t="1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;n<e.length;n++){for(var c=!1,a=0;a<t.length;a++)if(t[a]===e[n]){c=!0;break}if(!c)return!1}return!0}}.USText,u=B(),d=u.request,b=u.error,m=u.clearError;Object(c.useEffect)((function(){return s(b,"error"),function(){m()}}),[b,s,m]);var v=Object(c.useState)({information:t.information||"",name:t.name||"",systemName:t.systemName||"",newSystemName:t.systemName||"",type:t.type||"other",valueType:t.valueType||"json",address:t.address||"",typeConnect:t.typeConnect||"mqtt",RoomId:t.RoomId}),O=Object(j.a)(v,2),f=O[0],g=O[1],y=Object(c.useState)(t.fields||[]),N=Object(j.a)(y,2),A=N[0],k=N[1],C=Object(c.useState)(t.fields.length),w=Object(j.a)(C,2),S=w[0],D=w[1];Object(c.useEffect)((function(){console.log(A)}),[A]);var T=function(e){g(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.value)))},q=function(e){var t=e.target.dataset.id,n=A.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.value));n[t]=c,k(n)},L=function(e,t){var n=t,c=A.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,k(c)},I=function(e){var t=e.target.dataset.id,n=A.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.checked));n[t]=c,k(n)};function F(){if(!f.systemName&&"link"!==i||!f.newSystemName||!f.valueType||!f.address||!f.name||!f.type||!f.typeConnect)return!1;if(!A||!A[0])return!1;var e,t=Object(p.a)(A);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!(null===n||void 0===n?void 0:n.type)||!(null===n||void 0===n?void 0:n.address))return!1}}catch(c){t.e(c)}finally{t.f()}return!0}var z=function(){var e,t=[],n=Object(p.a)(A);try{for(n.s();!(e=n.n()).done;){var c,a=e.value,i=Object(p.a)(t);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(a.name===r)return s("\u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u043b\u044f","error"),!1}}catch(l){i.e(l)}finally{i.f()}t.push(a.name)}}catch(l){n.e(l)}finally{n.f()}return!0},P=function(){var e=Object(x.a)(h.a.mark((function e(){var t,c,a,l,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F()){e.next=2;break}return e.abrupt("return",s("\u043d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b","error"));case 2:if(z()){e.next=4;break}return e.abrupt("return");case 4:t=[],c=Object(p.a)(A);try{for(c.s();!(a=c.n()).done;)(l=a.value).address&&t.push(l)}catch(u){c.e(u)}finally{c.f()}if(o=Object(R.a)(Object(R.a)({},f),{},{fields:t}),"edit"!==i){e.next=13;break}return e.next=11,d("/api/device/edit","POST",Object(R.a)({},o),{Authorization:"Bearer ".concat(r.token)});case 11:e.next=17;break;case 13:if("link"!==i){e.next=17;break}return o.systemName=o.newSystemName,e.next=17,d("/api/device/add","POST",Object(R.a)({},o),{Authorization:"Bearer ".concat(r.token)});case 17:n();case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s("All dependent scripts and controls will be removed along with the device. Delete?","general",Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("/api/device/delete/".concat(f.systemName),"POST",null,{Authorization:"Bearer ".concat(r.token)});case 2:n();case 3:case"end":return e.stop()}}),e)}))),"no");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("ul",{className:"editDevice",children:[Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Type - ".concat(f.type)}),Object(o.jsx)("h5",{children:"Type connect - ".concat(f.typeConnect)})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"name",type:"text",value:f.name}),Object(o.jsx)("label",{children:"Name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){l(e.target.value)?T(e):s("forbidden symbols","error")},required:!0,name:"newSystemName",type:"text",value:f.newSystemName}),Object(o.jsx)("label",{children:"System name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"address",type:"text",value:f.address}),Object(o.jsx)("label",{children:"Address"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{name:"valueType",value:f.valueType,onChange:T,children:[Object(o.jsx)("option",{value:"json",children:"json"}),Object(o.jsx)("option",{value:"value",children:"value"})]}),Object(o.jsx)("label",{children:"Type value"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"information",type:"text",value:f.information}),Object(o.jsx)("label",{children:"Information"})]})}),A.map((function(e,t){return Object(o.jsxs)(K,{title:e.name,children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"name",value:e.name,onChange:q,required:!0}),Object(o.jsx)("label",{children:"name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"address",value:e.address,onChange:q,required:!0}),Object(o.jsx)("label",{children:"address"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{"data-id":t,name:"type",value:e.type,onChange:q,children:[Object(o.jsx)("option",{value:"binary",children:"binary"}),Object(o.jsx)("option",{value:"text",children:"text"}),Object(o.jsx)("option",{value:"number",children:"number"}),Object(o.jsx)("option",{value:"enum",children:"enum"})]}),Object(o.jsx)("label",{children:"type"})]})}),Object(o.jsx)("div",{className:"configElement",style:{justifyContent:"center"},children:Object(o.jsxs)("div",{className:"checkbox-btn",children:[Object(o.jsx)("input",{"data-id":t,type:"checkbox",name:"control",checked:Boolean(e.control),onChange:I,required:!0}),Object(o.jsx)("div",{children:Object(o.jsx)("span",{className:"slide"})})]})}),"number"===e.type||"binary"===e.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"low",value:e.low,onChange:q,required:!0}),Object(o.jsx)("label",{children:"min"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"high",value:e.high,onChange:q,required:!0}),Object(o.jsx)("label",{children:"max"})]})})]}):"enum"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"values",value:e.values,onChange:q,required:!0}),Object(o.jsx)("label",{children:"enum"})]})}):null,Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:L}),"number"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,name:"unit",value:e.unit,onChange:q,required:!0}),Object(o.jsx)("label",{children:"unit"})]})}):null,Object(o.jsx)("label",{children:Object(o.jsx)("button",{className:"delField",onClick:function(){return function(e){var t=A.slice();t=(t=t.filter((function(t,n){return e!==n}))).map((function(e,t){return Object(R.a)(Object(R.a)({},e),{},{type:"c"+t})})),D((function(e){return e-1})),k(t)}(t)},children:"delete"})})]},t)})),Object(o.jsx)("li",{children:Object(o.jsx)("button",{className:"addField",onClick:function(){var e=A.slice();e.push({address:"field"+S,name:"field"+S,type:"text",low:"0",high:"100",values:"",control:!0,icon:"",unit:""}),D((function(e){return e+1})),k(e)},children:"add"})}),Object(o.jsxs)("div",{className:"controlForm",children:["edit"===i?Object(o.jsx)("button",{className:"formEditBtn Delete",onClick:M,children:"Delete"}):null,Object(o.jsx)("button",{className:"formEditBtn",onClick:P,children:"Save"})]})]})},Z=function(e){var t=Object(c.useContext)(E),n=Y().message,a=B(),i=a.loading,r=a.request,s=a.error,l=a.clearError,u=Object(c.useState)(),d=Object(j.a)(u,2),b=d[0],m=d[1],v=Object(c.useCallback)(Object(x.a)(h.a.mark((function n(){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r("/api/device/get/".concat(e.systemName),"GET",null,{Authorization:"Bearer ".concat(t.token)});case 2:c=n.sent,console.log(c),m(c);case 5:case"end":return n.stop()}}),n)}))),[r,t.token,e.systemName]);return Object(c.useEffect)((function(){v()}),[v]),Object(c.useEffect)((function(){return n(s,"error"),function(){l()}}),[s,n,l]),i||!b?Object(o.jsx)(H,{}):"Mqtt_MQTTDevice"===b.typeConnect||"Zigbee_ZigbeeDevice"===b.typeConnect?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(X,{deviceData:b,hide:e.hide})})}):"Yeelight_Yeelight"===b.typeConnect||"miio"===b.typeConnect?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(_,{deviceData:b,hide:e.hide})})}):"variable"===b.typeConnect&&"variable"===b.type?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(Q,{deviceData:b,hide:e.hide})})}):Object(o.jsx)(H,{})},$=function(e){var t=Object(c.useState)(),n=Object(j.a)(t,2),a=n[0],i=n[1];return Object(c.useEffect)((function(){i(e.data)}),[e.data]),a?"Mqtt_MQTTDevice"===a.typeConnect||"Zigbee_ZigbeeDevice"===a.typeConnect?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(X,{deviceData:a,hide:e.hide,type:"link"})})}):"yeelight"===a.typeConnect||"miio"===a.typeConnect?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(_,{deviceData:a,hide:e.hide,type:"link"})})}):"system"===a.typeConnect&&"variable"===a.type?Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsx)(Q,{deviceData:a,hide:e.hide,type:"link"})})}):Object(o.jsx)(H,{}):Object(o.jsx)(H,{})},ee=function(e){var t=e.children,n=e.onClick,c=e.className;return Object(o.jsx)("div",{className:"backForm ".concat(c),onClick:function(e){var t,c=e.target.className.split(" "),a=Object(p.a)(c);try{for(a.s();!(t=a.n()).done;){"backForm"===t.value&&"function"===typeof n&&n(e)}}catch(i){a.e(i)}finally{a.f()}},children:t})},te=function(e){var t=e.hide,n=e.data,a=Object(c.useContext)(E),i=Object(c.useState)(n.Level),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Y().message,d=B(),b=d.request,m=d.error,v=d.clearError,O=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/user/level/edit","POST",{id:n.UserId,level:s},{Authorization:"Bearer ".concat(a.token)});case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return u(m,"error"),function(){v()}}),[m,u,v]),Object(o.jsx)("div",{className:"form small",children:Object(o.jsx)("div",{className:"editDevicesForm moreInput",children:Object(o.jsxs)("ul",{className:"editDevice",children:[Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Name - ".concat(n.UserName)}),Object(o.jsx)("h5",{children:"UserSurname - ".concat(n.UserSurname)}),Object(o.jsx)("h5",{children:"Email - ".concat(n.Email)}),Object(o.jsx)("h5",{children:"Mobile - ".concat(n.Mobile)})]})}),Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"level"}),Object(o.jsxs)("select",{className:"textInput",name:"level",value:s,onChange:function(e){l(e.target.value)},children:[Object(o.jsx)("option",{value:1,children:"Usual"}),Object(o.jsx)("option",{value:3,children:"Admin"})]})]})}),Object(o.jsx)("div",{className:"controlForm",children:Object(o.jsx)("button",{className:"formEditBtn",onClick:O,children:"Save"})})]})})})},ne=function(e){var t=e.colors;return Object(o.jsxs)("div",{className:"styleIcon",children:[Object(o.jsx)("div",{className:"styleIcon-color",style:{background:t.c1}}),Object(o.jsx)("div",{className:"styleIcon-color",style:{background:t.c2}}),Object(o.jsx)("div",{className:"styleIcon-color",style:{background:t.active}})]})},ce=function(e){var t=e.hide,n=Object(c.useContext)(E),a=Y().message,i=B(),r=i.request,s=i.error,l=i.clearError,u=Object(c.useState)({name:"",c1:"#303030",c2:"#505050",c3:"#707070"}),d=Object(j.a)(u,2),b=d[0],m=d[1],v=function(e){m(Object(R.a)(Object(R.a)({},b),{},Object(V.a)({},e.target.name,e.target.value)))},O=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b.name){e.next=2;break}return e.abrupt("return",a("name empty","error"));case 2:return e.next=4,r("/api/user/style/add","POST",b,{Authorization:"Bearer ".concat(n.token)});case 4:t();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return a(s,"error"),function(){l()}}),[s,a,l]),Object(o.jsx)("div",{className:"form",children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsx)(ne,{colors:b}),Object(o.jsxs)("div",{className:"control",children:[Object(o.jsx)("input",{type:"text",value:b.name,name:"name",onChange:v}),Object(o.jsx)("input",{type:"color",value:b.c1,name:"c1",onChange:v}),Object(o.jsx)("input",{type:"color",value:b.c2,name:"c2",onChange:v}),Object(o.jsx)("input",{type:"color",value:b.c3,name:"c3",onChange:v})]}),Object(o.jsx)("button",{onClick:O,children:"Create"})]})})},ae=function(){var e=Object(c.useContext)(G),t=e.form,n=e.hide;if(!t.visible)return null;var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n(),t.OK&&t.OK(e)};return"EditDevices"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)(Z,{hide:a,systemName:t.data.systemName})}):"LinkDevices"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)($,{hide:a,data:t.data})}):"EditUserLevel"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)(te,{hide:a,data:t.data})}):"CreateStyle"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)(ce,{hide:a,ret:t.OK})}):void 0},ie="SHOW_ALERT",re="HIDE_ALERT",se="SHOW_MENU",le="HIDE_MENU",oe="EDIT_MENU",ue="SHOW_FORM",de="HIDE_FORM",je="SHOW_TERMINAL",be="HIDE_TERMINAL",me="SHOW_EDITCART",ve="HIDE_EDITCART",Oe="SHOW_ADDCONTROL",fe="HIDE_ADDCONTROL",he="SHOW_DIALOG",xe="HIDE_DIALOG",pe="SHOW_GROUP",ge="HIDE_GROUP",ye=(N={},Object(V.a)(N,ie,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(N,re,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(N,"DEFAULT",(function(e){return e})),N),Ne=function(e,t){return(ye[t.type]||ye.DEFAULT)(e,t)},Ae=function(e){var t=e.children,n=Object(c.useReducer)(Ne,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1];return Object(o.jsx)(l.Provider,{value:{show:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r({type:ie,payload:{text:e,type:t,Ok:n,No:c}})},hide:function(){r({type:re})},alert:i},children:t})},ke=(A={},Object(V.a)(A,he,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(A,xe,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(A,"DEFAULT",(function(e){return e})),A),Ce=function(e,t){return(ke[t.type]||ke.DEFAULT)(e,t)},we=function(e){var t=e.children,n=Object(c.useReducer)(Ce,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"warning",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r({type:he,payload:Object(R.a)({type:e},t)})}),[]),l=Object(c.useCallback)((function(){r({type:xe})}),[]);return Object(o.jsx)(d.Provider,{value:{show:s,hide:l,dialog:i},children:t})},Ee=(k={},Object(V.a)(k,se,(function(e,t){t.payload;return Object(R.a)(Object(R.a)({},e),{},{visible:!0})})),Object(V.a)(k,le,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(k,oe,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:e.visible})})),Object(V.a)(k,"DEFAULT",(function(e){return e})),k),Be=function(e,t){return(Ee[t.type]||Ee.DEFAULT)(e,t)},Se=function(e){var t=e.children,n=Object(c.useReducer)(Be,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;r({type:oe,payload:Object(R.a)({title:e},t)})}),[]);return Object(o.jsx)(g.Provider,{value:{show:function(){r({type:se})},hide:function(){r({type:le})},togle:function(){i.visible?r({type:le}):r({type:se})},setData:s,menu:i},children:t})},De=(C={},Object(V.a)(C,ue,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(C,de,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(C,"DEFAULT",(function(e){return e})),C),Te=function(e,t){return(De[t.type]||De.DEFAULT)(e,t)},qe=function(e){var t=e.children,n=Object(c.useReducer)(Te,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1];return Object(o.jsx)(G.Provider,{value:{show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"404",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r({type:ue,payload:{type:e,OK:t,data:n}})},hide:function(){r({type:de})},form:i},children:t})},Le=Object(c.createContext)(),Ie=(w={},Object(V.a)(w,je,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(w,be,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(w,"DEFAULT",(function(e){return e})),w),Fe=function(e,t){return(Ie[t.type]||Ie.DEFAULT)(e,t)},ze=function(e){var t=e.children,n=Object(c.useReducer)(Fe,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"404",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r({type:je,payload:{type:e,OK:n,hide:t}})},l=function(){r({type:be})};return Object(o.jsx)(Le.Provider,{value:{show:s,hide:l,target:function(){i.visible?l():s()},terminal:i},children:t})},Pe=Object(c.createContext)(),Me=Object(c.createContext)(),Ue=Object(c.createContext)(),Ge=function(e){var t=e.children,n=Object(c.useContext)(d),a=Object(c.useContext)(Me).devices,i=Y().message,r=Object(c.useContext)(E),s=B(),l=s.request,u=s.error,j=s.clearError,b=function(){var e=Object(c.useContext)(Me).devices,t=Object(c.useContext)(Ue).groups,n=Object(c.useContext)(d),a=Object(c.useCallback)((function(t,n){return e.filter((function(e){var c,a=!1,i=Object(p.a)(e.fields);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(("number"===n&&("number"===r.type||"binary"===r.type)||"binary"===n&&"binary"===r.type||"text"===n||"enum"===n&&"enum"===r.type||!n)&&(a=!0),a&&("act"!==t||r.control))return!0}}catch(s){i.e(s)}finally{i.f()}return!1}))}),[e]),i=Object(c.useCallback)((function(e,n){return t.filter((function(t){var c,a=!1,i=Object(p.a)(t.fields);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(("number"===n&&("number"===r.type||"binary"===r.type)||"binary"===n&&"binary"===r.type||"text"===n||"enum"===n&&"enum"===r.type||!n)&&(a=!0),a&&("act"!==e||r.control))return!0}}catch(s){i.e(s)}finally{i.f()}return!1}))}),[t]),r=Object(c.useCallback)((function(e){var t=a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"act",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null).map((function(e){return{title:e.name,data:e}}));n.show("confirmation",{title:"typeAct",items:t,active:function(t){"function"===typeof e&&e(t),n.hide()}})}),[a,n]),s=Object(c.useCallback)((function(e){var t=i(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"act",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null).map((function(e){return{title:e.name,data:e}}));n.show("confirmation",{title:"typeAct",items:t,active:function(t){"function"===typeof e&&e(t),n.hide()}})}),[i,n]);return{deviceBlock:r,groupBlock:s}}(),m=b.deviceBlock,v=b.groupBlock,O=function(){var e=Object(x.a)(h.a.mark((function e(){var t,c,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:null,e.next=3,l("/api/script/all","GET",null,{Authorization:"Bearer ".concat(r.token)});case 3:c=(c=e.sent).map((function(e){return{title:e.name,data:e}})),n.show("confirmation",{title:"typeAct",items:c,active:function(e){n.hide(),"function"===typeof t&&t(e)}});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return i(u,"error"),function(){j()}}),[u,i,j]),Object(o.jsx)(Pe.Provider,{value:{typeValue:function(e,t){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=[];"addValue"===e&&"text"===t.type&&a.push({title:"input text",data:"Text"}),"number"!==t.type&&"addValueMath"!==e||a.push({title:"input number",data:"Number"}),"addValueMath"!==e&&"number"!==t.type||a.push({title:"Mathematical expression",data:"Math"}),"enum"!==t.type&&a.push({title:"Device value",data:"DeviceValue"}),"enum"!==t.type&&"binary"!==t.type||a.push({title:"state value",data:"Enum"}),n.show("confirmation",{title:"typeAct",items:a,active:function(e){n.hide(),"function"===typeof c&&c(e)}})},addTarget:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.map((function(e){return{title:e.name,data:e}}));t.unshift({title:"datetime",data:{type:"datetime"}}),n.show("confirmation",{title:"Devices",items:t,active:function(t){"function"===typeof e&&e(t),n.hide()}})},typeAct:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[{title:"device",data:"device"},{title:"group",data:"group"},{title:"script",data:"script"},{title:"delay",data:"delay"}];n.show("confirmation",{title:"typeAct",items:t,active:function(t){"function"===typeof e&&e(t),n.hide()}})},deviceBlock:m,groupBlock:v,typeIf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[{title:"group Block And",data:"groupBlockAnd"},{title:"group Block Or",data:"groupBlockOr"},{title:"device",data:"deviceBlock"}];n.show("confirmation",{title:"typeAct",items:t,active:function(t){n.hide(),"function"===typeof e&&e(t)}})},addScriptBlock:O},children:t})},Re=n(9),He=function(e){var t=e.position,n=void 0===t?"fixed":t,a=e.zindex,i=void 0===a?5:a,r=e.children,s=e.top,l=void 0===s?240:s,u=e.left,d=void 0===u?300:u,b=e.hide,m=void 0===b?null:b,v=e.userBtn,O=void 0===v?null:v,f=e.width,h=void 0===f?"auto":f,x=e.height,p=void 0===x?"auto":x,g=e.title,y=void 0===g?"window":g,N=e.moving,A=void 0===N||N,k=e.heightToolbar,C=void 0===k?30:k,w=e.className,E=void 0===w?"":w,B=e.style,S=void 0===B?{}:B,D=e.styleContent,T=void 0===D?{}:D,q=Object(c.useState)({top:l,left:d}),L=Object(j.a)(q,2),I=L[0],F=L[1];return Object(o.jsxs)("div",{className:"modalWindow ".concat(E),style:Object(R.a)({top:"".concat(I.top,"px"),left:"".concat(I.left,"px"),zIndex:i,position:n},S),children:[Object(o.jsxs)("div",{className:"modalHeader",style:{height:"".concat(C,"px")},onMouseDown:A?function(e){if("modalHeader"===e.target.className){var t=e.target.parentNode.parentNode.getBoundingClientRect(),n=function(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}}(e.target),c=e.pageX-n.left+t.x,a=e.pageY-n.top+t.y;i(e),document.onmousemove=function(e){i(e)},document.onkeydown=function(t){"Escape"===t.key&&(document.onmousemove=null,e.onmouseup=null,document.onkeydown=null)},e.target.onmouseup=function(){document.onmousemove=null,e.onmouseup=null,document.onkeydown=null}}function i(e){e.pageX<65||e.pageX>document.body.clientWidth||e.pageY<5||e.pageY>document.clientHeight||F({left:e.pageX-c,top:e.pageY-a})}}:null,onDragStart:function(){return!1},children:[Object(o.jsx)("h4",{children:y}),O?Object(o.jsx)("button",{className:"userBtn",onClick:O,children:Object(o.jsx)("i",{className:"fas fa-list"})}):null,m?Object(o.jsx)("button",{className:"hide",onClick:m,children:"\xd7"}):null]}),Object(o.jsx)("div",{className:"modalContent",style:Object(R.a)({width:"auto"!==h?"".concat(h,"px"):"",height:"auto"!==p?"".concat(p,"px"):""},T),children:r})]})},Ye=Object(c.createContext)(),Ve=function(e){var t,n,a=e.children,i=e.data,r=e.onClick,s=e.index,l=e.deleteBtn,u=e.editBtn,d=e.className,b=e.name,m=Object(c.useContext)(E),v=Object(c.useState)(!1),O=Object(j.a)(v,2),f=O[0],p=O[1],g=Object(c.useState)(!1),y=Object(j.a)(g,2),N=y[0],A=y[1],k=Y().message,C=B(),w=C.request,S=C.error,D=C.clearError,T=Object(c.useContext)(Ye).target;Object(c.useEffect)((function(){return k(S,"error"),function(){D()}}),[S,k,D]);var q=function(){var e=Object(x.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/".concat(i.data.typeItem,"/value/set"),"POST",{systemName:t,type:i.data.typeAction,status:n},{Authorization:"Bearer ".concat(m.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;"binary"===(null===(e=i.field)||void 0===e?void 0:e.type)&&A(!0)}),[null===(t=i.field)||void 0===t?void 0:t.type]),Object(c.useEffect)((function(){var e;if("function"!==typeof r&&!i.disabled&&"offline"!==(null===(e=i.entity)||void 0===e?void 0:e.status)){if(i.entity&&"binary"===i.field.type&&i.fieldvalue&&(i.fieldvalue===i.field.low&&p(!1),i.fieldvalue===i.field.high&&p(!0),"mqtt"===i.entity.typeConnect&&!/\D/.test(i.fieldvalue)&&!/\D/.test(i.field.low)&&!/\D/.test(i.field.high))){var t=Number(i.fieldvalue),n=Number(i.field.low),c=Number(i.field.high);p(t>n&&t<=c)}i.entity&&"number"===i.field.type&&i.fieldvalue&&(i.data.action||(i.data.action="0"),i.data.action===i.fieldvalue?p(!0):p(!1))}}),[r,i]);return Object(o.jsxs)("label",{className:"BtnElement ".concat(d," ").concat(i.disabled?"disabled":""),children:[Object(o.jsx)("input",{type:"checkbox",checked:f,name:b,onChange:function(e){var t=f;if(p((function(e){return!e})),N||setTimeout((function(){return p(!1)}),250),"function"===typeof r&&r(e,f,p),i.data&&i.entity)return"modeTarget"===i.typeAction?q(i.entity.systemName,"target"):"binary"===i.field.type?q(i.entity.systemName,t?0:1):("number"===i.field.type||i.field.type,q(i.entity.systemName,i.data.action))},disabled:i.disabled}),Object(o.jsxs)("div",{className:"icon-conteiner",children:[i.editmode?Object(o.jsxs)("div",{className:"delete-box",children:[l?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof l&&l(s)},children:"\xd7"}):null,u?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof u&&T("button",Object(R.a)(Object(R.a)({},i.data),{},{index:s}),u)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null,Object(o.jsx)("div",{className:"icon-box",children:a||Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===i||void 0===i||null===(n=i.field)||void 0===n?void 0:n.icon)||"fas fa-circle-notch"})})})}),Object(o.jsx)("p",{children:i.title})]})]})},Ke=Object(c.createContext)(),Je=function(e){var t=e.id,n=e.text,a=e.className,i=e.onClick,r=Object(c.useCallback)((function(){var e=document.getElementById("p-".concat(t)),c=document.getElementById("div-".concat(t));e.clientWidth>=c.clientWidth?(e.className="scroll",e.innerHTML="| ".concat(n," | ").concat(n)):e.className=""}),[t,n]);return Object(c.useEffect)((function(){r()}),[r]),Object(o.jsx)("div",{id:"div-".concat(t),onClick:i,className:"RunText ".concat(a),children:Object(o.jsx)("p",{id:"p-".concat(t),children:n})})},We=function(e){var t,n,a=e.data,i=(e.className,e.index),r=(e.children,e.name,e.onClick),s=e.editBtn,l=e.deleteBtn,u=Object(c.useContext)(E),d=Object(c.useState)(0),b=Object(j.a)(d,2),m=b[0],v=b[1],O=Y().message,f=B(),p=f.request,g=f.error,y=f.clearError,N=Object(c.useRef)(null),A=Object(c.useContext)(Ye).target,k=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p("/api/".concat(a.data.typeItem,"/value/set"),"POST",{systemName:a.data.deviceName,type:a.data.typeAction,status:t},{Authorization:"Bearer ".concat(u.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){return O(g,"error"),function(){y()}}),[g,O,y]),Object(c.useEffect)((function(){"function"!==typeof r&&(null===a||void 0===a?void 0:a.fieldvalue)&&v(Number(null===a||void 0===a?void 0:a.fieldvalue))}),[r,a]);var C=function(e){v(e.target.value),N.current&&clearTimeout(N.current),N.current=setTimeout((function(){k(e.target.value)}),200)};return Object(o.jsxs)("div",{className:"slider-box",children:[Object(o.jsx)(Je,{className:"name RunTextBaseColor",id:a.title,text:a.title}),Object(o.jsx)("div",{className:"slider",children:Object(o.jsx)("input",{type:"range",min:(null===(t=a.field)||void 0===t?void 0:t.low)||0,max:(null===(n=a.field)||void 0===n?void 0:n.high)||100,value:m||0,onChange:C,onInput:C,disabled:a.disabled})}),Object(o.jsx)("div",{className:"value",children:m||0}),a.editmode&&(l||s)?Object(o.jsxs)("div",{className:"delete-box",children:[l?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof l&&l(i)},children:"\xd7"}):null,s?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof s&&A("button",Object(R.a)(Object(R.a)({},a.data),{},{index:i}),s)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null]})},_e=function(e){var t,n,a=e.data,i=(e.className,e.index),r=(e.children,e.name,e.onClick,e.editBtn),s=e.deleteBtn,l=Object(c.useContext)(Ye).target,u=function(){var e;return(null===a||void 0===a||null===(e=a.field)||void 0===e?void 0:e.type)?a.field.type:"text"},d=function(){"function"===typeof s&&s(i)},j=function(){"function"===typeof r&&l("button",Object(R.a)(Object(R.a)({},a.data),{},{index:i}),r)};return(null===a||void 0===a||null===(t=a.entity)||void 0===t?void 0:t.systemName)?"number"===u()||"text"===u()?Object(o.jsxs)("div",{className:"SensorElement",children:[Object(o.jsxs)("div",{className:"icon-conteiner",children:[Object(o.jsx)(Je,{className:"sensor-name RunTextBaseColor",id:a.title,text:a.title}),Object(o.jsx)(Je,{className:"sensor-value RunTextBaseColor",id:"".concat(a.title,"-val"),text:"".concat(a.fieldvalue||""," ").concat((null===(n=a.field)||void 0===n?void 0:n.unit)||"")})]}),a.editmode&&(s||r)?Object(o.jsxs)("div",{className:"delete-box",children:[s?Object(o.jsx)("button",{className:"deleteBtn",onClick:d,children:"\xd7"}):null,r?Object(o.jsx)("button",{className:"editBtn",onClick:j,children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null]}):"binary"===u()?Object(o.jsxs)("div",{className:"SensorElement",children:[Object(o.jsxs)("div",{className:"icon-conteiner",children:[Object(o.jsx)(Je,{className:"sensor-name RunTextBaseColor",id:a.title,text:a.title}),Object(o.jsx)("div",{className:"valueIndicator ".concat("1"===a.fieldvalue?"true":"false")})]}),a.editmode&&(s||r)?Object(o.jsxs)("div",{className:"delete-box",children:[s?Object(o.jsx)("button",{className:"deleteBtn",onClick:d,children:"\xd7"}):null,r?Object(o.jsx)("button",{className:"editBtn",onClick:j,children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null]}):Object(o.jsxs)("div",{className:"SensorElement BtnElement",children:[Object(o.jsx)("div",{className:"icon-conteiner",children:Object(o.jsx)(Je,{className:"sensor-value-name RunTextBaseColor",id:a.title,text:a.title})}),a.editmode&&(s||r)?Object(o.jsxs)("div",{className:"delete-box",children:[s?Object(o.jsx)("button",{className:"deleteBtn",onClick:d,children:"\xd7"}):null,r?Object(o.jsx)("button",{className:"editBtn",onClick:j,children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null]}):null},Qe=function(e){var t,n,a=e.data,i=e.className,r=e.index,s=(e.children,e.name,e.onClick),l=e.editBtn,u=e.deleteBtn,d=Object(c.useContext)(E),b=Object(c.useState)(""),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Y().message,p=B(),g=p.request,y=p.error,N=p.clearError,A=Object(c.useContext)(Ye).target;Object(c.useEffect)((function(){return f(y,"error"),function(){N()}}),[y,f,N]);var k=function(){var e=Object(x.a)(h.a.mark((function e(t,n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/".concat(a.data.typeItem,"/value/set"),"POST",{systemName:t,type:a.data.typeAction,status:n},{Authorization:"Bearer ".concat(d.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){"function"!==typeof s&&a.fieldvalue&&!a.disabled&&O(a.fieldvalue)}),[s,a.fieldvalue,a.disabled]);return Object(o.jsx)("label",{className:"EnumElement ".concat(i," ").concat(a.disabled?"disabled":""),children:Object(o.jsxs)("div",{className:"icon-conteiner",children:[a.editmode&&(u||l)?Object(o.jsxs)("div",{className:"delete-box",children:[u?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof u&&u(r)},children:"\xd7"}):null,l?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof l&&A("button",Object(R.a)(Object(R.a)({},a.data),{},{index:r}),l)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null,Object(o.jsxs)("div",{className:"icon-box-enum",children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(t=a.field)||void 0===t?void 0:t.icon)||"fas fa-circle-notch"})})}),(null===(n=a.field)||void 0===n?void 0:n.values)?Object(o.jsx)("select",{value:v,onChange:function(e){if(O(e.target.value),(null===a||void 0===a?void 0:a.entity)&&(null===a||void 0===a?void 0:a.data))return k(a.entity.systemName,e.target.value)},children:function(e){return e.split(" ").join("").split(",")}(a.field.values).map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))}):null]}),Object(o.jsx)("p",{children:a.title})]})})},Xe=function(e){var t=e.data,n=e.className,a=e.index,i=(e.children,e.name,e.onClick,e.editBtn),r=e.deleteBtn,s=Object(c.useContext)(Ye).target,l=Y().message,u=B(),d=u.request,j=u.error,b=u.clearError,m=Object(c.useContext)(E);Object(c.useEffect)((function(){return l(j,"error"),function(){b()}}),[j,l,b]);var v=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("/api/script/run?name=".concat(t.data.name),"GET",null,{Authorization:"Bearer ".concat(m.token)});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("label",{className:"ScriptElement ".concat(n),children:[Object(o.jsx)("input",{type:"button",onClick:v,disabled:t.disabled}),Object(o.jsxs)("div",{className:"icon-conteiner",children:[t.editmode&&(r||i)?Object(o.jsxs)("div",{className:"delete-box",children:[r?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof r&&r(a)},children:"\xd7"}):null,i?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof i&&s("button",Object(R.a)(Object(R.a)({},t.data),{},{index:a}),i)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null,Object(o.jsx)("div",{className:"icon-box",children:Object(o.jsx)("i",{className:"fas fa-file-alt"})}),Object(o.jsx)("p",{children:t.data.name})]})]})},Ze=function(e){var t=e.children,n=e.deleteBtn,a=e.editBtn,i=e.index,r=e.data,s=Object(c.useContext)(Ye).target;return Object(o.jsxs)("div",{className:"baseCartElement-box",children:[n||a?Object(o.jsxs)("div",{className:"delete-box",children:[n?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof n&&n(i)},children:"\xd7"}):null,a?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof a&&s("button",Object(R.a)(Object(R.a)({},r),{},{index:i}),a)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null,t]})},$e=Object(c.createContext)(),et=function(e){var t,n,a,i,r,s,l,u,d=e.deleteBtn,j=e.editBtn,b=e.index,m=e.data,v=Object(c.useContext)($e),O=function(e){return e?"\u042f\u0441\u043d\u043e"===e||"\u041c\u0430\u043b\u043e\u043e\u0431\u043b\u0430\u0447\u043d\u043e"===e||"Clear"===e?Object(o.jsx)("i",{className:"fas fa-sun"}):"\u041e\u0431\u043b\u0430\u0447\u043d\u043e \u0441 \u043f\u0440\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f\u043c\u0438"===e?Object(o.jsx)("i",{className:"fas fa-cloud-sun"}):"\u041e\u0431\u043b\u0430\u0447\u043d\u043e"===e||"\u041f\u0430\u0441\u043c\u0443\u0440\u043d\u043e"===e||"Clouds"===e?Object(o.jsx)("i",{className:"fas fa-cloud"}):"\u0414\u043e\u0436\u0434\u044c"===e||"Rain"===e?Object(o.jsx)("i",{className:"fas fa-cloud-showers-heavy"}):"\u041d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0434\u043e\u0436\u0434\u044c"===e?Object(o.jsx)("i",{className:"fas fa-cloud-sun-rain"}):"Snow"===e?Object(o.jsx)("i",{className:"far fa-snowflake"}):void 0:null},f=function(e){return e?"".concat(String(Math.floor(e-273.15))," C*"):null};return Object(o.jsx)(Ze,{deleteBtn:m.editmode?d:null,editBtn:m.editmode?j:null,index:b,data:m.data,children:v&&v.weather?Object(o.jsxs)("div",{className:"weather-box",children:[Object(o.jsx)("div",{className:"city",children:v&&v.weather&&v.weather.city||""}),Object(o.jsxs)("div",{className:"weather-body ".concat(m.data.width>3?"veryWide":m.data.width>1?"wide":""," ").concat(m.height>2?"veryTall":m.height>1?"tall":""),children:[Object(o.jsxs)("div",{className:"day_anchor-div",children:[Object(o.jsx)("div",{className:"icon_color_light",children:O(null===v||void 0===v||null===(t=v.weather)||void 0===t||null===(n=t.now)||void 0===n?void 0:n.weather)}),m.data.width>1||m.data.height>1?Object(o.jsx)("div",{className:"day-anchor",children:(null===v||void 0===v||null===(a=v.weather)||void 0===a||null===(i=a.now)||void 0===i?void 0:i.weather)||""}):null]}),Object(o.jsx)("div",{className:"temp",children:f(null===v||void 0===v||null===(r=v.weather)||void 0===r||null===(s=r.now)||void 0===s?void 0:s.temp)})]}),m.data.width>3&&m.data.height>1?Object(o.jsx)("div",{className:"forecast",children:null===v||void 0===v||null===(l=v.weather)||void 0===l||null===(u=l.forecastDate)||void 0===u?void 0:u.map((function(e,t){var n,c;return Object(o.jsxs)("div",{className:"forecast-weather-body",children:[Object(o.jsx)("div",{className:"day-name",children:e.name||""}),Object(o.jsx)("div",{className:"day-date",children:e.day.date||""}),Object(o.jsxs)("div",{className:"day_anchor-div",children:[Object(o.jsx)("div",{className:"icon_color_light",children:O(e&&e.day.weather)}),Object(o.jsx)("div",{className:"day-anchor",children:e.day.weather||""})]}),Object(o.jsx)("div",{className:"forecast-temp forecast-temp-day",children:f(null===e||void 0===e||null===(n=e.day)||void 0===n?void 0:n.temp)||""}),Object(o.jsx)("div",{className:"forecast-temp forecast-temp-night",children:f(null===e||void 0===e||null===(c=e.night)||void 0===c?void 0:c.temp)||""})]},t)}))}):null]}):Object(o.jsxs)("div",{className:"weather-box",style:{fontSize:"30px",flexDirection:"column",display:"flex",alignItems:"center",justifyContent:"center"},children:[Object(o.jsx)("p",{children:"weather"}),Object(o.jsx)("p",{children:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"})]})})},tt=function(e){var t=e.data,n=(e.className,e.index),a=(e.children,e.name,e.onClick,e.editBtn),i=e.deleteBtn,r=Object(c.useContext)($e);return Object(o.jsx)(Ze,{deleteBtn:t.editmode?i:null,editBtn:t.editmode?a:null,index:n,data:t.data,children:Object(o.jsx)("p",{className:"sensor-value",children:r.time||"".concat((new Date).getHours(),":").concat((new Date).getMinutes())})})};function nt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t?c[e]:n[e]}var ct,at,it=function(e){var t=e.deleteBtn,n=e.editBtn,a=e.index,i=e.data,r=Object(c.useContext)($e),s=Object(c.useState)([]),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(c.useCallback)((function(e){if(!e)return null;var t=e.split(".");return(t=t.reverse()).join("-")}),[]);return Object(c.useEffect)((function(){for(var e=new Date(b(r.date)),t=function(e,t){for(var n=new Date(t,e,1),c=[];n.getMonth()===e;)c.push(new Date(n)),n.setDate(n.getDate()+1);return c}(e.getMonth(),e.getFullYear()),n=(t=t.map((function(t){return t.getDate()!==e.getDate()?{type:"",day:t}:{type:"naw",day:t}})))[0].day.getUTCDay(),c=new Date(t[0].day),a=1;a<=n;a++)c.setDate(c.getDate()-1),t.unshift({type:"prev",day:new Date(c)});n=t[t.length-1].day.getUTCDay(),c=new Date(t[t.length-1].day);for(var i=6;i>n;i--)c.setDate(c.getDate()+1),t.push({type:"next",day:new Date(c)});d(t)}),[r.date,b]),i.data.height>=2&&i.data.width>=3?Object(o.jsx)(Ze,{deleteBtn:i.editmode?t:null,editBtn:i.editmode?n:null,index:a,data:i.data,children:Object(o.jsxs)("div",{className:"calendar",children:[Object(o.jsx)("div",{className:"NawMonth",children:Object(o.jsxs)("p",{children:[nt((new Date).getMonth())," ",(new Date).getFullYear()]})}),Object(o.jsxs)("div",{className:"calendar-grid",children:[Object(o.jsx)("div",{className:"",children:"Mon"}),Object(o.jsx)("div",{className:"",children:"Tue"}),Object(o.jsx)("div",{className:"",children:"Wed"}),Object(o.jsx)("div",{className:"",children:"Thu"}),Object(o.jsx)("div",{className:"",children:"Fri"}),Object(o.jsx)("div",{className:"",children:"Sat"}),Object(o.jsx)("div",{className:"",children:"Sun"}),u.map((function(e,t){return Object(o.jsx)("div",{className:e.type,children:e.day.getDate()},t)}))]})]})}):Object(o.jsx)(Ze,{deleteBtn:i.editmode?t:null,editBtn:i.editmode?n:null,index:a,data:i.data,children:Object(o.jsx)("div",{className:"calendar",children:Object(o.jsx)("div",{className:"NawMonth",style:{height:"calc(100% - 20px)",fontSize:"25px"},children:Object(o.jsxs)("p",{children:[(new Date).getDate()," ",nt((new Date).getMonth(),1===i.data.width)," ",(new Date).getFullYear()]})})})})},rt=function(){var e=Object(c.useContext)(Me).getDevice,t=Object(c.useContext)(Ue).getGroup,n=Object(c.useCallback)((function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e.name===t}))[0]}),[]),a=Object(c.useCallback)((function(t,n){var c,a=Object(p.a)(t.devices);try{for(a.s();!(c=a.n()).done;){var i=c.value,r=e(i.name),s=null===r||void 0===r?void 0:r.value[n];if(s)return s}}catch(l){a.e(l)}finally{a.f()}}),[e]);return{convert:Object(c.useCallback)((function(c,i){var r,s,l,o,u,d={};if(d.data=c,d.disabled=!1,d.title=c.title,d.editmode=i,"script"===c.typeItem)return d;if("device"===c.typeItem)d.entity=e(c.deviceName),d.fieldsEntity=null===(l=d.entity)||void 0===l?void 0:l.fields,d.field=n(d.fieldsEntity,c.typeAction),d.fieldvalue=null===(o=d.entity)||void 0===o?void 0:o.value[null===(u=d.field)||void 0===u?void 0:u.name];else if("group"===c.typeItem){var j,b;d.entity=t(c.deviceName),d.fieldsEntity=null===(j=d.entity)||void 0===j?void 0:j.fields,d.field=n(d.fieldsEntity,c.typeAction),d.fieldvalue=a(d.entity,null===(b=d.field)||void 0===b?void 0:b.name)}return d.entity&&d.fieldsEntity&&d.field||(d.disabled=!0),(null===(r=d.entity)||void 0===r?void 0:r.status)&&"online"!==(null===(s=d.entity)||void 0===s?void 0:s.status)&&(d.disabled=!0),d}),[e,a,n,t])}},st=function(e){var t=e.hide,n=e.index,a=e.name,i=e.updata,r=e.data,s=e.edit,l=void 0!==s&&s,u=(e.add,Y().message),d=rt().convert,j=Object(c.useContext)(Ke).mode,b=Object(c.useContext)(Ye).target,m=1,v=1,O=[];function f(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=0;a<n;a++)for(var i=0;i<c;i++){var r,s=Object(p.a)(O);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(l.x===e+a&&l.y===t+i)return!0}}catch(o){s.e(o)}finally{s.f()}}return!1}function g(e,t){return 4-(e-1)<t}var y=function(e){u("\u0423\u0434\u0430\u043b\u0438\u0442\u044c?","dialog",Object(x.a)(h.a.mark((function t(){var c,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=r.children.slice(),a=c.filter((function(t,n){return n!==e})),i(n,Object(R.a)(Object(R.a)({},r),{},{children:a}));case 3:case"end":return t.stop()}}),t)}))),"no")},N=function(e,t){if(t&&t.order&&t.width&&t.height){var c=r.children.slice();c[e].order=Number(t.order),c[e].width=Number(t.width),c[e].height=Number(t.height),i(n,Object(R.a)(Object(R.a)({},r),{},{children:c}))}};return Object(o.jsx)(He,{position:"relative",hide:j?function(){t(n)}:null,userBtn:j?function(){return b("base",Object(R.a)(Object(R.a)({},r),{},{index:n}),i)}:null,z:3,top:0,left:0,title:a,moving:!1,heightToolbar:30,children:Object(o.jsx)("ul",{className:"elementConteiner",children:r&&r.children?function(e){for(var t=e.slice(),n=0;n<t.length;n++)t[n].index=n;for(var c=t.length-1;c>0;c--)for(var a=0;a<c;a++)if(t[a].order>t[a+1].order){var i=[t[a+1],t[a]];t[a]=i[0],t[a+1]=i[1]}return t}(r.children).map((function(e,t){0===t&&(m=1,v=1);do{g(m,e.width)&&(m=1,v+=1),f(m,v,e.width,e.height)&&(m+=1)}while(g(m,e.width)||f(m,v,e.width,e.height));for(var n=m;n<m+e.width;n++)for(var c=v;c<v+e.height;c++)O.push({x:n,y:c});var a=m,i=m+e.width;m+=e.width;var r,s=v,u=v+e.height;return Object(o.jsx)("li",{style:{gridColumnStart:a,gridColumnEnd:i,gridRowStart:s,gridRowEnd:u},children:"button"===e.type?Object(o.jsx)(Ve,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"slider"===e.type?Object(o.jsx)(We,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"sensor"===(r=e.type,r.split("-"))[0]?Object(o.jsx)(_e,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"script"===e.type?Object(o.jsx)(Xe,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"enum"===e.type?Object(o.jsx)(Qe,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"weather"===e.type?Object(o.jsx)(et,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"time"===e.type?Object(o.jsx)(tt,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):"date"===e.type?Object(o.jsx)(it,{data:d(e,l),index:e.index,deleteBtn:y,editBtn:N}):null},t)})):null})})},lt=function(e){var t=e.children,n=e.deleteBtn,a=e.editBtn,i=e.index,r=e.data,s=e.onClick,l=Object(c.useContext)(Ye).target;return Object(o.jsxs)("div",{className:"baseCartElement-line",children:[n||a?Object(o.jsxs)("div",{className:"delete-box",children:[n?Object(o.jsx)("button",{className:"deleteBtn",onClick:function(){"function"===typeof n&&n(i)},children:"\xd7"}):null,a?Object(o.jsx)("button",{className:"editBtn",onClick:function(){"function"===typeof a&&l("button-line",Object(R.a)(Object(R.a)({},r),{},{index:i}),a)},children:Object(o.jsx)("i",{className:"fas fa-list i-cost"})}):null]}):null,Object(o.jsx)("div",{className:"ElementLine",onClick:s,children:t})]})},ot=function(e){e.children;var t,n=e.data,a=e.onClick,i=e.index,r=e.deleteBtn,s=e.editBtn,l=(e.className,Object(c.useContext)(E)),u=Object(c.useState)(!1),d=Object(j.a)(u,2),b=d[0],m=d[1],v=Object(c.useState)(!1),O=Object(j.a)(v,2),f=O[0],p=O[1],g=Y().message,y=B(),N=y.request,A=y.error,k=y.clearError;Object(c.useEffect)((function(){return g(A,"error"),function(){k()}}),[A,g,k]);var C=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N("/api/".concat(n.data.typeItem,"/value/set"),"POST",{systemName:n.data.deviceName,type:n.data.typeAction,status:t},{Authorization:"Bearer ".concat(l.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;"binary"===(null===n||void 0===n||null===(e=n.field)||void 0===e?void 0:e.type)&&p(!0)}),[n.field]),Object(c.useEffect)((function(){if("function"!==typeof a&&!n.disabled&&n.entity&&"offline"!==n.entity.status){var e;if("binary"===n.field.type&&(null===n||void 0===n?void 0:n.fieldvalue))if("0"===n.fieldvalue&&m(!1),"1"===n.fieldvalue&&m(!0),"mqtt"===(null===(e=n.entity)||void 0===e?void 0:e.typeConnect)&&!/\D/.test(n.fieldvalue)&&!/\D/.test(n.field.low)&&!/\D/.test(n.field.high)){var t=Number(n.fieldvalue),c=Number(n.field.low),i=Number(n.field.high);m(t>c&&t<=i)}"number"===n.field.type&&(null===n||void 0===n?void 0:n.fieldvalue)&&(n.data.action||(n.data.action="0"),n.data.action===n.fieldvalue?m(!0):m(!1))}}),[a,n]);var w,S=function(e){var t=b;if(m((function(e){return!e})),f||setTimeout((function(){return m(!1)}),250),"function"===typeof a&&a(e,!t,m),null===n||void 0===n?void 0:n.entity)return"modeTarget"===n.data.typeAction?C("target"):"binary"===n.field.type?C(t?0:1):("number"===n.field.type||n.field.type,C(n.data.action))};return f?Object(o.jsxs)(lt,{deleteBtn:n.editmode?r:null,editBtn:n.editmode?s:null,data:n.data,index:i,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(t=n.field)||void 0===t?void 0:t.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"name",children:n.title}),Object(o.jsx)("div",{className:"control",children:Object(o.jsx)("div",{className:"right-control",children:Object(o.jsx)("div",{className:"custom1-checkbox",children:Object(o.jsx)("div",{className:"custom1-inner ".concat(b?"active":""),onClick:n.disabled?function(){}:S,disabled:n.disabled,children:Object(o.jsx)("div",{className:"custom1-toggle"})})})})})]}):Object(o.jsxs)(lt,{onClick:S,deleteBtn:n.editmode?r:null,editBtn:n.editmode?s:null,data:n.data,index:i,children:[Object(o.jsx)("div",{className:"icon icon-btn",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(w=n.field)||void 0===w?void 0:w.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"name",children:n.title}),Object(o.jsx)("p",{className:"state",children:n.data.action})]})},ut=function(e){var t,n,a,i=e.data,r=e.onClick,s=e.index,l=e.deleteBtn,u=e.editBtn,d=(e.className,Object(c.useContext)(E)),b=Object(c.useState)(0),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useRef)(null),p=Y().message,g=B(),y=g.request,N=g.error,A=g.clearError,k=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("/api/".concat(i.data.typeItem,"/value/set"),"POST",{systemName:i.data.deviceName,type:i.data.typeAction,status:t},{Authorization:"Bearer ".concat(d.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){return p(N,"error"),function(){A()}}),[N,p,A]),Object(c.useEffect)((function(){"function"!==typeof r&&i.fieldvalue&&O(Number(i.fieldvalue))}),[r,i]);var C=function(e){O(e.target.value),f.current&&clearTimeout(f.current),f.current=setTimeout((function(){k(e.target.value)}),200)};return i.entity?Object(o.jsxs)(lt,{deleteBtn:i.editmode?l:null,editBtn:i.editmode?u:null,data:i.data,index:s,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(t=i.field)||void 0===t?void 0:t.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"name",children:i.title}),Object(o.jsxs)("div",{className:"flex",children:[Object(o.jsx)("input",{className:"control-big",type:"range",min:(null===(n=i.field)||void 0===n?void 0:n.low)||0,max:(null===(a=i.field)||void 0===a?void 0:a.high)||100,value:v,onChange:C,onInput:C,disabled:i.disabled}),Object(o.jsx)("div",{className:"state",children:v})]})]}):null},dt=function(e){var t,n,c,a,i,r,s=e.data,l=(e.className,e.index),u=(e.children,e.name,e.onClick,e.editBtn),d=e.deleteBtn,j=function(){var e;return(null===s||void 0===s||null===(e=s.field)||void 0===e?void 0:e.type)?s.field.type:"text"};return s.entity?"text"===j()||"number"===j()?Object(o.jsxs)(lt,{deleteBtn:s.editmode?d:null,editBtn:s.editmode?u:null,data:s.data,index:l,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(c=s.field)||void 0===c?void 0:c.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"sensor-name",children:s.title}),Object(o.jsx)("p",{className:"state",children:"".concat(s.fieldvalue," ").concat((null===(a=s.field)||void 0===a?void 0:a.unit)||"")})]}):"binary"===j()?Object(o.jsxs)(lt,{deleteBtn:s.editmode?d:null,editBtn:s.editmode?u:null,data:s.data,index:l,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(i=s.field)||void 0===i?void 0:i.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"sensor-name",children:s.title}),Object(o.jsx)("div",{className:"control",children:Object(o.jsx)("p",{className:"state",children:"".concat(s.fieldvalue," ").concat((null===(r=s.field)||void 0===r?void 0:r.unit)||"")})})]}):Object(o.jsxs)(lt,{deleteBtn:s.editmode?d:null,editBtn:s.editmode?u:null,data:s.data,index:l,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(t=s.field)||void 0===t?void 0:t.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"sensor-name",children:s.title}),Object(o.jsx)("p",{className:"state",children:"".concat(s.fieldvalue," ").concat((null===(n=s.field)||void 0===n?void 0:n.unit)||"")})]}):null},jt=function(e){var t=e.data,n=(e.className,e.index),a=(e.children,e.name,e.onClick,e.editBtn),i=e.deleteBtn,r=Y().message,s=B(),l=s.request,u=s.error,d=s.clearError,j=Object(c.useContext)(E);Object(c.useEffect)((function(){return r(u,"error"),function(){d()}}),[u,r,d]);var b=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("/api/script/run?name=".concat(t.data.name),"GET",null,{Authorization:"Bearer ".concat(j.token)});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)(lt,{onClick:b,deleteBtn:t.editmode?i:null,editBtn:t.editmode?a:null,data:t.data,index:n,children:[Object(o.jsx)("div",{className:"icon icon-btn",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:"far fa-file-alt"})})}),Object(o.jsx)("p",{className:"name",children:t.data.name})]})},bt=function(e){e.children;var t,n,a,i,r=e.data,s=e.onClick,l=e.index,u=e.deleteBtn,d=e.editBtn,b=(e.className,Object(c.useContext)(E)),m=Object(c.useState)(r.fieldvalue),v=Object(j.a)(m,2),O=v[0],f=v[1],p=Y().message,g=B(),y=g.request,N=g.error,A=g.clearError;Object(c.useEffect)((function(){return p(N,"error"),function(){A()}}),[N,p,A]);var k=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("/api/".concat(r.data.typeItem,"/value/set"),"POST",{systemName:r.data.deviceName,type:r.data.typeAction,status:t},{Authorization:"Bearer ".concat(b.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;"function"!==typeof s&&r.fieldvalue&&!r.disabled&&"offline"!==(null===(e=r.entity)||void 0===e?void 0:e.status)&&f(r.fieldvalue)}),[r.fieldvalue,s,r.disabled,null===(t=r.entity)||void 0===t?void 0:t.status]);return Object(o.jsxs)(lt,{deleteBtn:r.editmode?u:null,editBtn:r.editmode?d:null,data:r.data,index:l,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(n=r.field)||void 0===n?void 0:n.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"name",children:r.title}),(null===(a=r.field)||void 0===a?void 0:a.values)?Object(o.jsx)("select",{value:O,onChange:function(e){return f(e.target.value),k(e.target.value)},disabled:r.disabled,children:function(e){return e.split(" ").join("").split(",")}(null===(i=r.field)||void 0===i?void 0:i.values).map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))}):null]})},mt=function(e){var t,n=e.data,a=(e.onClick,e.index),i=e.deleteBtn,r=e.editBtn,s=(e.className,Object(c.useContext)(E)),l=Object(c.useState)(""),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useState)(""),v=Object(j.a)(m,2),O=v[0],f=v[1],p=Object(c.useState)(!1),g=Object(j.a)(p,2),y=g[0],N=g[1],A=Y().message,k=B(),C=k.request,w=k.error,S=k.clearError;Object(c.useEffect)((function(){return A(w,"error"),function(){S()}}),[w,A,S]);var D=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C("/api/".concat(n.data.typeItem,"/value/set"),"POST",{systemName:n.data.deviceName,type:n.data.typeAction,status:t},{Authorization:"Bearer ".concat(s.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;y||n.fieldvalue&&!n.disabled&&"offline"!==(null===(e=n.entity)||void 0===e?void 0:e.status)&&b(n.fieldvalue)}),[y,n]);return Object(o.jsxs)(lt,{deleteBtn:n.editmode?i:null,editBtn:n.editmode?r:null,data:n.data,index:a,children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("div",{className:"circle",children:Object(o.jsx)("i",{className:(null===(t=n.field)||void 0===t?void 0:t.icon)||"fas fa-circle-notch"})})}),Object(o.jsx)("p",{className:"name",children:n.title}),Object(o.jsxs)("div",{className:"control",children:[Object(o.jsx)("input",{type:"text",onFocus:function(){return N(!0)},onBlur:function(){return N(!1)},value:d,onChange:function(e){b(e.target.value),f(e.target.value)},disabled:n.disabled}),Object(o.jsx)("input",{type:"button",onClick:function(e){return D(O)},disabled:n.disabled,value:"send"})]})]})},vt=function(e){var t=e.hide,n=e.index,a=e.name,i=e.updata,r=e.data,s=e.edit,l=void 0!==s&&s,u=(e.add,Y().message),d=rt().convert,j=Object(c.useContext)(Ke).mode,b=Object(c.useContext)(Ye).target;var m=function(e){u("\u0423\u0434\u0430\u043b\u0438\u0442\u044c?","dialog",Object(x.a)(h.a.mark((function t(){var c,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=r.children.slice(),a=c.filter((function(t,n){return n!==e})),i(n,Object(R.a)(Object(R.a)({},r),{},{children:a}));case 3:case"end":return t.stop()}}),t)}))),"no")},v=function(e,t){if(t&&t.order&&t.width&&t.height){var c=r.children.slice();c[e].order=Number(t.order),c[e].width=Number(t.width),c[e].height=Number(t.height),i(n,Object(R.a)(Object(R.a)({},r),{},{children:c}))}};return Object(o.jsx)(He,{position:"relative",hide:j?function(){t(n)}:null,userBtn:j?function(){return b("line",Object(R.a)(Object(R.a)({},r),{},{index:n}),i)}:null,z:3,top:0,left:0,title:a,moving:!1,heightToolbar:30,children:Object(o.jsx)("ul",{className:"elementConteiner line",children:r&&r.children?function(e){for(var t=e.slice(),n=0;n<t.length;n++)t[n].index=n;for(var c=t.length-1;c>0;c--)for(var a=0;a<c;a++)if(t[a].order>t[a+1].order){var i=[t[a+1],t[a]];t[a]=i[0],t[a+1]=i[1]}return t}(r.children).map((function(e,t){return Object(o.jsx)("li",{children:"button"===e.type?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(ot,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):"enum"===e.type?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(bt,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):"text"===e.type?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(mt,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):"slider"===e.type?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(ut,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):"script"===e.type?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(jt,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):"sensor"===(n=e.type,n.split("-"))[0]?Object(o.jsx)("div",{className:"line-el",children:Object(o.jsx)(dt,{data:d(e,l),index:e.index,deleteBtn:m,editBtn:v})}):null},t);var n})):null})})},Ot=(ct={},Object(V.a)(ct,me,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(ct,ve,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(ct,"DEFAULT",(function(e){return e})),ct),ft=function(e,t){return(Ot[t.type]||Ot.DEFAULT)(e,t)},ht=function(e){var t=e.children,n=Object(c.useReducer)(ft,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"base",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r({type:me,payload:{type:e,OK:n,cart:t}})},l=function(){r({type:ve})};return Object(o.jsx)(Ye.Provider,{value:{show:s,hide:l,target:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"base",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i.visible?l():s(e,t,n)},cartEdit:i},children:t})},xt=Object(c.createContext)(),pt=(at={},Object(V.a)(at,Oe,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(at,fe,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(at,"DEFAULT",(function(e){return e})),at),gt=function(e,t){return(pt[t.type]||pt.DEFAULT)(e,t)},yt=function(e){var t=e.children,n=Object(c.useReducer)(gt,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AddButton",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r({type:Oe,payload:{type:e,OK:t}})},l=function(){r({type:fe})};return Object(o.jsx)(xt.Provider,{value:{show:s,hide:l,target:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AddButton",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;i.visible?l():s(e,t)},addControl:i},children:t})},Nt=Object(c.createContext)(),At=function(e){var t=e.hide,n=e.next,a=e.back,i=Object(c.useContext)(Nt).scripts;return Object(o.jsx)(m,{hide:t,text:"choose a device.",title:"add element",active:n,activeText:"NEXT",buttons:[{title:"BACK",action:a}],items:i.map((function(e){return{title:e.name,data:e}}))})},kt=[{title:"device",data:"device"},{title:"group",data:"group"}],Ct=function(e){e.type;var t=e.next,n=e.back,c=e.hide;return Object(o.jsx)(m,{hide:c,text:"choose a item.",title:"add element",active:t,activeText:"NEXT",buttons:[{title:"BACK",action:n}],items:kt})},wt={sensor:["text","binary","number","enum"],button:["text","binary","number","enum"],slider:["number"],enum:["enum"],text:["text"]};var Et=function(e){var t,n=e.type,a=e.next,i=e.back,r=e.hide,s=Object(c.useContext)(Me).devices,l=Object(c.useState)(function(e,t){if("sensor"===t)return e;var n,c=e.filter((function(e){return"sensor"!==e.type})),a=[],i=Object(p.a)(c);try{for(i.s();!(n=i.n()).done;){var r,s=n.value,l=Object(p.a)(s.fields);try{for(l.s();!(r=l.n()).done;){var o=r.value;if(o.control&&t in wt&&-1!==wt[t].indexOf(o.type)){a.push(s);break}}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}return a}(s,n)),u=Object(j.a)(l,1)[0];return Object(o.jsx)(m,{hide:r,text:"choose a device.",title:"add element",active:a,activeText:"NEXT",buttons:[{title:"BACK",action:i}],items:(t=u,t.map((function(e){return{title:e.name,data:e}})))})},Bt={sensor:["text","binary","number","enum"],button:["text","binary","number","enum"],slider:["number"],enum:["enum"],text:["text"]};var St=function(e){var t,n=e.type,a=e.next,i=e.device,r=e.back,s=e.hide,l=Object(c.useState)(function(e,t){var n=e.fields;return"sensor"===t?n:n.filter((function(e){return e.control&&t in Bt&&-1!==Bt[t].indexOf(e.type)}))}(i,n)),u=Object(j.a)(l,1)[0];return Object(o.jsx)(m,{hide:s,text:"choose a device.",title:"adds element",active:a,activeText:"NEXT",buttons:[{title:"BACK",action:r}],items:(t=u,t.map((function(e){return{title:e.name,data:e}})))})},Dt=function(e){var t=e.field,n=e.next,a=e.back,i=e.hide,r=Object(c.useState)(0),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useState)(""),b=Object(j.a)(d,2),m=b[0],v=b[1],O=function(){var e=t.values.split(",");return e=e.map((function(e){return e.trim()}))};return"number"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",min:Number(t.low),max:Number(t.high),onChange:function(e){return u(e.target.value)},required:!0,type:"number",value:l||0}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(l)},disabled:null===l,children:"NEXT"})]})]})]}):"text"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",onChange:function(e){return v(e.target.value)},required:!0,type:"text",value:m||""}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(m)},disabled:""===m,children:"NEXT"})]})]})]}):"enum"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("select",{onChange:function(e){return v(e.target.value)},required:!0,value:m||O()[0],children:O().map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(m)},disabled:""===m,children:"NEXT"})]})]})]}):void 0},Tt={sensor:["text","binary","number","enum"],button:["text","binary","number","enum"],slider:["number"],enum:["enum"],text:["text"]};var qt=function(e){var t,n=e.type,a=e.next,i=e.back,r=e.hide,s=Object(c.useContext)(Ue),l=s.groups,u=s.updata,d=Object(c.useState)(function(e,t){if("sensor"===t)return e;var n,c=e.filter((function(e){return"sensor"!==e.type})),a=[],i=Object(p.a)(c);try{for(i.s();!(n=i.n()).done;){var r,s=n.value,l=Object(p.a)(s.fields);try{for(l.s();!(r=l.n()).done;){var o=r.value;if(o.control&&t in Tt&&-1!==Tt[t].indexOf(o.type)){a.push(s);break}}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}return a}(l,n)),b=Object(j.a)(d,1)[0];return Object(c.useEffect)((function(){u()}),[u]),Object(o.jsx)(m,{hide:r,text:"choose a group.",title:"add element",active:a,activeText:"NEXT",buttons:[{title:"BACK",action:i}],items:(t=b,t.map((function(e){return{title:e.name,data:e}})))})},Lt={sensor:["text","binary","number","enum"],button:["text","binary","number","enum"],slider:["number"],enum:["enum"],text:["text"]};var It=function(e){var t,n=e.type,a=e.next,i=e.device,r=e.back,s=e.hide,l=Object(c.useState)(function(e,t){var n=e.fields;return"sensor"===t?n:n.filter((function(e){return e.control&&t in Lt&&-1!==Lt[t].indexOf(e.type)}))}(i,n)),u=Object(j.a)(l,1)[0];return Object(o.jsx)(m,{hide:s,text:"choose a groups.",title:"adds element",active:a,activeText:"NEXT",buttons:[{title:"BACK",action:r}],items:(t=u,t.map((function(e){return{title:e.name,data:e}})))})},Ft=function(e){var t=e.field,n=e.next,a=e.back,i=e.hide,r=Object(c.useState)(0),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useState)(""),b=Object(j.a)(d,2),m=b[0],v=b[1],O=function(){var e=t.values.split(",");return e=e.map((function(e){return e.trim()}))};return"number"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",min:Number(t.low),max:Number(t.high),onChange:function(e){return u(e.target.value)},required:!0,type:"number",value:l||0}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(l)},disabled:null===l,children:"NEXT"})]})]})]}):"text"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",onChange:function(e){return v(e.target.value)},required:!0,type:"text",value:m||""}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(m)},disabled:""===m,children:"NEXT"})]})]})]}):"enum"===t.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:i}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("select",{onChange:function(e){return v(e.target.value)},required:!0,value:m||O()[0],children:O().map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))}),Object(o.jsx)("label",{children:"state"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:a,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return n(m)},disabled:""===m,children:"NEXT"})]})]})]}):void 0},zt=function(e){e.field;var t=e.next,n=e.back,a=e.hide,i=Object(c.useState)(""),r=Object(j.a)(i,2),s=r[0],l=r[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:a}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Add element"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogBody",children:Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",onChange:function(e){return l(e.target.value)},required:!0,type:"text",value:s||""}),Object(o.jsx)("label",{children:"title"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:n,children:"BACK"}),Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return t(s)},disabled:""===s,children:"NEXT"})]})]})]})},Pt=[{title:"button",data:"button"},{title:"script",data:"script"},{title:"slider",data:"slider"},{title:"monitor",data:"sensor"},{title:"enum",data:"enum"},{title:"weather",data:"weather"},{title:"time",data:"time"},{title:"calendar",data:"date"}],Mt=[{title:"button",data:"button"},{title:"script",data:"script"},{title:"slider",data:"slider"},{title:"monitor",data:"sensor"},{title:"enum",data:"enum"},{title:"text",data:"text"}],Ut={name:"weather",type:"weather",order:0,typeItem:"system",width:1,height:1},Gt={name:"time",type:"time",order:0,typeItem:"system",width:2,height:1},Rt={name:"date",type:"date",order:0,typeItem:"system",width:2,height:2},Ht=function(){var e=Object(c.useContext)(xt),t=e.addControl,n=e.hide,a=Object(c.useState)(""),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Object(c.useState)(null),u=Object(j.a)(l,2),d=u[0],b=u[1],v=Object(c.useState)(null),O=Object(j.a)(v,2),f=O[0],h=O[1],x=Object(c.useState)(null),p=Object(j.a)(x,2),g=p[0],y=p[1],N=Object(c.useState)("device"),A=Object(j.a)(N,2),k=A[0],C=A[1],w=Object(c.useState)(1),E=Object(j.a)(w,2),B=E[0],S=E[1],D=function(){n(),s(""),b(null),y(null),S(1)},T=function(e){t.OK&&t.OK(e),D()},q=function(e){return{height:1,name:d.name,deviceName:d.systemName,order:0,type:r,typeItem:k,width:1,title:"",typeAction:e.name}};if(!t.visible)return null;if(1===B)return Object(o.jsx)(m,{hide:D,text:"choose the element type.",title:"add element",active:function(e){"weather"===e?T(Ut):"time"===e?T(Gt):"date"===e?T(Rt):(s(e),S(2))},activeText:"NEXT",items:"AddElement"===t.type?Pt:Mt});if("script"===r)return Object(o.jsx)(At,{hide:D,next:function(e){T(function(e){return{height:1,name:e.name,order:0,type:"script",typeItem:"script",title:"",width:1}}(e))},back:function(){return S(1)}});if(2===B)return Object(o.jsx)(Ct,{hide:D,type:r,back:function(){return S(1)},next:function(e){C(e),S(3)}});if("device"===k){if(3===B)return Object(o.jsx)(Et,{hide:D,type:r,back:function(){return S(2)},next:function(e){b(e),S(4)}});if(4===B)return Object(o.jsx)(St,{hide:D,type:r,device:d,back:function(){return S(3)},next:function(e){"sensor"===r?(y(e),S(6)):"button"===r&&"binary"!==e.type?(S(5),y(e)):(y(e),S(6))}});if(5===B)return Object(o.jsx)(Dt,{next:function(e){h(e),S(6)},hide:D,back:function(){return S(4)},field:g})}else{if(3===B)return Object(o.jsx)(qt,{hide:D,type:r,back:function(){return S(2)},next:function(e){b(e),S(4)}});if(4===B)return Object(o.jsx)(It,{hide:D,type:r,device:d,back:function(){return S(3)},next:function(e){"sensor"===r?(y(e),S(6)):"button"===r&&"binary"!==e.type?(S(5),y(e)):(y(e),S(6))}});if(5===B)return Object(o.jsx)(Ft,{next:function(e){h(e),S(6)},hide:D,back:function(){return S(4)},field:g})}return 6===B?Object(o.jsx)(zt,{next:function(e){var t;t=f?function(e){return Object(R.a)(Object(R.a)({},q(g)),{},{action:e})}(f):q(g),t=Object(R.a)(Object(R.a)({},t),{},{title:e}),T(t)},hide:D,back:function(){return S(4)},field:g}):null},Yt=function(e){var t=e.type,n=void 0===t?"base":t,a=Object(c.useContext)(Ye),i=a.cartEdit,r=a.hide,s=Object(c.useContext)(xt).show,l=Object(c.useState)({mainId:null,id:null,name:"",type:"base",order:0,children:[],width:1}),u=Object(j.a)(l,2),d=u[0],b=u[1];Object(c.useEffect)((function(){i.cart&&b({mainId:i.cart.mainId,id:i.cart.id,name:i.cart.name,type:i.cart.type,order:i.cart.order,children:i.cart.children,width:i.cart.width})}),[i]);return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:r}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Edit card"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogBody",children:[Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{name:"name",onChange:function(e){b(Object(R.a)(Object(R.a)({},d),{},Object(V.a)({},e.target.name,e.target.value)))},required:!0,type:"text",value:d?d.name:""}),Object(o.jsx)("label",{children:"name"})]}),Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"name",min:0,max:500,onChange:function(e){return b(Object(R.a)(Object(R.a)({},d),{},{order:e.target.value}))},required:!0,type:"number",value:d.order||0}),Object(o.jsx)("label",{children:"order"})]})]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogFooter",children:[Object(o.jsx)("button",{className:"dialogButton button normalSelection",onClick:function(){return s("line"===n?"AddLineElement":"AddElement",function(){var e=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=d.children.slice()).push(t),i.OK(i.cart.index,Object(R.a)(Object(R.a)({},d),{},{children:n})),r();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"add Element"}),Object(o.jsx)("button",{className:"dialogButton button highSelection",onClick:function(){"function"===typeof i.OK&&(i.OK(i.cart.index,d),r())},children:"save"})]})]})]})},Vt=function(e){e.type;var t=Object(c.useContext)(Ye),n=t.cartEdit,a=t.hide,i=Object(c.useState)({order:String(n.cart.order),width:n.cart.width,height:n.cart.height}),r=Object(j.a)(i,2),s=r[0],l=r[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"backGlass",onClick:a}),Object(o.jsxs)("div",{className:"dialogCoteiner",children:[Object(o.jsx)("div",{className:"dialogHeader",children:"Edit card"}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"dialogBody",children:[Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"order",min:0,max:500,onChange:function(e){return l(Object(R.a)(Object(R.a)({},s),{},{order:e.target.value}))},required:!0,type:"number",value:s.order||0}),Object(o.jsx)("label",{children:"order"})]}),Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"width",min:1,max:4,onChange:function(e){return l(Object(R.a)(Object(R.a)({},s),{},{width:e.target.value}))},required:!0,type:"number",value:s.width||1}),Object(o.jsx)("label",{children:"width"})]}),Object(o.jsxs)("div",{className:"input-data",style:{marginTop:"15px",marginBottom:"10px"},children:[Object(o.jsx)("input",{name:"height",min:1,max:4,onChange:function(e){return l(Object(R.a)(Object(R.a)({},s),{},{height:e.target.value}))},required:!0,type:"number",value:s.height||1}),Object(o.jsx)("label",{children:"height"})]})]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"dialogFooter",children:Object(o.jsx)("button",{className:"dialogButton button highSelection",onClick:function(){"function"===typeof n.OK&&(n.OK(n.cart.index,s),a())},children:"save"})})]})]})},Kt=function(){var e=Object(c.useContext)(Ye).cartEdit;return e.visible&&e.type?"base"===e.type?Object(o.jsx)(Yt,{}):"line"===e.type?Object(o.jsx)(Yt,{type:"line"}):"button"===e.type?Object(o.jsx)(Vt,{}):"button-line"===e.type?Object(o.jsx)(Vt,{type:"button-line"}):null:null},Jt=[{title:"base card",data:"base"},{title:"list card",data:"line"}],Wt=function(){var e=Object(c.useState)(!1),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)([]),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useState)([]),b=Object(j.a)(u,2),m=b[0],v=b[1],O=Object(c.useContext)(E),f=Object(c.useContext)(g).setData,p=Object(c.useContext)(S),y=p.page,N=p.getData,A=Object(c.useContext)(d),k=A.show,C=A.hide,w=Y().message,D=B(),T=D.request,q=D.error,L=D.clearError,I=Object(c.useRef)(null),F=Object(c.useState)({}),z=Object(j.a)(F,2),P=z[0],M=z[1],U=Object(c.useState)([]),G=Object(j.a)(U,2),R=G[0],V=G[1];var K=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"base";C(),a(!0);var t={name:"",order:"0",type:e,children:[],width:2};l((function(e){var n=e.slice();return n.push(t),n}))}),[C]),J=Object(c.useCallback)((function(e){k("alert",{title:"delete card",text:"delete card?",buttons:[{title:"yes",action:function(){l((function(t){return t.filter((function(t,n){return n!==e}))}))}},{title:"no",active:C}]})}),[k,C]),W=Object(c.useCallback)((function(e,t){l((function(n){return n.map((function(n,c){return c===e?t:n}))}))}),[]),_=Object(c.useCallback)((function(){try{T("/api/homePage/set","POST",{name:y,cards:s},{Authorization:"Bearer ".concat(O.token)})}catch(e){console.error(e)}}),[s,O.token,T,y]),Q=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T("/api/server/config/get","GET",null,{Authorization:"Bearer ".concat(O.token)});case 3:t=e.sent,V(t.pages),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[T,O.token]),X=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=23;break}return e.prev=1,e.next=4,T("/api/homePage/get/".concat(y),"GET",null,{Authorization:"Bearer ".concat(O.token)});case 4:t=e.sent,l(t.cards),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:return Q(),e.prev=12,e.next=15,T("/api/script/all","GET",null,{Authorization:"Bearer ".concat(O.token)});case 15:return n=e.sent,e.next=18,M(n);case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(12),console.error(e.t1);case 23:case"end":return e.stop()}}),e,null,[[1,8],[12,20]])}))),[T,O.token,y,Q]),Z=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("/api/homePage/add?name=".concat(t),"GET",null,{Authorization:"Bearer ".concat(O.token)});case 2:setTimeout((function(){N()}),0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[T,O.token,N]),$=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("/api/user/page/set?page=".concat(t),"GET",null,{Authorization:"Bearer ".concat(O.token)});case 2:C(),setTimeout((function(){N()}),0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[T,N,O.token,C]),ee=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("/api/homePage/delete?name=".concat(t),"GET",null,{Authorization:"Bearer ".concat(O.token)});case 2:setTimeout((function(){N()}),0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[T,O.token,N]),te=Object(c.useCallback)((function(){return R.map((function(e){var t={title:e};return y===e?t.active=!0:t.onClick=function(){return $(e)},t}))}),[R,$,y]),ne=Object(c.useCallback)((function(){var e=[{title:n?"save":"edit",onClick:function(){n?(_(),a(!1)):a(!0)}},{title:"add card",onClick:function(){return k("confirmation",{title:"Add card",items:Jt,active:K})}},{type:"dividers"},{title:"pages",sub:te()},{title:"create page",onClick:function(){return k("text",{title:"New page",text:"input name newPage",placeholder:"name",active:function(e){Z(e)}})}}];return"basePage"!==y&&e.push({title:"delete page",onClick:function(){return k("alert",{title:"Delete page",text:"delete page?",buttons:[{title:"ok",action:function(){ee(y),C()}},{title:"cancel",action:C}]})}}),e}),[y,ee,Z,k,C,K,_,n,te]);Object(c.useEffect)((function(){return w(q,"error"),function(){L()}}),[q,w,L]),Object(c.useEffect)((function(){X()}),[X]),Object(c.useEffect)((function(){f("Home",{dopmenu:ne()})}),[f,n,ne,K,te,_,k,Z,$]);var ce=Object(c.useCallback)((function(e,t){var n=3,c=0;t<1300&&(n=2),t<900&&(c=0,n=1);for(var a=[],i=0;i<n;i++)a.push([]);for(var r=function(e){for(var t=e.slice(),n=0;n<t.length;n++)t[n].index=n;for(var c=t.length-1;c>0;c--)for(var a=0;a<c;a++)if(t[a].order>t[a+1].order){var i=[t[a+1],t[a]];t[a]=i[0],t[a+1]=i[1]}return t}(e),s=0;s<r.length;s++){var l=r[s];a[c]&&(a[c].push(l),++c>=n&&(c=0))}v(a)}),[]);return Object(c.useEffect)((function(){ce(s,I.current.clientWidth)}),[ce,s]),Object(c.useEffect)((function(){var e;function t(t){e||(e=setTimeout((function(){e=null,ce(s,t.target.innerWidth)}),66))}return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[ce,s]),s===[]?Object(o.jsx)(H,{}):Object(o.jsx)(Ke.Provider,{value:{setMode:a,mode:n,add:K},children:Object(o.jsx)(Nt.Provider,{value:{scripts:P},children:Object(o.jsx)(ht,{children:Object(o.jsxs)(yt,{children:[Object(o.jsx)(Kt,{}),Object(o.jsx)(Ht,{}),Object(o.jsx)("div",{className:"conteiner top home",children:Object(o.jsx)("div",{ref:I,className:"conteinerHome flexHome",children:m.map((function(e,t){return Object(o.jsx)("div",{className:"home-column",children:e.map((function(e,t){return Object(o.jsx)("div",{className:"flexElement",style:{order:e.order},children:"base"===e.type?Object(o.jsx)(st,{edit:n,hide:function(e){return J(e)},updata:W,index:e.index,data:e,name:e.name}):"line"===e.type?Object(o.jsx)(vt,{edit:n,hide:function(e){return J(e)},updata:W,index:e.index,data:e,name:e.name}):null},t)}))},t)}))})})]})})})})},_t=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(d),n=Y().message,a=B(),i=a.loading,r=a.request,s=a.error,l=a.clearError,u=Object(c.useState)({name:"",password:""}),b=Object(j.a)(u,2),m=b[0],v=b[1];Object(c.useEffect)((function(){return n(s,"general"),function(){l()}}),[s,n,l]);var O=function(e){v(Object(R.a)(Object(R.a)({},m),{},Object(V.a)({},e.target.name,e.target.value)))},f=function(){var t=Object(x.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r("/api/auth/login","POST",Object(R.a)({},m));case 3:(n=t.sent)&&e.login(n.token,n.userId,n.userLavel),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:"title",children:Object(o.jsx)("h1",{children:"Sing In Form"})}),Object(o.jsxs)("div",{className:"container-auth",children:[Object(o.jsx)("div",{className:"left-auth"}),Object(o.jsx)("div",{className:"right-auth",children:Object(o.jsxs)("div",{className:"formBox-auth",children:[Object(o.jsx)("p",{children:"Name"}),Object(o.jsx)("input",{placeholder:"Login",id:"name",type:"text",name:"name",value:m.name,onChange:O,required:!0}),Object(o.jsx)("p",{children:"Password"}),Object(o.jsx)("input",{placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022",id:"password",type:"password",name:"password",value:m.password,onChange:O,required:!0}),Object(o.jsx)("input",{type:"submit",onClick:f,disabled:i,value:"Sign In"}),Object(o.jsx)("p",{onClick:function(){t.show("text",{title:"Password recovery",text:"input login",placeholder:"login",active:function(e){r("/api/user/password/new","POST",{name:e})}})},style:{marginTop:"5px"},className:"liteButton",children:"\u0437\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"})]})})]})]})},Qt=function(e,t){if(!e)return null;var n=function(e,t){if(!e)return null;var n,c=Object(p.a)(e.fields);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(a.name===t)return a}}catch(i){c.e(i)}finally{c.f()}}(e,t),c=null===e||void 0===e?void 0:e.value[t];return"binary"===(null===n||void 0===n?void 0:n.type)?"1"===c:c},Xt={number:"area",binary:"stepArea"};var Zt=function(e){var t="gray";"#"===e[0]&&(e=e.slice(1));var n=parseInt(e,16);return(n>>16<200||(255&n)<200||(n>>8&255)<200)&&(t="#fff"),t};function $t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={theme:"light2",animationEnabled:!0,title:{text:"".concat(e.deviceName,"-").concat(e.name)},axisY:{title:e.utils||"Value"},axisX:{valueFormatString:"DD-MM-YY HH:mm:ss",margin:5},data:[{type:Xt[e.type],xValueFormatString:"DDD HH:mm:ss",markerSize:5,dataPoints:e.data}]};return"binary"===e.type&&(n.axisY.interval=1,n.axisY.minimum=-.02,n.axisY.maximum=1.02),(null===t||void 0===t?void 0:t.c2)&&(n.backgroundColor=null===t||void 0===t?void 0:t.c2,n.axisY.labelFontColor=Zt(null===t||void 0===t?void 0:t.c2),n.title.fontColor=Zt(null===t||void 0===t?void 0:t.c2),n.axisX.labelFontColor=Zt(null===t||void 0===t?void 0:t.c2)),n}var en=function(e){var t=e.device,n=e.item,a=Object(c.useContext)(E),i=Object(c.useRef)(null),r=B(),s=r.request,l=r.error,u=r.clearError,d=Y().message,b=Object(c.useState)(Qt(t,n.name)),m=Object(j.a)(b,2),v=m[0],O=m[1];Object(c.useEffect)((function(){return d(l,"error"),function(){u()}}),[l,d,u]);var f=function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("/api/device/value/set","POST",{systemName:t,type:n,status:c},{Authorization:"Bearer ".concat(a.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),p=function(e){O(e.target.value),i.current&&clearTimeout(i.current),i.current=setTimeout((function(){f(t.systemName,n.name,e.target.value)}),200)};return Object(o.jsxs)("div",{className:"slider-box",children:[Object(o.jsx)(Je,{className:"name RunTextBaseColor",id:n.name,text:n.name}),Object(o.jsx)("div",{className:"slider",children:Object(o.jsx)("input",{type:"range",min:Number(n.low||0),max:Number(n.high||100),value:v||0,onChange:p,onInput:p})}),Object(o.jsx)("div",{className:"value",children:v||0})]})},tn=function(e){var t=e.device,n=e.item,a=Object(c.useState)(Qt(t,n.name)),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Object(c.useContext)(E),u=Y().message,d=B(),b=d.request,m=d.error,v=d.clearError;Object(c.useEffect)((function(){return u(m,"error"),function(){v()}}),[m,u,v]);return Object(o.jsxs)("div",{className:"text-field",children:[Object(o.jsx)("div",{className:"textfield-name",children:Object(o.jsx)("p",{children:n.name||"text"})}),Object(o.jsxs)("div",{className:"textfield",children:[Object(o.jsx)("input",{type:"text",value:r,onChange:function(e){s(e.target.value)}}),Object(o.jsx)("input",{type:"button",onClick:function(){b("/api/device/value/set","POST",{systemName:t.systemName,type:n.name,status:r},{Authorization:"Bearer ".concat(l.token)})},value:"send"})]})]})},nn=function(e){var t=e.device,n=e.item,a=Object(c.useContext)(E),i=Y().message,r=B(),s=r.request,l=r.error,u=r.clearError,d=Object(c.useState)(Qt(t,n.name)),b=Object(j.a)(d,2),m=b[0],v=b[1];Object(c.useEffect)((function(){return i(l,"error"),function(){u()}}),[l,i,u]);var O,f=function(){var e=Object(x.a)(h.a.mark((function e(c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("/api/device/value/set","POST",{systemName:t.systemName,type:n.name,status:c},{Authorization:"Bearer ".concat(a.token)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:n.title||"enum"})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceLiControl",children:Object(o.jsx)("select",{value:m,onChange:function(e){v(e.target.value),f(e.target.value)},children:(O=n.values,O.split(" ").join("").split(",")).map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))})})})]})},cn=n(16),an=Object(c.createContext)(),rn=function(e){var t,n=e.records,c=e.title;return Object(o.jsxs)("div",{className:"historyList",children:[Object(o.jsx)("h3",{children:c||""}),Object(o.jsx)("ul",{children:null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsxs)("li",{children:[Object(o.jsx)("p",{children:e.y}),Object(o.jsx)("p",{children:(n=e.x,"".concat(n.getFullYear(),"-").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()],"-").concat(n.getDate()," ").concat(n.getHours(),":").concat(n.getMinutes(),":").concat(n.getSeconds()))})]},t);var n}))})]})},sn=function(e){var t,n=e.device,a=Object(c.useContext)(E),i=Object(c.useContext)(an).nawstyle,r=Y().message,s=B(),l=s.request,u=s.error,d=s.clearError,b=Object(c.useState)([]),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)("all"),g=Object(j.a)(f,2),y=g[0],N=g[1],A=Object(c.useState)(n.fields[0].name),k=Object(j.a)(A,2),C=k[0],w=k[1],S=Object(c.useState)(null),D=Object(j.a)(S,2),T=D[0],q=D[1];Object(c.useEffect)((function(){return r(u,"error"),function(){d()}}),[u,r,d]);var L=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("/api/device/history/get/".concat(n.systemName),"GET",null,{Authorization:"Bearer ".concat(a.token)});case 2:t=e.sent,console.log(t),t&&O(t);case 5:case"end":return e.stop()}}),e)}))),[a.token,l,n.systemName]),I=function(e,t){var n=new Date,c=Object(R.a)({},e);return"year"===t?c.data=e.data.filter((function(e){return e.x.getFullYear()===n.getFullYear()})):"month"===t?c.data=e.data.filter((function(e){return e.x.getMonth()===n.getMonth()&&e.x.getFullYear()===n.getFullYear()})):"day"===t&&(c.data=e.data.filter((function(e){return e.x.getDate()===n.getDate()&&e.x.getMonth()===n.getMonth()&&e.x.getFullYear()===n.getFullYear()}))),c};return Object(c.useEffect)((function(){L()}),[L]),Object(c.useEffect)((function(){q(function(e,t){var n={data:[]};n.name=t;var c,a=Object(p.a)(e);try{for(a.s();!(c=a.n()).done;){var i=c.value;i.field===t&&(n.type=i.type,n.utils=i.utils,n.deviceName=i.deviceName,"binary"===i.type||"number"===i.type?n.data.push({y:Number(i.value),x:new Date(1e3*Number(i.datatime))}):0!==n.data.length&&n.data[n.data.length-1].y===i.value||n.data.push({y:i.value,x:new Date(1e3*Number(i.datatime))}))}}catch(r){a.e(r)}finally{a.f()}return n}(v,C))}),[C,v]),Object(o.jsxs)("div",{className:"historyContainer",children:[Object(o.jsx)("div",{className:"canvasContainer",children:"binary"===(null===T||void 0===T?void 0:T.type)||"number"===(null===T||void 0===T?void 0:T.type)?Object(o.jsx)(cn.a,{options:$t(I(T,y),i)}):Object(o.jsx)(rn,{records:I(T,y),title:null===T||void 0===T?void 0:T.deviceName})}),Object(o.jsxs)("div",{className:"menuContainer",children:[Object(o.jsx)("div",{className:"historySetingsContainer",children:Object(o.jsxs)("div",{className:"SetingsBtn",children:[Object(o.jsx)("div",{className:"all"===y?"active":"",onClick:function(){return N("all")},children:"all"}),Object(o.jsx)("div",{className:"year"===y?"active":"",onClick:function(){return N("year")},children:"year"}),Object(o.jsx)("div",{className:"month"===y?"active":"",onClick:function(){return N("month")},children:"month"}),Object(o.jsx)("div",{className:"day"===y?"active":"",onClick:function(){return N("day")},children:"day"})]})}),Object(o.jsx)("div",{className:"fieldsList",children:Object(o.jsx)("ul",{children:null===n||void 0===n||null===(t=n.fields)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsx)("li",{className:C===e.name?"active":"",onClick:function(){return w(e.name)},children:e.name},t)}))})})]})]})},ln=function(e){var t=e.device,n=e.item,a=Object(c.useContext)(E),i=B(),r=i.request,s=i.error,l=i.clearError,u=Y().message;Object(c.useEffect)((function(){return u(s,"error"),function(){l()}}),[s,u,l]);var d=function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r("/api/device/value/set","POST",{systemName:t,type:n,status:c},{Authorization:"Bearer ".concat(a.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}();return Object(o.jsx)("div",{onClick:function(){return function(e){var n=t.value[e];d(t.systemName,e,"1"===n?0:1)}(n.name)},className:"dopBlubButton ".concat(Qt(t,n.name)?"activ":""),children:Object(o.jsx)("i",{className:n.icon||"far fa-lightbulb"})})},on=function(e){var t,n=e.device,a=Object(c.useContext)(E),i=Object(c.useState)(!1),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useRef)(null),d=Y().message,b=B(),m=b.request,v=b.error,O=b.clearError,f=function(e){return null===e||void 0===e?void 0:e.filter((function(e){var t,n,c,a;return"binary"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)&&(-1!==(null===e||void 0===e||null===(t=e.name)||void 0===t||null===(n=t.toLowerCase())||void 0===n?void 0:n.indexOf("state"))||-1!==(null===e||void 0===e||null===(c=e.name)||void 0===c||null===(a=c.toLowerCase())||void 0===a?void 0:a.indexOf("power")))}))},p=function(e){return null===e||void 0===e?void 0:e.filter((function(e){var t,n,c,a;return"binary"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)&&-1===(null===e||void 0===e||null===(t=e.name)||void 0===t||null===(n=t.toLowerCase())||void 0===n?void 0:n.indexOf("state"))&&-1===(null===e||void 0===e||null===(c=e.name)||void 0===c||null===(a=c.toLowerCase())||void 0===a?void 0:a.indexOf("power"))}))},g=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return"text"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)}))},y=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return"enum"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)}))},N=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return!1===(null===e||void 0===e?void 0:e.control)}))},A=function(e){var t=f(e)||[],n=t.filter((function(e){var t,n,c,a;return 0===(null===e||void 0===e||null===(t=e.name)||void 0===t||null===(n=t.toLowerCase())||void 0===n?void 0:n.indexOf("state"))||0===(null===e||void 0===e||null===(c=e.name)||void 0===c||null===(a=c.toLowerCase())||void 0===a?void 0:a.indexOf("power"))}));return n.length>0?n[0]:t.length>0?t[0]:null},k=function(e){var t=f(e),n=A(e);return t.filter((function(e){return e.name!==n.name}))},C=function(e){return e.filter((function(e){return"number"===e.type}))},w=function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/api/device/value/set","POST",{systemName:t,type:n,status:c},{Authorization:"Bearer ".concat(a.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=Qt(n,"state");l(e)}),[n]),Object(c.useEffect)((function(){var e;null===(e=u.current)||void 0===e||e.style.setProperty("--blub-on","#fff")}),[]),Object(c.useEffect)((function(){return d(v,"error"),function(){O()}}),[v,d,O]),Object(o.jsxs)("div",{className:"deviceContainer",children:[Object(o.jsxs)("div",{className:"gridDeviceContainer",children:[Object(o.jsx)("div",{className:"top-left"}),Object(o.jsx)("div",{className:"topContainer top-center",children:null===(t=[A(n.fields)])||void 0===t?void 0:t.map((function(e,t){return e?Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"blubContainer",children:Object(o.jsxs)("div",{onClick:function(){return function(e){var t=n.value[e];w(n.systemName,e,"1"===t?0:1)}(e.name)},ref:u,className:"bulb ".concat(s?"on":"off"),children:[Object(o.jsx)("span",{}),Object(o.jsx)("span",{})]})}),Object(o.jsx)("p",{className:"nameGeneralBlub",children:e.name})]},t):null}))}),Object(o.jsx)("div",{className:"top-right"}),0!==C(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"ranges field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:C(n.fields).map((function(e,t){return Object(o.jsx)("div",{className:"slider-container",children:Object(o.jsx)(en,{device:n,item:e})},t)}))})]}):null,0!==k(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"blubs"}),Object(o.jsx)("div",{className:"containerBlockcontent dopBlubContainer",children:k(n.fields).map((function(e,t){return Object(o.jsx)(ln,{device:n,item:e},t)}))})]}):null,0!==p(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"switchs"}),Object(o.jsx)("div",{className:"containerBlockcontent dopBlubContainer",children:p(n.fields).map((function(e,t){return Object(o.jsx)(ln,{device:n,item:e},t)}))})]}):null,0!==g(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"text field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:g(n.fields).map((function(e,t){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsx)(tn,{device:n,item:e})},t)}))})]}):null,0!==y(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"enum field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:y(n.fields).map((function(e,t){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsx)(nn,{device:n,item:e})},t)}))})]}):null,0!==N(n.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"sensors field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:N(n.fields).map((function(e,t){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsxs)("div",{className:"sensor-container",children:[Object(o.jsx)("p",{className:"name",children:e.name}),Object(o.jsx)("p",{className:"value",children:String(Qt(n,e.name))})]})},t)}))})]}):null]}),Object(o.jsx)("div",{className:"HistoryBlock",children:Object(o.jsx)(sn,{device:n})})]})},un=function(e){var t=e.device,n=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return"binary"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)}))},c=function(e){return e.filter((function(e){return"number"===e.type&&!0===(null===e||void 0===e?void 0:e.control)}))},a=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return"text"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)}))},i=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return"enum"===(null===e||void 0===e?void 0:e.type)&&!0===(null===e||void 0===e?void 0:e.control)}))},r=function(e){return null===e||void 0===e?void 0:e.filter((function(e){return!1===(null===e||void 0===e?void 0:e.control)}))};return Object(o.jsxs)("div",{className:"deviceContainer",children:[Object(o.jsxs)("div",{className:"gridDeviceContainer",children:[0!==c(t.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"ranges field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:c(t.fields).map((function(e,n){return Object(o.jsx)("div",{className:"slider-container",children:Object(o.jsx)(en,{device:t,item:e})},n)}))})]}):null,0!==n(t.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"switchs"}),Object(o.jsx)("div",{className:"containerBlockcontent dopBlubContainer",children:n(t.fields).map((function(e,n){return Object(o.jsx)(ln,{device:t,item:e})}))})]}):null,0!==a(t.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"text field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:a(t.fields).map((function(e,n){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsx)(tn,{device:t,item:e})},n)}))})]}):null,0!==i(t.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"enum field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:i(t.fields).map((function(e,n){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsx)(nn,{device:t,item:e})},n)}))})]}):null,0!==r(t.fields).length?Object(o.jsxs)("div",{className:"containerBlock",children:[Object(o.jsx)("div",{className:"titleBlock",children:"sensors field"}),Object(o.jsx)("div",{className:"containerBlockcontent",children:r(t.fields).map((function(e,n){return Object(o.jsx)("div",{className:"text-container",children:Object(o.jsxs)("div",{className:"sensor-container",children:[Object(o.jsx)("p",{className:"name",children:e.name}),Object(o.jsx)("p",{className:"value",children:String(Qt(t,e.name))})]})},n)}))})]}):null]}),Object(o.jsx)("div",{className:"HistoryBlock",children:Object(o.jsx)(sn,{device:t})})]})},dn=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(c.useContext)(g).setData,r=Object(c.useContext)(Me).devices,s=Object(Re.i)().systemName;return Object(c.useEffect)((function(){if(r){var e=r.filter((function(e){return e&&e.systemName===s}))[0];a(e)}}),[r,s]),Object(c.useEffect)((function(){i(null===n||void 0===n?void 0:n.name)}),[i,n]),n&&"online"===n.status&&(null===n||void 0===n?void 0:n.value)?Object(o.jsx)("div",{className:"conteiner fon bottom",children:"light"===(null===n||void 0===n?void 0:n.type)?Object(o.jsx)(on,{device:n}):Object(o.jsx)(un,{device:n})}):null},jn=function(e,t,n){},bn=function(e){var t=e.updata,n=e.title,a=e.type,i=(e.conf,e.value),r=e.systemName,s=e.outValue,l=void 0===s?jn:s,u=Object(c.useState)(i||0),d=Object(j.a)(u,2),b=d[0],m=d[1];Object(c.useEffect)((function(){m(i)}),[i]);return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:n||a})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceLiControl",children:Object(o.jsxs)("label",{className:"switch",children:[Object(o.jsx)("input",{onChange:function(e){m(e.target.checked),e.target.checked?l(r,a,1):l(r,a,0),setTimeout((function(){"function"===typeof t&&t()}),500)},name:"auteStyle",type:"checkbox",checked:b}),Object(o.jsx)("span",{}),Object(o.jsx)("i",{className:"indicator"})]})})})]})},mn=function(e,t,n){},vn=function(e){var t=e.updata,n=e.title,a=e.type,i=e.conf,r=e.value,s=e.systemName,l=e.outValue,u=void 0===l?mn:l,d=Object(c.useState)(0),b=Object(j.a)(d,2),m=b[0],v=b[1],O=Object(c.useRef)(null);Object(c.useEffect)((function(){v(r)}),[r]);var f,h=function(e){v(e.target.value),setTimeout((function(){"function"===typeof t&&t()}),500),O.current&&clearTimeout(O.current),O.current=setTimeout((function(){u(s,a,e.target.value)}),200)};return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:n||"level"})}),Object(o.jsxs)("div",{className:"DeviceControlLiContent",children:[Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:m||"0"})}),Object(o.jsx)("div",{className:"DeviceLiControl ".concat((f=a,-1!==f.indexOf("color")?"allColor":"")),children:Object(o.jsx)("input",{type:"range",value:m||0,min:i.min,max:i.max,onChange:h,onInput:h})})]})]})},On=function(e,t,n){},fn=function(e){var t=e.updata,n=e.title,a=e.type,i=e.conf,r=e.value,s=e.systemName,l=e.outValue,u=void 0===l?On:l,d=Object(c.useState)(0),b=Object(j.a)(d,2),m=b[0],v=b[1];Object(c.useEffect)((function(){v(r)}),[r]);var O=function(e){m>=i-1?(v(0),u(s,a,0)):(u(s,a,m+1),v(m+1)),setTimeout((function(){"function"===typeof t&&t()}),500)};return 2===i?Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:n||a})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceLiControl",children:Object(o.jsx)("div",{className:"custom1-checkbox",children:Object(o.jsx)("div",{className:"custom1-inner ".concat(1===m?"active":""),onClick:O,children:Object(o.jsx)("div",{className:"custom1-toggle"})})})})})]}):Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:n||"mode"})}),Object(o.jsxs)("div",{className:"DeviceControlLiContent",children:[Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:m})}),Object(o.jsx)("div",{className:"DeviceLiControl",children:Object(o.jsx)("input",{type:"button",value:"mode",onClick:O})})]})]})},hn=function(e,t,n){},xn=function(e){e.updata;var t=e.title,n=e.type,a=e.conf,i=e.value,r=e.systemName,s=e.outValue,l=void 0===s?hn:s,u=Object(c.useState)(0),d=Object(j.a)(u,2),b=d[0],m=d[1];Object(c.useEffect)((function(){m(i)}),[i]);var v;return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:t||n})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceLiControl",children:Object(o.jsx)("select",{value:b,onChange:function(e){m(e.target.value),l(r,n,e.target.value)},children:(v=a,v.split(" ").join("").split(",")).map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))})})})]})},pn=function(e,t,n){},gn=function(e){e.updata;var t=e.title,n=e.type,a=(e.conf,e.value),i=e.systemName,r=e.outValue,s=void 0===r?pn:r,l=Object(c.useState)(a),u=Object(j.a)(l,2),d=u[0],b=u[1];return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:t||"text"})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsxs)("div",{className:"DeviceLiControl",style:{display:"flex",justifyContent:"flex-end"},children:[Object(o.jsx)("input",{type:"text",onFocus:function(){},value:d,onChange:function(e){b(e.target.value)}}),Object(o.jsx)("input",{type:"button",onClick:function(){s(i,n,d)},value:"send"})]})})]})},yn=function(e){var t=e.systemName,n=Object(Re.g)(),a=Object(c.useContext)(Me),i=a.devices,r=a.updateDevice,s=Object(c.useContext)(G),l=Object(c.useContext)(E),u=Y().message,d=B(),b=d.request,m=d.error,v=d.clearError,O=Object(c.useState)({}),f=Object(j.a)(O,2),p=f[0],g=f[1],y=Object(c.useState)(!0),N=Object(j.a)(y,2),A=N[0],k=N[1];if(Object(c.useEffect)((function(){if(i){var e=i.filter((function(e){return e&&e.systemName===t}))[0];g(e),e&&("unlink"===e.status?k(!1):k(!0))}}),[i,t]),Object(c.useEffect)((function(){return u(m,"error"),function(){v()}}),[m,u,v]),!p)return null;var C=function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/device/value/set","POST",{systemName:t,type:n,status:c},{Authorization:"Bearer ".concat(l.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}();return Object(o.jsxs)("div",{className:"NewCardElement",children:[Object(o.jsxs)("div",{className:"NewCardHeader",children:[Object(o.jsx)("div",{className:"typeConnect ".concat(p.typeConnect||"other"),children:Object(o.jsx)("p",{children:p.typeConnect||"other"})}),Object(o.jsx)(Je,{onClick:function(){"online"===(null===p||void 0===p?void 0:p.status)&&(null===p||void 0===p?void 0:p.value)&&n.push("/devices/ditail/".concat(p.systemName))},className:"DeviceName",id:p.systemName,text:p.name||"NuN"}),l.userLevel>=3?Object(o.jsx)(I,{buttons:[{title:"edit",onClick:function(){s.show("EditDevices",r,p)}},{title:"unlink"===p.status?"linc":"unlink",onClick:function(){k((function(e){return!e})),b("/api/device/status/set","POST",{systemName:p.systemName,status:!A},{Authorization:"Bearer ".concat(l.token)})}}]}):null]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"NewCardBody",children:Object(o.jsx)("ul",{children:"online"!==p.status?Object(o.jsx)("li",{className:"DeviceControlLi",children:Object(o.jsx)("h4",{className:"offline",children:p.status})}):p.fields.map((function(e,t){return"binary"===e.type&&e.control?Object(o.jsx)(bn,{outValue:C,updata:r,systemName:p.systemName,value:!(!p.value||"1"!==String(p.value[e.name])),type:e.name},t):"number"===e.type&&e.control?Object(o.jsx)(vn,{outValue:C,updata:r,systemName:p.systemName,value:p.value?Number(p.value[e.name]):0,type:e.name,title:e.name,conf:{min:e.low,max:e.high}},t):"number"===e.type&&e.control?Object(o.jsx)(fn,{outValue:C,updata:r,systemName:p.systemName,value:p.value?Number(p.value[e.name]):0,type:e.name,conf:Number(e.high)},t):"enum"===e.type&&e.control?Object(o.jsx)(xn,{outValue:C,updata:r,systemName:p.systemName,value:p.value?p.value[e.name]:0,type:e.name,conf:e.values},t):"text"===e.type&&e.control?Object(o.jsx)(gn,{outValue:C,updata:r,systemName:p.systemName,value:p.value?p.value[e.name]:0,type:e.name,conf:e.values,title:e.name},t):e.control?null:Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:e.name})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:p.value[e.name]})})})]},t)}))})})]})},Nn=function(){var e=Object(Re.g)(),t=Object(c.useContext)(E),n=Object(c.useContext)(Me),a=Object(c.useContext)(g).setData,i=Object(c.useState)([]),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useRef)(0);Object(c.useEffect)((function(){u.current<3&&(l(n.devices),u.current++)}),[n.devices]);var d=Object(c.useCallback)((function(e){if(""!==e){var t=n.devices.filter((function(t){return t&&-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}));l(t)}else l(n.devices)}),[n.devices]);return Object(c.useEffect)((function(){a("Device All",{specialAction:t.userLevel>=3?{type:"add",action:function(){return e.push("/devices/add")}}:null,search:d})}),[a,e,d,t.userLevel]),Object(o.jsx)("div",{className:"conteiner top bottom",children:Object(o.jsx)("div",{className:"Devices",children:s&&0!==s.length?Object(o.jsx)("div",{className:"CardConteiner",children:s.map((function(e,t){return e?Object(o.jsx)(yn,{systemName:e.systemName},t):null}))}):Object(o.jsx)("h2",{className:"empty",children:"Not elements"})})})},An=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(g).setData,n=Y().message,a=B(),i=a.loading,r=a.request,l=a.error,u=a.clearError,d=Object(Re.h)(),b=Object(c.useState)({}),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)({UserName:"",UserSurname:"",Mobile:"",Email:"",ImageId:0}),p=Object(j.a)(f,2),y=p[0],N=p[1],A=Object(c.useState)({Old:"",New:""}),k=Object(j.a)(A,2),C=k[0],w=k[1];Object(c.useEffect)((function(){return n(l,"error"),function(){u()}}),[l,n,u]);var S=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r("/api/user/get","GET",null,{Authorization:"Bearer ".concat(e.token)});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:O(n),N({UserName:n.UserName||"",UserSurname:n.UserSurname||"",Mobile:n.Mobile||"",Email:n.Email||"",ImageId:n.ImageId||0});case 7:case"end":return t.stop()}}),t)}))),[r,e.token]);Object(c.useEffect)((function(){S()}),[S]);var D=function(e){N(Object(R.a)(Object(R.a)({},y),{},Object(V.a)({},e.target.name,e.target.value)))},T=function(e){w(Object(R.a)(Object(R.a)({},C),{},Object(V.a)({},e.target.name,e.target.value)))},q=function(){var t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r("/api/user/edit","POST",y,{Authorization:"Bearer ".concat(e.token)});case 2:"ok"===t.sent&&S();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),L=function(){var t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r("/api/user/password/edit","POST",Object(R.a)({},C),{Authorization:"Bearer ".concat(e.token)});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){t("Profile")}),[t]),Object(o.jsx)("div",{className:"fullScrinContainer color-normal",children:Object(o.jsx)("div",{className:"pages",children:i?Object(o.jsx)(H,{}):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"page ".concat("/profile"===d.pathname?"active":""),children:[Object(o.jsx)("i",{className:"fas fa-sign-out-alt logout-btn",onClick:e.logout}),Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsx)("h2",{children:"Profile"}),Object(o.jsxs)("p",{children:["User Name: ",v.UserName]}),Object(o.jsxs)("p",{children:["User Surname: ",v.UserSurname||"NuN"]}),Object(o.jsxs)("p",{children:["User Email: ",v.Email||"NuN"]}),Object(o.jsxs)("p",{children:["User Mobile: ",v.Mobile||"NuN"]}),Object(o.jsxs)("p",{children:["User Level: ",3===v.Level?"Admin":2===v.Level?"Mid":"Low"]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"controlElement",children:[Object(o.jsx)(s.c,{to:"/config",className:"normalSelection button",children:"Client settings"}),Object(o.jsx)(s.c,{to:"/profile/edit",className:"normalSelection button",children:"Edit profile"}),Object(o.jsx)(s.c,{to:"/profile/editPass",className:"normalSelection button",children:"Edit password"})]})]})]}),Object(o.jsx)("div",{className:"page ".concat("/profile/edit"===d.pathname?"active":""),children:Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsx)("h2",{children:"Profile"}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:D,required:!0,name:"UserName",type:"text",value:y.UserName}),Object(o.jsx)("label",{children:"Name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:D,required:!0,name:"UserSurname",type:"text",value:y.UserSurname}),Object(o.jsx)("label",{children:"Surname"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:D,required:!0,name:"Email",type:"email",value:y.Email}),Object(o.jsx)("label",{children:"Email"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:D,required:!0,name:"Mobile",type:"tel",value:y.Mobile}),Object(o.jsx)("label",{children:"Mobile"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("button",{style:{width:"100%"},className:"normalSelection button",onClick:q,children:"Save"})})]})}),Object(o.jsx)("div",{className:"page ".concat("/profile/editPass"===d.pathname?"active":""),children:Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsx)("h2",{children:"Change password"}),Object(o.jsxs)("p",{children:["Name: ",v.UserName]}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"Old",type:"password",value:C.Old}),Object(o.jsx)("label",{children:"Old password"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:T,required:!0,name:"New",type:"password",value:C.New}),Object(o.jsx)("label",{children:"New password"})]})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("button",{style:{width:"100%"},className:"normalSelection button",onClick:L,children:"Save"})})]})})]})})})},kn=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(S),n=Object(Re.g)(),a=Object(c.useContext)(an),i=a.styles,r=a.updateConfig,s=Y().message,l=B(),u=l.loading,d=l.request,b=l.error,m=l.clearError,v=Object(c.useState)(!1),O=Object(j.a)(v,2),f=O[0],p=O[1],g=Object(c.useState)({auteStyle:t.auteStyle||!1,staticBackground:t.staticBackground||!1,style:t.Style||"light"}),y=Object(j.a)(g,2),N=y[0],A=y[1],k=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:A({auteStyle:t.auteStyle||!1,staticBackground:t.staticBackground||!1,style:t.Style||"light"});case 3:case"end":return e.stop()}}),e)}))),[t]),C=function(){var t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("/api/user/config/edit","POST",N,{Authorization:"Bearer ".concat(e.token)});case 2:r(),setTimeout((function(){k()}),500);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d("/api/style/delete","POST",{name:n.target.dataset.name},{Authorization:"Bearer ".concat(e.token)});case 2:r(),setTimeout((function(){k()}),500);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();Object(c.useEffect)((function(){k()}),[k]);var D=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A(Object(R.a)(Object(R.a)({},N),{},{style:t.target.dataset.name}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){A(Object(R.a)(Object(R.a)({},N),{},Object(V.a)({},e.target.name,e.target.checked)))};return Object(c.useEffect)((function(){return s(b,"error"),function(){m()}}),[b,s,m]),u?Object(o.jsx)(H,{}):Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsxs)("div",{className:"configElement",children:[Object(o.jsx)("p",{className:"switchText",children:"changing style when changing time of day"}),Object(o.jsxs)("label",{className:"switch",children:[Object(o.jsx)("input",{onChange:T,name:"auteStyle",type:"checkbox",checked:N.auteStyle}),Object(o.jsx)("span",{}),Object(o.jsx)("i",{className:"indicator"})]})]}),Object(o.jsxs)("div",{className:"configElement",children:[Object(o.jsx)("p",{className:"switchText",children:"static background"}),Object(o.jsxs)("label",{className:"switch",children:[Object(o.jsx)("input",{onChange:T,name:"staticBackground",type:"checkbox",checked:N.staticBackground}),Object(o.jsx)("span",{}),Object(o.jsx)("i",{className:"indicator"})]})]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsxs)("div",{className:"configElement block",children:[Object(o.jsx)("p",{className:"switchText",children:"Style"}),Object(o.jsx)(I,{buttons:[{title:"create",onClick:function(){return n.push("/config/style")}},{title:"detete",onClick:function(){return p(!f)}}]}),Object(o.jsx)("div",{className:"StyleChoice",children:null===i||void 0===i?void 0:i.map((function(e,t){return Object(o.jsxs)("div",{onClick:f&&"light"!==e.name&&"night"!==e.name?w:D,className:"choiceElement ".concat(f&&"light"!==e.name&&"night"!==e.name?"deleted":""," ").concat(N.style===e.name?"active":null),"data-name":e.name,children:[Object(o.jsx)(ne,{colors:e}),Object(o.jsx)("p",{className:"styleName",children:e.name})]},t)}))})]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("button",{style:{width:"100%"},className:"normalSelection button",onClick:C,children:"Save"})})]})},Cn=function(){var e=Object(c.useContext)(E),t=Y().message,n=B(),a=n.loading,i=n.request,r=n.error,s=n.clearError,l=Object(c.useState)([]),u=Object(j.a)(l,2),d=u[0],b=u[1];Object(c.useEffect)((function(){return t(r,"error"),function(){s()}}),[r,t,s]);var m=function(){var t=Object(x.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i("/api/server/config/edit","POST",{moduleConfig:d},{Authorization:"Bearer ".concat(e.token)});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n,c,a,r,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i("/api/server/config/get","GET",null,{Authorization:"Bearer ".concat(e.token)});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:c=[],a=Object(p.a)(n.moduleConfig);try{for(a.s();!(r=a.n()).done;)s=r.value,c.push(s)}catch(l){a.e(l)}finally{a.f()}b(c);case 9:case"end":return t.stop()}}),t)}))),[i,e.token]);return Object(c.useEffect)((function(){v()}),[v]),a?Object(o.jsx)(H,{}):Object(o.jsxs)("div",{className:"pagecontent",children:[d.map((function(e,t){var n;return Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"configTitle",children:Object(o.jsx)("p",{className:"text",children:e.name})}),null===e||void 0===e||null===(n=e.fields)||void 0===n?void 0:n.map((function(t,n){return Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(n){return function(e,t,n){var c,a=d.slice(),i=Object(p.a)(a);try{for(i.s();!(c=i.n()).done;){var r=c.value;if(r.name===t){var s,l=Object(p.a)(r.fields);try{for(l.s();!(s=l.n()).done;){var o=s.value;if(o.name===n)return o.value=e.target.value,void b(a)}}catch(u){l.e(u)}finally{l.f()}return}}}catch(u){i.e(u)}finally{i.f()}}(n,e.name,t.name)},required:!0,name:t.name,type:"text",value:t.value,disabled:!t}),Object(o.jsx)("label",{children:t.name})]})},n)})),Object(o.jsx)("div",{className:"dividers"})]},t)})),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("button",{style:{width:"100%"},className:"normalSelection button",onClick:m,children:"Save"})})]})},wn=function(){var e=Object(c.useContext)(S),t=Object(c.useState)({base:"",sunrise:"",day:"",twilight:"",night:""}),n=Object(j.a)(t,2),a=n[0],i=n[1],r=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n,c,a,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&e.images){t.next=2;break}return t.abrupt("return");case 2:n={},c=Object(p.a)(e.images);try{for(c.s();!(a=c.n()).done;)r=a.value,n=Object(R.a)(Object(R.a)({},n),{},Object(V.a)({},r.type,r.image))}catch(s){c.e(s)}finally{c.f()}i((function(e){return Object(R.a)(Object(R.a)({},e),n)}));case 6:case"end":return t.stop()}}),t)}))),[e]);return Object(c.useEffect)((function(){r()}),[r]),Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("h2",{children:"Background"})}),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)(s.b,{to:"/gallery",className:"button normalSelection",children:"Gallery"})}),Object(o.jsxs)("div",{className:"configElement img",children:[Object(o.jsxs)("div",{className:"card",children:[Object(o.jsx)("div",{className:"imgBx",children:Object(o.jsx)("img",{src:a.base,alt:"base"})}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:"Base"})})})]}),Object(o.jsxs)("div",{className:"card",children:[Object(o.jsx)("div",{className:"imgBx",children:Object(o.jsx)("img",{src:a.sunrise,alt:"sunrise"})}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:"Sunrise"})})})]}),Object(o.jsxs)("div",{className:"card",children:[Object(o.jsx)("div",{className:"imgBx",children:Object(o.jsx)("img",{src:a.day,alt:"day"})}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:"Day"})})})]}),Object(o.jsxs)("div",{className:"card",children:[Object(o.jsx)("div",{className:"imgBx",children:Object(o.jsx)("img",{src:a.twilight,alt:"twilight"})}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:"Twilight"})})})]}),Object(o.jsxs)("div",{className:"card",children:[Object(o.jsx)("div",{className:"imgBx",children:Object(o.jsx)("img",{src:a.night,alt:"night"})}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:"Night"})})})]})]})]})},En=function(e){var t=e.name,n=e.icon,c=e.url,a=e.use,i=void 0!==a&&a,r=e.onClick,s=e.def,l=void 0!==s&&s;return Object(o.jsxs)("div",{className:"menu-component-paragraph",children:[Object(o.jsx)("div",{className:"icon",children:Object(o.jsx)("i",{className:n})}),Object(o.jsx)("p",{children:t}),Object(o.jsx)("div",{className:"menu-component-btn",children:!l&&i?Object(o.jsx)("i",{className:"fas fa-times-circle",style:{color:"#f00"},onClick:function(){return r(t,n,c)}}):l||i?null:Object(o.jsx)("i",{className:"fas fa-plus-circle",style:{color:"#0f0"},onClick:function(){return r(t,n,c)}})})]})},Bn=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(S),n=Object(c.useContext)(an).updateConfig,a=Y().message,i=Object(c.useState)(!1),r=Object(j.a)(i,2),s=r[0],l=r[1],u=B(),d=u.loading,b=u.request,m=u.error,v=u.clearError,O=Object(c.useState)([]),f=Object(j.a)(O,2),g=f[0],y=f[1],N=Object(c.useState)([]),A=Object(j.a)(N,2),k=A[0],C=A[1];Object(c.useEffect)((function(){return a(m,"error"),function(){v()}}),[m,a,v]);var w=function(){var t=Object(x.a)(h.a.mark((function t(c){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b("/api/user/menu/edit","POST",g,{Authorization:"Bearer ".concat(e.token)});case 2:setTimeout((function(){n()}),200);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var n,c,a,i,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.MenuElements){e.next=2;break}return e.abrupt("return");case 2:n=M,c=t.MenuElements,a=Object(p.a)(t.MenuElements);try{for(r=function(){var e=i.value;n=n.filter((function(t){return t.title!==e.title}))},a.s();!(i=a.n()).done;)r()}catch(s){a.e(s)}finally{a.f()}C(n),y(c);case 8:case"end":return e.stop()}}),e)}))),[t]);Object(c.useEffect)((function(){}),[t,g]),Object(c.useEffect)((function(){D()}),[D]);var T=function(e,t,n){var c=g,a=k;c.push({title:e,iconClass:t,url:n}),a=a.filter((function(t){return t.title!==e})),C(a),y(c)},q=function(e,t,n){var c,a=g,i=k,r=Object(p.a)(M);try{for(r.s();!(c=r.n()).done;){if(c.value.title===e)return i.push({title:e,iconClass:t,url:n}),a=a.filter((function(t){return t.title!==e})),C(i),void y(a)}}catch(s){r.e(s)}finally{r.f()}a=a.filter((function(t){return t.title!==e})),y(a)};return d?Object(o.jsx)(H,{}):Object(o.jsxs)(o.Fragment,{children:[s?Object(o.jsx)(He,{moving:!1,hide:function(){return l(!1)},title:"add",zindex:6,className:"createLinkWindow",children:Object(o.jsxs)("div",{className:"createLink",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{required:!0,id:"titlelink",type:"text",name:"title"}),Object(o.jsx)("label",{children:"title"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{required:!0,id:"titleicon",type:"text",name:"icon"}),Object(o.jsx)("label",{children:"icon"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{required:!0,id:"titleurl",type:"text",name:"url"}),Object(o.jsx)("label",{children:"title"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)("button",{className:"normalSelection button",onClick:function(){var e=document.getElementById("titlelink"),t=document.getElementById("titleicon"),n=document.getElementById("titleurl");T(e.value,t.value,n.value),l(!1)},children:"Save"})})]})}):null,Object(o.jsxs)("div",{className:"pagecontent",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)(En,{name:"Home",icon:"fas fa-home",def:!0})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)(En,{name:"Devices",icon:"fas fa-plug",def:!0})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)(En,{name:"Setings",icon:"fas fa-cogs",def:!0})}),g.map((function(e,t){return Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)(En,{name:e.title,url:e.url,icon:e.iconClass,onClick:q,use:!0},t)},t)})),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"menu-component-paragraph",onClick:function(){return l(!0)},children:[Object(o.jsx)("p",{children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"}),Object(o.jsx)("div",{className:"menu-component-btn",children:Object(o.jsx)("i",{className:"fas fa-plus-circle",style:{color:"#aaa"}})})]})}),Object(o.jsx)("div",{className:"dividers"}),k.map((function(e,t){return Object(o.jsx)("div",{className:"configElement",children:Object(o.jsx)(En,{name:e.title,url:e.url,onClick:T,icon:e.iconClass},t)},t)})),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"configElement block",children:Object(o.jsx)("button",{style:{width:"100%"},className:"normalSelection button",onClick:w,children:"Save"})})]})]})},Sn=function(){var e=Object(Re.g)(),t=Object(c.useContext)(E),n=Object(c.useContext)(g).setData,a=Object(Re.h)();return Object(c.useEffect)((function(){var c=[{title:"user",action:function(){return e.push("/config")},active:"/config"===a.pathname},{title:"image",action:function(){return e.push("/config/image")},active:"/config/image"===a.pathname},{title:"menu",action:function(){return e.push("/config/menu")},active:"/config/menu"===a.pathname}];t.userLevel>=3&&c.push({title:"server",action:function(){return e.push("/config/server")},active:"/config/server"===a.pathname}),n("Setings",{buttons:c})}),[n,a.pathname,e,t.userLevel]),Object(o.jsx)("div",{className:"fullScrinContainer color-normal page-whith-tabs",children:Object(o.jsxs)("div",{className:"pages",children:[Object(o.jsx)("div",{className:"page ".concat("/config"===a.pathname?"active":""),children:Object(o.jsx)(kn,{})}),Object(o.jsx)("div",{className:"page ".concat("/config/server"===a.pathname?"active":""),children:Object(o.jsx)(Cn,{})}),Object(o.jsx)("div",{className:"page ".concat("/config/image"===a.pathname?"active":""),children:Object(o.jsx)(wn,{})}),Object(o.jsx)("div",{className:"page ".concat("/config/menu"===a.pathname?"active":""),children:Object(o.jsx)(Bn,{})})]})})},Dn=function(e){var t=e.script,n=e.updata,a=Object(Re.g)(),i=Object(c.useState)(t.status),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Y().message,b=Object(c.useContext)(d),m=b.show,v=b.hide,O=B(),f=O.request,p=O.error,g=O.clearError,y=Object(c.useContext)(E);Object(c.useEffect)((function(){l(t.status)}),[t,y.userLevel]),Object(c.useEffect)((function(){return u(p,"error"),function(){g()}}),[p,u,g]);var N=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m("alert",{title:"Delete script",text:"delete ".concat(t.name,"?"),buttons:[{title:"ok",action:function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/api/script/delete?name=".concat(t.name),"GET",null,{Authorization:"Bearer ".concat(y.token)});case 2:n(),v();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{title:"cancel",action:v}]});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/api/script/run?name=".concat(t.name),"GET",null,{Authorization:"Bearer ".concat(y.token)});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(x.a)(h.a.mark((function e(c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l((function(e){return!e})),e.next=3,f("/api/script/status/set","POST",{name:t.name,status:!s},{Authorization:"Bearer ".concat(y.token)});case 3:"function"===typeof n&&setTimeout((function(){n()}),600);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(o.jsxs)("div",{className:"scriptElement",children:[Object(o.jsx)("p",{children:t.name}),Object(o.jsxs)("div",{className:"scriptStatus",children:[Object(o.jsx)("button",{onClick:A,className:"activateBtn",children:"activate"}),y.userLevel>=3?Object(o.jsx)("button",{onClick:function(){return a.push("/scripts/edit/".concat(t.name))},className:"showBtn",children:"edit"}):null,Object(o.jsxs)("div",{className:"switchConteiner",children:[Object(o.jsx)("p",{className:"switchText",children:s?"auto":"manual"}),t.trigger&&t.trigger[0]&&y.userLevel>=3?Object(o.jsxs)("label",{className:"switch",children:[Object(o.jsx)("input",{onChange:k,name:"auteStyle",type:"checkbox",checked:s}),Object(o.jsx)("span",{}),Object(o.jsx)("i",{className:"indicator"})]}):null]}),y.userLevel>=3?Object(o.jsx)("button",{onClick:N,className:"deleteBtn",children:Object(o.jsx)("i",{className:"fas fa-trash"})}):null]})]})},Tn=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(Re.g)(),r=Object(c.useState)([]),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useContext)(E),b=Object(c.useContext)(g).setData,m=Y().message,v=B(),O=v.loading,f=v.request,p=v.error,y=v.clearError;Object(c.useEffect)((function(){return m(p,"error"),function(){y()}}),[p,m,y]);var N=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/api/script/all","GET",null,{Authorization:"Bearer ".concat(d.token)});case 2:t=e.sent,a(t),u(t);case 5:case"end":return e.stop()}}),e)}))),[f,d.token]),A=Object(c.useCallback)((function(e){if(""!==e){var t=l.filter((function(t){return-1!==t.name.indexOf(e)}));a(t)}else a(l)}),[l]);return Object(c.useEffect)((function(){b("Scripts All",{specialAction:d.userLevel>=3&&window.screen.width>700?{type:"add",action:function(){return i.push("/scripts/add")}}:null,search:A})}),[b,A,i,d.userLevel]),Object(c.useEffect)((function(){N()}),[N]),Object(o.jsx)(o.Fragment,{children:Object(o.jsx)("div",{className:"conteiner top bottom",children:Object(o.jsx)("div",{className:"Scripts",children:Object(o.jsx)("div",{className:"scriptsList",children:O?Object(o.jsx)(H,{}):n&&n[0]?n.map((function(e,t){return Object(o.jsx)(Dn,{script:e,updata:N},t)})):Object(o.jsx)("h2",{className:"empty",children:"Not elements"})})})})})},qn=function(e){var t=e.data,n=e.updata,a=e.index,i=e.type,r=e.deleteEl,s=e.block,l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useContext)(Me).devices,v=Object(c.useState)({}),O=Object(j.a)(v,2),f=O[0],h=O[1],x=Object(c.useCallback)((function(e){return m.filter((function(t){return t.systemName===e}))[0]}),[m]),p=function(e,t){return e.fields.filter((function(e){return e.name===t}))[0]};Object(c.useEffect)((function(){b(x(t.systemName)),h(p(x(t.systemName),t.action))}),[x,t]);var g;return 0===Object.keys(d).length||0===Object.keys(f).length?null:Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:d?d.name:"Name"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("select",{value:f.name,onChange:function(e){h(p(x(t.systemName),t.action)),n({index:a,action:e.target.value})},name:"property",children:(g=d.fields,g.filter((function(e){return"number"===i&&("number"===e.type||"binary"===e.type)||"binary"===i&&"binary"===e.type||"text"===i||"enum"===i&&"enum"===e.type||!i}))).map((function(e,t){return Object(o.jsx)("option",{value:e.name,children:e.name},t)}))})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){r(a,s)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Ln=function(e){var t,n=e.data,a=e.updata,i=(e.block,e.deleteEl),r=Object(c.useState)(null!==(t=n.value)&&void 0!==t?t:""),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useState)(),b=Object(j.a)(d,2),m=b[0],v=b[1];return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:"value"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"text",onChange:function(e){clearTimeout(m),u(e.target.value),v(setTimeout((function(){a({action:e.target.value})}),2e3))},value:l})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){i()},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},In=function(e){var t,n=e.data,a=e.updata,i=(e.block,e.deleteEl),r=Object(c.useState)(null!==(t=Number(n.value))&&void 0!==t?t:0),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useState)(),b=Object(j.a)(d,2),m=b[0],v=b[1];return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:"value"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"number",onChange:function(e){clearTimeout(m),u(e.target.value),v(setTimeout((function(){a({action:e.target.value})}),2e3))},value:l})}),i?Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){i()},children:Object(o.jsx)("i",{className:"fas fa-trash"})}):null]})},Fn=function(e){var t=e.data,n=e.updata,a=(e.block,e.deleteEl),i=e.values,r=void 0===i?[]:i,s=Object(c.useState)(t.value),l=Object(j.a)(s,2),u=l[0],d=l[1];return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:"value"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("select",{onChange:function(e){d(e.target.value),n({action:e.target.value})},value:u,children:r.map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){a()},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},zn=function e(t){var n,a=t.data,i=t.updata,r=(t.block,t.deleteEl),s=Object(c.useState)(null!==(n=a.action)&&void 0!==n?n:"+"),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(c.useContext)(Pe),m=b.deviceBlock,v=b.typeValue,O=function(e){v("addValue",{type:"number"},(function(t,n){var c=a;"DeviceValue"===t&&m((function(t){c=Object(R.a)(Object(R.a)({},c),{},Object(V.a)({},e,{type:"device",systemName:t.systemName,action:t.fields[0].name})),i(c)}),"if","number"),"Text"===t&&(c=Object(R.a)(Object(R.a)({},c),{},Object(V.a)({},e,{type:"text",value:""}))),"Number"===t&&(c=Object(R.a)(Object(R.a)({},c),{},Object(V.a)({},e,{type:"number",value:0}))),"Math"===t&&(c=Object(R.a)(Object(R.a)({},c),{},Object(V.a)({},e,{type:"math",value1:null,value2:null,action:"+"}))),i(c)}))},f=function(e,t){var n=a,c=n[t];"device"===a[t].type&&(c=Object(R.a)(Object(R.a)({},c),{},{action:e.action})),"text"===a[t].type&&(c=Object(R.a)(Object(R.a)({},c),{},{value:e.action})),"number"===a[t].type&&(c=Object(R.a)(Object(R.a)({},c),{},{value:e.action})),"enum"===a[t].type&&(c=Object(R.a)(Object(R.a)({},c),{},{value:e.action})),"math"===a[t].type&&(c=e),n[t]=c,i(n)},h=function(e){var t=Object(R.a)(Object(R.a)({},a),{},Object(V.a)({},e,null));i(t)};return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-conteiner-item",children:a.value1?"device"===a.value1.type?Object(o.jsx)(qn,{data:a.value1,type:"number",updata:function(e){return f(e,"value1")},deleteEl:function(){return h("value1")}}):"text"===a.value1.type?Object(o.jsx)(Ln,{data:a.value1,updata:function(e){return f(e,"value1")},deleteEl:function(){return h("value1")}}):"number"===a.value1.type?Object(o.jsx)(In,{data:a.value1,updata:function(e){return f(e,"value1")},deleteEl:function(){return h("value1")}}):"math"===a.value1.type?Object(o.jsx)(e,{data:a.value1,updata:function(e){return f(e,"value1")},deleteEl:function(){return h("value1")}}):null:Object(o.jsx)("div",{className:"programm-function-block-content-item add",onClick:function(){O("value1")},children:Object(o.jsx)("i",{className:"fas fa-plus"})})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsxs)("select",{value:u,onChange:function(e){var t=a;d(e.target.value),t=Object(R.a)(Object(R.a)({},t),{},{action:e.target.value}),i(t)},name:"property",children:[Object(o.jsx)("option",{value:"+",children:"+"}),Object(o.jsx)("option",{value:"-",children:"-"}),Object(o.jsx)("option",{value:"*",children:"*"}),Object(o.jsx)("option",{value:"/",children:"/"})]})}),Object(o.jsx)("div",{className:"programm-function-block-conteiner-item",children:a.value2?"device"===a.value2.type?Object(o.jsx)(qn,{data:a.value2,type:"number",updata:function(e){return f(e,"value2")},deleteEl:function(){return h("value2")}}):"text"===a.value2.type?Object(o.jsx)(Ln,{data:a.value2,updata:function(e){return f(e,"value2")},deleteEl:function(){return h("value2")}}):"number"===a.value2.type?Object(o.jsx)(In,{data:a.value2,updata:function(e){return f(e,"value2")},deleteEl:function(){return h("value2")}}):"math"===a.value2.type?Object(o.jsx)(e,{data:a.value2,updata:function(e){return f(e,"value2")},deleteEl:function(){return h("value2")}}):null:Object(o.jsx)("div",{className:"programm-function-block-content-item add",onClick:function(){O("value2")},children:Object(o.jsx)("i",{className:"fas fa-plus"})})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){r()},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Pn=function(e){e.idDevice;var t,n,a,i=e.updata,r=e.index,s=e.data,l=e.deleteEl,u=Object(c.useState)({}),d=Object(j.a)(u,2),b=d[0],m=d[1],v=Object(c.useContext)(Me).devices,O=Object(c.useContext)(Pe),f=O.deviceBlock,h=O.typeValue,x=Object(c.useState)(null!==(t=s.oper)&&void 0!==t?t:"=="),p=Object(j.a)(x,2),g=p[0],y=p[1],N=Object(c.useState)({}),A=Object(j.a)(N,2),k=A[0],C=A[1],w=Object(c.useCallback)((function(e){return v.filter((function(t){return t.systemName===e}))[0]}),[v]),E=function(e,t){return e.fields.filter((function(e){return e.name===t}))[0]},B=function(e){return e.split(" ").join("").split(",")};Object(c.useEffect)((function(){m(w(s.systemName)),C(E(w(s.systemName),s.action))}),[w,s]);var S=function(e){var t=Object(R.a)(Object(R.a)({},s),{},Object(V.a)({},e.target.name,e.target.value));"action"===e.target.name&&C(E(w(s.systemName),t.action)),"oper"===e.target.name&&y(t.oper),i(t,r)},D=function(e){var t=s,n=t.value;"device"===s.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{action:e.action})),"text"===s.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"number"===s.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"enum"===s.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"math"===s.value.type&&(n=e),t.value=n,i(t,r)},T=function(){var e=Object(R.a)(Object(R.a)({},s),{},{value:null});i(e,r)};return 0===(null===(n=Object.keys(b))||void 0===n?void 0:n.length)||0===(null===(a=Object.keys(k))||void 0===a?void 0:a.length)?null:Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:b?b.name:"Name"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("select",{value:k.name,onChange:S,name:"action",children:b.fields.map((function(e,t){return Object(o.jsx)("option",{value:e.name,children:e.name},t)}))})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsxs)("select",{value:g,onChange:S,name:"oper",children:[Object(o.jsx)("option",{value:"==",children:"=="}),Object(o.jsx)("option",{value:"!=",children:"!="}),"number"===k.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("option",{value:">=",children:">="}),Object(o.jsx)("option",{value:"<=",children:"<="}),Object(o.jsx)("option",{value:">",children:">"}),Object(o.jsx)("option",{value:"<",children:"<"})]}):null]})}),Object(o.jsx)("div",{className:"programm-function-block-conteiner-item",children:s.value?"device"===s.value.type?Object(o.jsx)(qn,{data:s.value,type:k.type,updata:D,deleteEl:T}):"text"===s.value.type?Object(o.jsx)(Ln,{data:s.value,updata:D,deleteEl:T}):"number"===s.value.type?Object(o.jsx)(In,{data:s.value,updata:D,deleteEl:T}):"math"===s.value.type?Object(o.jsx)(zn,{data:s.value,updata:D,deleteEl:T}):"enum"===s.value.type&&"enum"===k.type?Object(o.jsx)(Fn,{data:s.value,values:B(k.values),updata:D,deleteEl:T}):"enum"===s.value.type&&"binary"===k.type?Object(o.jsx)(Fn,{data:s.value,values:["high","low"],updata:D,deleteEl:T}):null:Object(o.jsx)("div",{className:"programm-function-block-content-item add",onClick:function(){h("addValue",{type:k.type},(function(e){var t=s;"DeviceValue"===e&&f((function(e){t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"device",systemName:e.systemName,action:e.fields[0].name}}),i(t,r)}),"if",k.type),"Text"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"text",value:""}})),"Number"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"number",value:0}})),"Math"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"math",value1:null,value2:null,action:"+"}})),"Enum"===e&&"binary"===k.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:"low"}})),"Enum"===e&&"enum"===k.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:B(k.values)[0]}})),i(t,r)}))},children:Object(o.jsx)("i",{className:"fas fa-plus"})})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){l(r)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Mn=function e(t){var n=t.index,a=t.type,i=(t.children,t.data),r=t.updata,s=t.deleteEl,l=Object(c.useContext)(Pe),u=l.deviceBlock,d=l.typeIf,b=Object(c.useState)(i),m=Object(j.a)(b,1)[0],v=function(e){var t=m;t.children=t.children.filter((function(t,n){return n!==e})),r(t,n)},O=function(e,t){var c=m;c.children[t]=e,r(c,n)};return Object(o.jsxs)("div",{className:"groupBlock",children:[Object(o.jsxs)("div",{className:"groupBlockTop",children:[Object(o.jsx)("p",{className:"textBlock",children:"start of block ".concat(a)}),Object(o.jsx)("div",{className:"addBlock",onClick:function(){d((function(e){if("groupBlockAnd"===e){var t=m;t.children.push({type:"group",oper:"and",children:[],systemName:null,action:null,value:null}),r(t,n)}else if("groupBlockOr"===e){var c=m;c.children.push({type:"group",oper:"or",children:[],systemName:null,action:null,value:null}),r(c,n)}else"deviceBlock"===e&&u((function(e){var t=m,c=e.fields[0].name;t.children.push({type:"device",oper:"==",systemName:e.systemName,action:c,value:""}),r(t,n)}),"if")}))},children:Object(o.jsx)("i",{className:"fas fa-plus"})}),"function"===typeof s?Object(o.jsx)("div",{className:"deleteBlock",onClick:function(){return s(n)},children:Object(o.jsx)("i",{className:"fas fa-trash"})}):null]}),Object(o.jsx)("div",{className:"groupBlockConteiner",children:m?m.children.map((function(t,n){return"group"===t.type?Object(o.jsx)(e,{index:n,deleteEl:v,updata:O,type:t.oper,data:t},n):Object(o.jsx)(Pn,{data:t,deleteEl:v,index:n,updata:O,idDevice:t.systemName},n)})):null}),Object(o.jsx)("div",{className:"groupBlockBottom",children:Object(o.jsx)("p",{className:"textBlock",children:"end block"})})]})},Un=function(e){var t,n,a=e.updata,i=e.index,r=e.data,s=e.deleteEl,l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useContext)(Me).devices,v=Object(c.useContext)(Pe),O=v.deviceBlock,f=v.typeValue,h=Object(c.useState)({}),x=Object(j.a)(h,2),p=x[0],g=x[1],y=Object(c.useCallback)((function(e){return m.filter((function(t){return t.systemName===e}))[0]}),[m]),N=function(e,t){var n;return null===e||void 0===e||null===(n=e.fields)||void 0===n?void 0:n.filter((function(e){return e.name===t}))[0]},A=function(e){return e.split(" ").join("").split(",")};Object(c.useEffect)((function(){b(y(r.systemName)),g(N(y(r.systemName),r.action))}),[y,r]);var k=function(e){var t=r,n=t.value;"device"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{action:e.action})),"text"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"number"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"enum"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"math"===r.value.type&&(n=e),t.value=n,a(Object(R.a)(Object(R.a)({},t),{},{index:i}))},C=function(){var e=Object(R.a)(Object(R.a)({},r),{},{value:null});a(Object(R.a)(Object(R.a)({},e),{},{index:i}))};return 0===(null===Object||void 0===Object||null===(t=Object.keys(d||""))||void 0===t?void 0:t.length)||0===(null===Object||void 0===Object||null===(n=Object.keys(p||""))||void 0===n?void 0:n.length)?null:Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:d?d.name:"Name"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("select",{value:p.name,onChange:function(e){var t=Object(R.a)(Object(R.a)({},r),{},Object(V.a)({},e.target.name,e.target.value));"action"===e.target.name&&g(N(y(r.systemName),t.action)),a(Object(R.a)(Object(R.a)({},t),{},{index:i}))},name:"action",children:d.fields.map((function(e,t){return Object(o.jsx)("option",{value:e.name,children:e.name},t)}))})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:"=="}),Object(o.jsx)("div",{className:"programm-function-block-conteiner-item",children:r.value?"device"===r.value.type?Object(o.jsx)(qn,{data:r.value,type:p.type,updata:k,deleteEl:C}):"text"===r.value.type?Object(o.jsx)(Ln,{data:r.value,updata:k,deleteEl:C}):"number"===r.value.type?Object(o.jsx)(In,{data:r.value,updata:k,deleteEl:C}):"math"===r.value.type?Object(o.jsx)(zn,{data:r.value,updata:k,deleteEl:C}):"enum"===r.value.type&&"enum"===p.type?Object(o.jsx)(Fn,{data:r.value,values:A(p.values),updata:k,deleteEl:C}):"enum"===r.value.type&&"binary"===p.type?Object(o.jsx)(Fn,{data:r.value,values:["high","low","togle"],updata:k,deleteEl:C}):null:Object(o.jsx)("div",{className:"programm-function-block-content-item add",onClick:function(){f("addValue",{type:p.type},(function(e){var t=r;"DeviceValue"===e&&O((function(e){t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"device",systemName:e.systemName,action:e.fields[0].name}}),a(t,i)}),"if",p.type),"Text"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"text",value:""}})),"Number"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"number",value:0}})),"Math"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"math",value1:null,value2:null,action:"+"}})),"Enum"===e&&"binary"===p.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:"low"}})),"Enum"===e&&"enum"===p.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:A(p.values)[0]}})),a(Object(R.a)(Object(R.a)({},t),{},{index:i}))}))},children:Object(o.jsx)("i",{className:"fas fa-plus"})})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){s(i)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Gn=function(e){var t,n,a=e.updata,i=e.index,r=e.data,s=e.deleteEl,l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useContext)(Ue).groups,v=Object(c.useContext)(Pe),O=v.deviceBlock,f=v.typeValue,h=Object(c.useState)({}),x=Object(j.a)(h,2),p=x[0],g=x[1],y=Object(c.useCallback)((function(e){return m.filter((function(t){return t.systemName===e}))[0]}),[m]),N=function(e,t){var n;return null===e||void 0===e||null===(n=e.fields)||void 0===n?void 0:n.filter((function(e){return e.name===t}))[0]},A=function(e){return e.split(" ").join("").split(",")};Object(c.useEffect)((function(){b(y(r.systemName)),g(N(y(r.systemName),r.action))}),[y,r]);var k=function(e){var t=r,n=t.value;"device"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{action:e.action})),"text"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"number"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"enum"===r.value.type&&(n=Object(R.a)(Object(R.a)({},n),{},{value:e.action})),"math"===r.value.type&&(n=e),t.value=n,a(Object(R.a)(Object(R.a)({},t),{},{index:i}))},C=function(){var e=Object(R.a)(Object(R.a)({},r),{},{value:null});a(Object(R.a)(Object(R.a)({},e),{},{index:i}))};return 0===(null===Object||void 0===Object||null===(t=Object.keys(d||""))||void 0===t?void 0:t.length)||0===(null===Object||void 0===Object||null===(n=Object.keys(p||""))||void 0===n?void 0:n.length)?null:Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:d?d.name:"Name"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("select",{value:p.name,onChange:function(e){var t=Object(R.a)(Object(R.a)({},r),{},Object(V.a)({},e.target.name,e.target.value));"action"===e.target.name&&g(N(y(r.systemName),t.action)),a(Object(R.a)(Object(R.a)({},t),{},{index:i}))},name:"action",children:d.fields.map((function(e,t){return Object(o.jsx)("option",{value:e.name,children:e.name},t)}))})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:"=="}),Object(o.jsx)("div",{className:"programm-function-block-conteiner-item",children:r.value?"device"===r.value.type?Object(o.jsx)(qn,{data:r.value,type:p.type,updata:k,deleteEl:C}):"text"===r.value.type?Object(o.jsx)(Ln,{data:r.value,updata:k,deleteEl:C}):"number"===r.value.type?Object(o.jsx)(In,{data:r.value,updata:k,deleteEl:C}):"math"===r.value.type?Object(o.jsx)(zn,{data:r.value,updata:k,deleteEl:C}):"enum"===r.value.type&&"enum"===p.type?Object(o.jsx)(Fn,{data:r.value,values:A(p.values),updata:k,deleteEl:C}):"enum"===r.value.type&&"binary"===p.type?Object(o.jsx)(Fn,{data:r.value,values:["high","low"],updata:k,deleteEl:C}):null:Object(o.jsx)("div",{className:"programm-function-block-content-item add",onClick:function(){f("addValue",{type:p.type},(function(e){var t=r;"DeviceValue"===e&&O((function(e){t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"device",systemName:e.systemName,action:e.fields[0].name}}),a(t,i)}),"if",p.type),"Text"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"text",value:""}})),"Number"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"number",value:0}})),"Math"===e&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"math",value1:null,value2:null,action:"+"}})),"Enum"===e&&"binary"===p.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:"low"}})),"Enum"===e&&"enum"===p.type&&(t=Object(R.a)(Object(R.a)({},t),{},{value:{type:"enum",value:A(p.values)[0]}})),a(Object(R.a)(Object(R.a)({},t),{},{index:i}))}))},children:Object(o.jsx)("i",{className:"fas fa-plus"})})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){s(i)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Rn=function(e){e.updata;var t=e.index,n=e.data,c=e.deleteEl;return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsxs)("div",{className:"programm-function-block-content-item programm-function-block-name",children:["script: ",n.systemName]}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){c(t)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Hn=function(e){var t=e.deviceId,n=e.action,a=e.updata,i=e.index,r=(e.el,e.block),s=e.deleteEl,l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useContext)(Me).devices,v=Object(c.useState)(null!==n&&void 0!==n?n:"all"),O=Object(j.a)(v,2),f=O[0],h=O[1],x=Object(c.useState)([]),g=Object(j.a)(x,2),y=g[0],N=g[1],A=Object(c.useCallback)((function(e){var t=m.filter((function(t){return t.systemName===e})),n=[];if(t=t[0]){var c,a=Object(p.a)(t.fields);try{for(a.s();!(c=a.n()).done;){var i=c.value;i.name&&n.push(i.name)}}catch(r){a.e(r)}finally{a.f()}}return N(n),t}),[m]);Object(c.useEffect)((function(){b(A(t))}),[A,t]);return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:d?d.name:"Name"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsxs)("select",{value:f,onChange:function(e){h(e.target.value),a({index:i,action:e.target.value})},name:"property",children:[Object(o.jsx)("option",{value:"all",children:"all"}),y.map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))]})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){s(i,r)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Yn=function(e){e.deviceId;var t=e.action,n=e.updata,a=e.index,i=(e.el,e.block),r=e.deleteEl,s=Object(c.useState)((null===t||void 0===t?void 0:t.frequency)||"everyday"),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(c.useState)((null===t||void 0===t?void 0:t.time)||null),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)((null===t||void 0===t?void 0:t.date)||1),h=Object(j.a)(f,2),x=h[0],p=h[1],g=function(e){"frequency"===e.target.name&&(d(e.target.value),n({index:a,action:{frequency:e.target.value,time:v,date:x}})),"time"===e.target.name&&(O(e.target.value),n({index:a,action:{frequency:u,time:e.target.value,date:x}})),"date"===e.target.name&&(p(e.target.value),n({index:a,action:{frequency:u,time:v,date:e.target.value}}))};return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:"datetime"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsxs)("select",{value:u,onChange:g,name:"frequency",children:[Object(o.jsx)("option",{value:"everyday",children:"everyday"}),Object(o.jsx)("option",{value:"everyhour",children:"every hour"}),Object(o.jsx)("option",{value:"everyweek",children:"every week"}),Object(o.jsx)("option",{value:"everymonth",children:"every month"})]})}),"everyday"===u?Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"time",name:"time",value:v,onChange:g})}):"everymonth"===u?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"number",name:"date",min:1,max:31,value:x,onChange:g})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"time",name:"time",value:v,onChange:g})})]}):"everyweek"===u?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsxs)("select",{value:x,onChange:g,name:"date",children:[Object(o.jsx)("option",{value:1,children:"Monday"}),Object(o.jsx)("option",{value:2,children:"Tuesday"}),Object(o.jsx)("option",{value:3,children:"Wednesday"}),Object(o.jsx)("option",{value:4,children:"Thursday"}),Object(o.jsx)("option",{value:5,children:"Friday"}),Object(o.jsx)("option",{value:6,children:"Saturday"}),Object(o.jsx)("option",{value:7,children:"Sunday"})]})}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"time",name:"time",value:v,onChange:g})})]}):null,Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){r(a,i)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Vn=function(e){var t=e.updata,n=e.index,c=e.data,a=e.deleteEl;return Object(o.jsxs)("div",{className:"programm-function-block-root",children:[Object(o.jsx)("div",{className:"programm-function-block-content-item programm-function-block-name",children:"Delay"}),Object(o.jsx)("div",{className:"programm-function-block-content-item",children:Object(o.jsx)("input",{type:"number",onChange:function(e){var a=c,i=a.value;i=Object(R.a)(Object(R.a)({},i),{},{value:e.target.value}),a.value=i,t(Object(R.a)(Object(R.a)({},a),{},{index:n}))},value:c.value.value})}),Object(o.jsx)("div",{className:"programm-function-block-content-item delete",onClick:function(){a(n)},children:Object(o.jsx)("i",{className:"fas fa-trash"})})]})},Kn=function(e){var t=e.edit,n=Object(Re.i)().id,a=Object(c.useContext)(g).setData,i=Object(Re.g)(),r={USText:function(e){for(var t="1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;n<e.length;n++){for(var c=!1,a=0;a<t.length;a++)if(t[a]===e[n]){c=!0;break}if(!c)return!1}return!0}}.USText,s=Object(c.useContext)(E),l=Object(c.useContext)(Pe),u=l.addTarget,d=l.typeAct,b=l.deviceBlock,m=l.groupBlock,v=l.addScriptBlock,O=Y().message,f=B(),p=f.loading,y=f.request,N=f.error,A=f.clearError,k=Object(c.useState)(!0),C=Object(j.a)(k,2),w=C[0],S=C[1],D=Object(c.useState)({name:"",trigger:[],condition:{type:"group",oper:"and",children:[],systemName:null,action:null,value:null},then:[],otherwise:[]}),T=Object(j.a)(D,2),q=T[0],L=T[1],I=function(e){if(q&&q.trigger){var t=q;t.trigger=t.trigger.filter((function(t,n){return n!==e})),L(t),S((function(e){return!e}))}},F=function(e){d((function(t){setTimeout((function(){if("device"===t&&b((function(t){if(t&&t.systemName){var n=q,c=t.fields[0].name;n[e].push({type:"device",action:c,systemName:t.systemName}),L(n)}})),"group"===t&&m((function(t){if(t&&t.systemName){var n=q,c=t.fields[0].name;n[e].push({type:"group",action:c,systemName:t.systemName}),L(n)}})),"script"===t&&v((function(t){if(t&&t.name){var n=q;n[e].push({type:"script",action:"run",systemName:t.name}),L(n)}})),"delay"===t){var n=q[e].slice();n.push({type:"delay",action:"delay",value:{type:"number",value:"0"}}),L(Object(R.a)(Object(R.a)({},q),{},Object(V.a)({},e,n)))}}),100)}))},z=function(e,t){if(q&&q[e]){var n=q;n[e]=n[e].filter((function(e,n){return n!==t})),L(n),S((function(e){return!e}))}},P=function(){var e=Object(x.a)(h.a.mark((function e(){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,q.name&&r(q.name)){e.next=7;break}return console.error("allowed characters: 1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM"),document.getElementById("scriptName").style="background:red;",O("allowed characters: 1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM","error"),e.abrupt("return");case 7:if(!t){e.next=13;break}return e.next=10,y("/api/script/edit/".concat(n),"POST",Object(R.a)({},q),{Authorization:"Bearer ".concat(s.token)});case 10:c=e.sent,e.next=16;break;case 13:return e.next=15,y("/api/script/add","POST",Object(R.a)({},q),{Authorization:"Bearer ".concat(s.token)});case 15:c=e.sent;case 16:c&&i.push("/scripts"),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}(),M=function(e,t){var n=q,c=n[e].slice(),a=c[t.index];for(var i in t)"index"!==i&&(a[i]=t[i]);c[t.index]=a,n[e]=c,L(n),S((function(e){return!e}))};Object(c.useEffect)((function(){return O(N,"error"),function(){A()}}),[N,O,A]),Object(c.useEffect)((function(){w||S(!0)}),[w]);var U=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("/api/script/get/".concat(t),"Get",null,{Authorization:"Bearer ".concat(s.token)});case 2:(n=e.sent)&&((c={}).name=n.name,c.condition=n.condition,c.trigger=n.trigger,c.then=n.then,c.otherwise=n.otherwise,L(c),S((function(e){return!e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[s.token,y]);return Object(c.useEffect)((function(){n&&t&&U(n)}),[n,t,U]),Object(c.useEffect)((function(){a("New Script")}),[q,a]),Object(c.useEffect)((function(){console.log(q)}),[q]),p?Object(o.jsx)(H,{}):Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("div",{className:"NewScripConteiner",children:[Object(o.jsx)("h2",{children:"Create new script"}),Object(o.jsxs)("div",{className:"NewScripPage",children:[Object(o.jsxs)("div",{className:"scriptOut",children:[Object(o.jsx)("p",{children:"Script name"}),Object(o.jsx)("input",{type:"text",id:"scriptName",name:"name",value:q.name,onChange:function(e){L(Object(R.a)(Object(R.a)({},q),{},Object(V.a)({},e.target.name,e.target.value)))}}),Object(o.jsx)("button",{onClick:P,children:"Save"})]}),Object(o.jsxs)("div",{className:"progammzon",children:[Object(o.jsxs)("div",{className:"triggerBlock",children:[Object(o.jsxs)("div",{className:"baseBlock",children:[Object(o.jsx)("div",{className:"textBlock",children:Object(o.jsx)("p",{children:"Trigger"})}),Object(o.jsx)("div",{className:"addBlock",onClick:function(){u((function(e){if("datetime"===e.type){var t=q;return t.trigger.push({type:"datetime",action:{frequency:"everyday",time:"00:00:00"}}),void L(t)}if(e&&e.systemName){var n=q;n.trigger.push({type:"device",action:"all",systemName:e.systemName}),L(n)}}))},children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),w?q.trigger.map((function(e,t){return"datetime"===(null===e||void 0===e?void 0:e.type)?Object(o.jsx)(Yn,{index:t,action:e.action,updata:function(e){return M("trigger",e)},deleteEl:function(){return I(t)},block:"trigger",deviceId:e.systemName},t):Object(o.jsx)(Hn,{index:t,action:e.action,updata:function(e){return M("trigger",e)},deleteEl:function(){return I(t)},block:"trigger",deviceId:e.systemName},t)})):null]}),Object(o.jsx)("div",{className:"baseBlock",children:Object(o.jsx)("div",{className:"textBlock",children:Object(o.jsx)("p",{children:"if"})})}),q.condition.children&&w?Object(o.jsx)(Mn,{index:"1",type:q.condition.oper,data:q.condition,updata:function(e){var t=q;t.condition=e,L(t),S((function(e){return!e}))}}):null,Object(o.jsxs)("div",{className:"baseBlock",children:[Object(o.jsx)("div",{className:"textBlock",children:Object(o.jsx)("p",{children:"then"})}),Object(o.jsx)("div",{className:"addBlock",onClick:function(){return F("then")},children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),Object(o.jsx)("div",{className:"groupBlockConteiner",children:w?q.then.map((function(e,t){return"device"===e.type?Object(o.jsx)(Un,{deleteEl:function(){return z("then",t)},updata:function(e){return M("then",e)},data:e,index:t,block:"then"},t):"group"===e.type?Object(o.jsx)(Gn,{deleteEl:function(){return z("then",t)},updata:function(e){return M("then",e)},data:e,index:t,block:"then"},t):"script"===e.type?Object(o.jsx)(Rn,{deleteEl:function(){return z("then",t)},updata:function(e){return M("then",e)},data:e,index:t,block:"then"},t):"delay"===e.type?Object(o.jsx)(Vn,{deleteEl:function(){return z("then",t)},updata:function(e){return M("then",e)},data:e,index:t,block:"then"},t):null})):null}),Object(o.jsxs)("div",{className:"baseBlock",children:[Object(o.jsx)("div",{className:"textBlock",children:Object(o.jsx)("p",{children:"else"})}),Object(o.jsx)("div",{className:"addBlock",onClick:function(){return F("otherwise")},children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),Object(o.jsx)("div",{className:"groupBlockConteiner",children:w?q.otherwise.map((function(e,t){return"device"===e.type?Object(o.jsx)(Un,{deleteEl:function(){return z("otherwise",t)},updata:function(e){return M("otherwise",e)},data:e,index:t,block:"otherwise"},t):"group"===e.type?Object(o.jsx)(Gn,{deleteEl:function(){return z("otherwise",t)},updata:function(e){return M("otherwise",e)},data:e,index:t,block:"otherwise"},t):"script"===e.type?Object(o.jsx)(Rn,{deleteEl:function(){return z("otherwise",t)},updata:function(e){return M("otherwise",e)},data:e,index:t,block:"otherwise"},t):"delay"===e.type?Object(o.jsx)(Vn,{deleteEl:function(){return z("otherwise",t)},updata:function(e){return M("otherwise",e)},data:e,index:t,block:"otherwise"},t):null})):null})]})]})]})})},Jn=function(e){var t=e.user,n=e.updata,a=Object(c.useContext)(E),i=Object(c.useContext)(G),r=Y().message,l=B(),u=l.request,d=l.error,j=l.clearError;return Object(c.useEffect)((function(){return r(d,"error"),function(){j()}}),[d,r,j]),Object(o.jsx)("div",{className:"userElement",children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsxs)("p",{children:["Email: ",t.Email,Object(o.jsx)("br",{}),"Mobile: ",t.Mobile]}),Object(o.jsx)("img",{alt:"user icon",src:"data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAYGBgYHBgcICAcKCwoLCg8ODAwODxYQERAREBYiFRkVFRkVIh4kHhweJB42KiYmKjY+NDI0PkxERExfWl98fKcBBgYGBgcGBwgIBwoLCgsKDw4MDA4PFhAREBEQFiIVGRUVGRUiHiQeHB4kHjYqJiYqNj40MjQ+TERETF9aX3x8p//CABEIAgACAAMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABAUCAwYBCP/aAAgBAQAAAAD6pAAABhH1RtGrDx7ntkb5G7MAAAAAAA0QYOkAAbp1htAAAAAAMa+u0gAADdaTvQAAAABjWVuIAAADK0scgAAAAK6qwAAAABncTgAAABqpIwAAAAAk3uYAAAEGmxAAAAABldzAAAAqK0AAAAAAWlqAAAUcIAAAAAAE+6AAAooYAAAAAACZegABSQQAAAAAABPugACorQAAAAAAAWlqABBpAAABEh6W6ZLAAAF9LADVzuIAACHSRwSLuYAAAy6TMA8oIwAACqpvAHtzagAAJV+AV9MAAAr6AAF/YAAALucBjzeAAAGHLYAAz6nMAADPpMgVdUAAAqaYABc2wAAC2sw85nEAABzcQABL6QAABl0uQrqcAAA5PAABn1gAABdTxzmkAAA5HwAB71wAABu6M084AAAOU1gANnVgAADpdiqqwAABz0EABO6EAAAWto5zSAAAK6hAAX1iAAAN3R4cyAAAHnMxwASOm9AAADpo9CAAACNzmAAz6OSAAAC/jVIAAAEXn9QDb0EoAAAC5j1wAAADCorcBnZW+YAAACw0RgAAAB5G0t0n0AAAASdWsAAAAAAAAABsw8AAAAAAAAAAe+AAAAAAAAAAAAAAAAAAAAAPfAAAARosfTqw8e57d0iVJAAAB7nrAAAeQq+FrAAbJthN9AAAbNsYAAGNXV6gAAG20tMgAASd9eAAFfS6gAAAbbqwAACxkUwAB5R1oAAAAsrz0AAtpNAAA85+CAAAACd0HoAC+kcyAApqkAAAABbXIADps+c0gA1ct4AAAAA96naADd0arqgAVtEAAAAAL2yABaWrXzQAInOeAAAAAPejlgA6Pcc5pABT1AAAAAC3uAAbujEClAA5+AAAAACf0AAFxYjHmsQAY8/CAAAAE3oMgAZdN6FZUgAeUNeAAAAsL70AC1tAY83gAAqafwAAAe3FsAAz6TICDSAAEajigAAJV5JAALmwAKCKAAK+pjAACTbWAAAk3/oBhzeIAARK6DqAG2dYywAAy6LaAEShAAAaI2jXiy2b5O8AABdzgAKqrAAAAAAABZW4ABSwAAAAAAABOuwAAooYAAAAAACZegAAUsAAAAAAAE28AAAKqrAAAAAAFlbgAABDpMQAAAAAZXM4AAADCijAAAAACTd7QAAABBp8AAAAAZ2tiAAAABjXVeIAAADKys8gAAAAB5Bq9IAAA3WNhkAAAAAAaq+DpAAG6dO3gAAAAAAGGmPoj6sPHue3fJ2yMwAAAf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QANxAAAgECAgcGBAYCAwEAAAAAAQIDBBEABRIhMTJAQVETMFBhcZEgIlKhEENicoGxFUJTgtFw/9oACAEBAAE/AOIeaFN6RRg5lTpfRDMcPnMhvoRAepvg5nV2sGC+gwa2rO2Z/e2DLKdsje+CzdT+IZupwJZRskb3wK2rH5z/AMm+FzSsG1wfUYjzh1ADRKfQ2wuZ0zAKwZRhJoX3ZVPh0lbTRixbSPRcPmcmyNAvmdZxJUTyb0jHy2DgY6iePdkYDpyxHmkgFpEDDqNRxFX0zoFDaLH6tXhDyIgu7ADEuZAXESX8ziSeWXfcny5cPHPLFuOR5csQZqNQlT/sMJIji6MCPA3kSNbs1hibMWOqIW8zhnZzdiSeLV2Q3UkHEOZvbRmFx1wkiSLpIwI48kDE+YKt1jFz9XLEkkkjFnYk8fHJJGwZGIPUYpsyU/LKNE/VywCDxk1RHCt2OvkOeJ6qSbabL08DgqpYdQN16HEFTFKl0NjzHPiqmuWO6pYt9hhmZ2LMST4KrMjBlJBGKavWUKktlYbOh4ckAXOKqtLXSI/Lzbr4TSV5UCOU3XkemAQRccIzBVJJsBirq2mJVdSf34XR1rQMA2tP6wrBlBBuDwTMqgkmwGKqqaY2GpB9/DaSraFrE3Q/bzGFZWAINweAJABJxWVZmbRU/IPv4fRVjQNoknQO3ywCCLjv62q0iYkOrmeviNBVhCIpN07D076uqezXQU/MfsOHkrqeP/e56Lrw2a/RF7nBzOfkiYGZz80TC5r9cXscR11PJ/vY9G1cPl9UJFEbtZhz5kd5UTLDGWO3kPPDMzsWY3JPC1FbFDq3n6Ymqppt5tXQbPjhqpod1tXQ7MU9bFNq3X6cKrMjBlNiDimnSWIPz5jz7okAXxVT9tKSN0al4WsrtG8cR1826d3R12laOU6+TdeFpJ+xlBO6dTYBBF+5zCosvZqdbb3pwtfVdkugh+dh7DvaCq7VdBz86j3HC5dU3UxMda7vp3EjrGjM2wYkdpHZ22k8JJIscbOdgGJJGkdnbaT3scjRurrtBxHIskauNhHCRyNG6uu0HEciyIrLsI+PMZ7kRLsGtuFzSWwSIHbrPf5XLcPGeWscLlk4DGJth1j4pHCIznYow7F2LHaTc8LWvp1Mnkbe3f0T6FTH5m3vwqMUYMNoNxiN1dFYbCPhzKWwSIHzPDOdJ2PUnv0Oi6noRw2VT6niPqL/AAzydrM79Tq8bgl7KZH6HX8Fa4jpmPNvlHDyroyyL0Y9/EulLGvVhw9BIklMGbavyn8czkBdIxyFz6nh8wj0KljyYA9/l8enUqeSgnh8rkAkdG2EX/kfjUSdpPI/VtXD5lDpwhwNaf13+Ww6EJcjW/8AXD08nZzxv0bX+Ez6EMjdFPEEAggi4IxUwGCUry2g+Xe00BnlC8tpPlgAAAAWAHEQvpwxt1UXxmR0KcC+tmGriamnWePR5jdOHRkYqwsR3aIzsFUXJxS06wR6O1jvHicsZWpyGO62zGa6niS+wE8VU0qTr0YbDiWGSJtFxY9zFDJK2igucU1KkC9WO08Vk7ntJEvtAPtjNGvWP5ADi5I45F0XUEYmyxxcxNcdDh43Q2dSD5/CkbubIpJ8sQ5Y51ytYdBiOOONdFFAHF5Y4WrW52qRisN6qb9xHtxpAYWIBGHoqVtsYHpqwcsp+r++BllP1f3wlFSrsjB9deAAosAAONozaqh/cB74lN5ZD+o+PxG0sZ/UMNvH18fXeHr/APAW3j68QTbD1lMm2Ufxrw2ZwjdRj9sNmkh3Y1Hrrw2YVR2MB6DBrKk/mnBqJz+c/ucdtN/yP7nHbTf8j+5wKicfnP7nArKkfmnAzCqG1gfUYXNJBvRqfTVhczhO8jD74Sspn2Sj+dWAb8Qu8PXEotLIP1HhSQASSAMS5hTpcAlz5YkzKdtwBB7nDySOfncnv0kkQ/I5GI8ynXfAcexxFmFO9gSUPngEEXBBHCxC8sY/UMVgtVTfuJ9+Dd1RSWYAdTifMwLiJb/qOJZpZTd3J4WKaWI3RyMQZmDYSrb9Qwjq6gqwI6jg6MXqof3A+2MzQLVtYbVB4Kpr44rqlmb7DEs0krXdieJimkia6MRimr45bK9lb7HgsrW9YnkCcZwh7SN7bQR7cASFBJIAGKqvaS6RkhevM8bS17R2SQkr15jAIYAggg8BlWp5XtsAGMzVWpwVG623vyQASdgxWVZmbRXUg+/H0dWYW0W1oftgEEAjYe/y0aFOTbWzHXiZNOGReqm3f5jU3PYqf3eA5dU2PYsf29/CmhDGvRR+FRH2c8idG1d7NIIonfoMEliSdpPgIJUgjaDiGQSxI/Ud7Tx9pPGnVtf45pGBIjrsIt/I73M2tAq9W8DyxrwMvRu9yyMF3kPIWHqfxr40kpiq7V+Yd7WU/bRWG8useB0dP2MVjvNrPe0SCOmUc2+Y/BPF2Uzp0OrvcwpdsyD93/vgOX0uyZx+3/3vYI+1mROp1/DmsGpJR6G3ekAgg4raQwtpLuH7cfRUhmbSbcH3wAAAB3uWxWDykeQ+GRFdGU7CMOpRip2g2PesqspVhcEaxirpGga4uUOw9ONpKRp2ubhBtPXCqqqFUWAGod6il2CjaTYYjQIioNij4szgAYSrsOo98yqwKsAQdoxV0TRXdLlP64ukomls73Cf3hVVQFUAAbB32XQXJlbYNS/HJGsiMrbCMSRtG7I20Hv6rL73eH+VwQQSCCDw4BJAAJOKXL7Web+F7+NGkdUXaTiNFjRVXYO4zGmuolUa13vTgKilinGsWbkwxPSSwbRdfqHCwUks+wWX6jinpYoBqF25seAy+nsvaMNbbvp3JAItirg7GUgbp1rwM+XxPcp8h+2JqWaHeXV1GzgYaWabdXV1OzEGXxJYv85+3A0sHbSgHdGtsAAC3dVMCSxFOfI+eGVkYqwsQeCloqeS50dE9V1YkyyVdxg32OHhmj30I7tIZpNxCcR5ZK2+wX7nEVFTx2OjpHq2vglVnYKouScU8KwxhRt5nz7zMKUSKZEWzDlzI4V6aB96JcNltOdmkvocNlQ5S+4wcrl5SLj/ABc/1J7nH+Ln+pPc4GVy85FwuVDnL7DC5bTjbpN6nCU0CbsS8LQ03ZrpsPmP2HfV9Jokyxj5f9h08RoaXSIlcauQ69+QCCDito2gbSAOgdnl4fSUhmbSYfIPvgAAWHAMqsCCLg4q6RoWuBdD9vI+G0tK0xudSD74VVUAAWA4JlDKQRcHFbRNAxK60/rwukpGmIZtSf3hVCqABYDhCARY4q6AqDJELrzHTwmloi1nlHy8l64AAFhw9TQLKGeKysNvQ4ZWRirAgjwVVZ2CqCTimoVjsz2LfYcVPTRSpZxY8jzxPSyw6yLr18DgpZJtgsvXENPHCtlGvmefGEA4qctU/NEdE/TyxJHJGxV1IPQ8fHHJIwVFJOIMvVbNIbn6eWAAOPeNJF0XUEYmyx7aUJuOmGRkNmBB4tUZzZQScQ5cx1ym3kMJGka2VbDwN40cWdQRifKhrMT/APU4kgli30I8+XDxwSy7iE+fLEWWgWMr38hhI0QWRQB4RLQUzoWK6LH6dWJMrkAvG4YdDqOJKeePejYDry4GOnnk3Y2PnsGEyyTbI4XyGs4joqaMXC6R6t4c8ML70SnDZZTMCyllGJMndQSsqn1FsNldYNiA+hwaKrH5L/wL4MUo2xt7YKt0P4hW6HAilOyNvbAoqs7IX9rYGWVdrlQvqcJk0htpygegvgZbTpbSLMcJDCm7Go4n/8QAFBEBAAAAAAAAAAAAAAAAAAAAoP/aAAgBAgEBPwAAH//EABQRAQAAAAAAAAAAAAAAAAAAAKD/2gAIAQMBAT8AAB//2Q==",className:"userImg"}),Object(o.jsxs)("h3",{children:[t.UserName," ",t.UserSurname]}),Object(o.jsxs)("div",{className:"control",children:[3===a.userLevel&&a.userId!==t.UserId?Object(o.jsx)("button",{className:"editBtn",onClick:function(){i.show("EditUserLevel",n,t)},children:"Edit"}):null,a.userId===t.UserId?Object(o.jsx)(s.b,{className:"editBtn",to:"/profile/edit",children:"Edit"}):3===a.userLevel?Object(o.jsx)("button",{className:"deletBtn",onClick:function(){r("Delete user?","dialog",Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u("/api/user/delete","POST",{UserId:t.UserId},{Authorization:"Bearer ".concat(a.token)});case 2:n();case 3:case"end":return e.stop()}}),e)}))),"no")},children:"delete"}):null]})]})})},Wn=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)([]),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useContext)(g).setData,d=Object(c.useContext)(E),b=Y().message,m=Object(Re.g)(),v=B(),O=v.loading,f=v.request,p=v.error,y=v.clearError;Object(c.useEffect)((function(){return b(p,"error"),function(){y()}}),[p,b,y]);var N=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/api/user/all","GET",null,{Authorization:"Bearer ".concat(d.token)});case 2:t=e.sent,a(t),l(t);case 5:case"end":return e.stop()}}),e)}))),[f,d.token]),A=Object(c.useCallback)((function(e){if(""!==e){var t=s.filter((function(t){return-1!==t.UserName.toLowerCase().indexOf(e.toLowerCase())||-1!==t.UserSurname.toLowerCase().indexOf(e.toLowerCase())}));a(t)}else a(s)}),[s]);return Object(c.useEffect)((function(){u("Users",{specialAction:d.userLevel>=3?{type:"add",action:function(){return m.push("/user/add")}}:null,search:A})}),[u,m,A,d.userLevel]),Object(c.useEffect)((function(){N()}),[N]),O?Object(o.jsx)(H,{}):Object(o.jsx)(o.Fragment,{children:Object(o.jsx)("div",{className:"conteiner top",children:Object(o.jsx)("div",{className:"Users",children:Object(o.jsx)("div",{className:"usersList",children:n&&n[0]?n.map((function(e,t){return Object(o.jsx)(Jn,{user:e,updata:N},t)})):null})})})})},_n=function(e){var t=e.update,n=Object(c.useContext)(E),a=Y().message,i=B(),r=i.request,s=i.error,l=i.clearError,u=Object(c.useRef)(null),d=Object(c.useRef)(null),b=Object(c.useState)([]),m=Object(j.a)(b,2),v=m[0],O=m[1],f=function(e){if(!e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]};function g(){return(g=Object(x.a)(h.a.mark((function e(t){var n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.from(t.target.files),O(n),(c=d.current).innerHTML="",n.forEach((function(e){if(e.type.match("image")){var t=new FileReader;t.onload=function(t){c.insertAdjacentHTML("afterbegin",'\n        <div class="image-preview">\n          <img src="'.concat(t.target.result,'" alt="').concat(e.name,'"/>\n          <div class="preview-remove" data-name="').concat(e.name,'">&times</div>\n          <div class="preview-info"><span>').concat(e.name,"</span><span>").concat(f(e.size),"</span></div>\n        </div>\n        "))},t.readAsDataURL(e)}}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=function(){var e=Object(x.a)(h.a.mark((function e(){var c,a,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Object(p.a)(v),e.prev=1,c.s();case 3:if((a=c.n()).done){e.next=14;break}return i=a.value,(s=new FormData).append("file",i),s.append("name",i.name),e.next=10,r("/api/file/background/load","POST",s,{Authorization:"Bearer ".concat(n.token)},!0);case 10:"ok"===e.sent&&function(){var e=d.current.querySelector('[data-name="'.concat(i.name,'"]')).closest(".image-preview");e.classList.add("removeing"),setTimeout((function(){e.remove()}),300)}();case 12:e.next=3;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),c.e(e.t0);case 19:return e.prev=19,c.f(),e.finish(19);case 22:O([]),"function"===typeof t&&setTimeout((function(){t()}),200);case 24:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return a(s,"error"),function(){l()}}),[s,a,l]),Object(o.jsxs)("div",{className:"cartImageInput",children:[Object(o.jsx)("h2",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),Object(o.jsx)("input",{ref:u,multiple:!0,type:"file",id:"fileElem",accept:"image/*",onChange:function(e){return g.apply(this,arguments)}}),Object(o.jsx)("div",{ref:d,className:"fileList",onClick:function(e){if(e.target.dataset.name){var t=e.target.dataset.name,n=v.filter((function(e){return e.name!==t}));O(n);var c=d.current.querySelector('[data-name="'.concat(t,'"]')).closest(".image-preview");c.classList.add("removeing"),setTimeout((function(){c.remove()}),300)}}}),Object(o.jsxs)("div",{className:"btnConteiner",children:[v&&v[0]?Object(o.jsx)("button",{className:"highSelection button",onClick:y,children:"\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"}):null,Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:function(){return u.current.click()},children:"\u043e\u0442\u043a\u0440\u044b\u0442\u044c"})]})]})},Qn=function(e){var t=e.data,n=e.hide,a=Object(c.useState)("base"),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Y().message,u=B(),d=u.request,b=u.error,m=u.clearError,v=Object(c.useContext)(E),O=Object(c.useContext)(an).updateConfig,f=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("/api/file/background/linc?name=".concat(t.title,"&type=").concat(r),"GET",null,{Authorization:"Bearer ".concat(v.token)});case 2:O(),n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return l(b,"error"),function(){m()}}),[b,l,m]),Object(o.jsx)(ee,{onClick:n,className:"ditailImage-body",children:Object(o.jsxs)("div",{className:"ditailImage-box",children:[Object(o.jsx)("div",{className:"ditailImage-image",children:Object(o.jsx)("img",{src:t.image,alt:t.title})}),Object(o.jsxs)("div",{className:"ditailImage-control",children:[Object(o.jsxs)("p",{children:["Name: ",t.title]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"input-data",children:Object(o.jsxs)("select",{value:r,onChange:function(e){s(e.target.value)},children:[Object(o.jsx)("option",{value:"base",children:"Base"}),Object(o.jsx)("option",{value:"sunrise",children:"Sunrise"}),Object(o.jsx)("option",{value:"day",children:"Day"}),Object(o.jsx)("option",{value:"twilight",children:"Twilight"}),Object(o.jsx)("option",{value:"night",children:"Night"})]})}),Object(o.jsx)("button",{className:"button normalSelection",onClick:f,children:"C\u0434\u0435\u043b\u0430\u0442\u044c \u0444\u043e\u043d\u043e\u043c"})]})]})})},Xn=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(g).setData,n=Object(c.useContext)(l),a=n.show,i=n.hide,r=Y().message,s=B(),u=s.request,d=s.error,b=s.clearError,m=Object(c.useState)(!1),v=Object(j.a)(m,2),O=v[0],f=v[1],y=Object(c.useState)(!1),N=Object(j.a)(y,2),A=N[0],k=N[1],C=Object(c.useState)([]),w=Object(j.a)(C,2),S=w[0],D=w[1],T=Object(c.useState)(0),q=Object(j.a)(T,2),L=q[0],I=q[1],F=Object(c.useState)({}),z=Object(j.a)(F,2),P=z[0],M=z[1],U=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n,c,a,i,r,s,l=arguments;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>0&&void 0!==l[0]?l[0]:0,t.prev=1,t.next=4,u("/api/file/background/get?index=".concat(n,"&count=10"),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 4:if(c=t.sent){10!==c.length&&k(!0),I(n+30),a=S.slice(),L>n&&(a=[]),i=Object(p.a)(c);try{for(i.s();!(r=i.n()).done;)s=r.value,a.push(s)}catch(o){i.e(o)}finally{i.f()}D(a)}t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),[e.token,L,S,u]);return Object(c.useEffect)((function(){0===L&&U()}),[U,L]),Object(c.useEffect)((function(){return r(d,"error"),function(){b()}}),[d,r,b]),Object(c.useEffect)((function(){t("Gallery")}),[t]),Object(o.jsxs)("div",{className:"conteiner top bottom",children:[O?Object(o.jsx)(Qn,{data:P,hide:function(){return f(!1)}}):null,Object(o.jsxs)("div",{className:"",children:[Object(o.jsx)(_n,{update:U}),Object(o.jsxs)("div",{className:"galeryContent",children:[S&&S[0]?S.map((function(t,n){return Object(o.jsxs)("div",{className:"imageBx",onClick:function(e){return function(e,t){"rootimg"===e.target.dataset.type&&(M(t),f(!0))}(e,t)},children:[Object(o.jsx)("img",{src:t.image,alt:t.title,"data-type":"rootimg"}),Object(o.jsx)("div",{className:"preview-remove",onClick:function(){return n=t.title,void a("\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435?","general",(function(){u("/api/file/background/delete/".concat(n),"GET",null,{Authorization:"Bearer ".concat(e.token)});var t=S.slice();t=t.filter((function(e){return e.title!==n})),D(t)}),i);var n},children:Object(o.jsx)("i",{className:"fas fa-times"})}),Object(o.jsx)("div",{className:"preview-info",children:Object(o.jsx)("span",{children:t.title})})]},n)})):null,A?null:Object(o.jsx)("button",{className:"btn2",onClick:function(){return U(L)},children:"\u0435\u0449\u0451"})]})]})]})},Zn=Object(c.createContext)(),$n=n.p+"static/media/socket.159fbd8e.png",ec=n.p+"static/media/sensor.937a0c45.png",tc=n.p+"static/media/lamp.0636a2da.png",nc={lamp:tc,light:tc,switch:n.p+"static/media/switch.65d758d2.png",relay:n.p+"static/media/relay.80691df2.jpg",socket:$n,sensor:ec};function cc(e){for(var t in nc)if(-1!==e.indexOf(t))return nc[t]}var ac=function(e){var t=e.form,n=e.setForm,a=e.next,i=Object(c.useContext)(Zn).type;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("ul",{className:"leftlist"}),Object(o.jsx)("div",{className:"devicesTypeListConteiner",children:null===i||void 0===i?void 0:i.map((function(e,c){var i;return Object(o.jsxs)("div",{className:"typeDevice",children:[Object(o.jsx)("div",{className:"configTitle",children:Object(o.jsx)("p",{children:e.title})}),Object(o.jsx)("div",{className:"typeDeviceConteiner",children:null===(i=e.typs)||void 0===i?void 0:i.map((function(c,i){return Object(o.jsxs)("div",{className:"card",onClick:function(){return i=c,r=e.title,n(Object(R.a)(Object(R.a)({},t),{},{type:i,typeConnect:r})),void a();var i,r},children:[Object(o.jsx)("div",{className:"imgConteiner",children:Object(o.jsx)("img",{src:e.img||cc(c),alt:c})}),Object(o.jsx)("p",{children:"".concat(c," (").concat(e.title,")")})]},i)}))}),Object(o.jsx)("div",{className:"dividers"})]},c)}))})]})},ic=function(e){var t=e.form,n=e.setForm,a=e.next,i=e.backPage,r=e.begining,s=void 0===r?[]:r,l=Y().message,u=Object(c.useState)(s),d=Object(j.a)(u,2),b=d[0],m=d[1],v=function(e,c){n(Object(R.a)(Object(R.a)({},t),{},Object(V.a)({},e,c)))},O=function(e){var t=e.target.dataset.id,n=b.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.value));n[t]=c,m(n)},f=function(e,t){var n=t,c=b.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,m(c)},h=function(e){var t=e.target.dataset.id,n=b.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.checked));n[t]=c,m(n)};return Object(o.jsxs)("div",{className:"allFon",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return v(e.target.name,e.target.value)},required:!0,name:"address",type:"text",value:t.address}),Object(o.jsx)("label",{children:"Address"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{className:"textInput",name:"valueType",value:t.valueType,onChange:function(e){return v(e.target.name,e.target.value)},children:[Object(o.jsx)("option",{value:"json",children:"json"}),Object(o.jsx)("option",{value:"value",children:"value"})]}),Object(o.jsx)("label",{children:"Type value"})]})}),Object(o.jsxs)("div",{className:"fieldsConteiner",children:[null===b||void 0===b?void 0:b.map((function(e,t){return Object(o.jsxs)("div",{className:"fieldConteiner",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,onChange:O,required:!0,name:"name",type:"text",value:e.name}),Object(o.jsx)("label",{children:"name field"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,onChange:O,required:!0,name:"address",type:"text",value:e.address}),Object(o.jsx)("label",{children:"address field"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{className:"textInput","data-id":t,name:"type",value:e.type,onChange:O,children:[Object(o.jsx)("option",{value:"binary",children:"binary"}),Object(o.jsx)("option",{value:"text",children:"text"}),Object(o.jsx)("option",{value:"number",children:"number"}),Object(o.jsx)("option",{value:"enum",children:"enum"})]}),Object(o.jsx)("label",{children:"type"})]})}),Object(o.jsx)("div",{className:"configElement",style:{justifyContent:"center"},children:Object(o.jsxs)("div",{className:"checkbox-btn",children:[Object(o.jsx)("input",{"data-id":t,type:"checkbox",placeholder:"unit",name:"control",checked:Boolean(e.control),onChange:h,required:!0}),Object(o.jsx)("div",{children:Object(o.jsx)("span",{className:"slide"})})]})}),"number"===e.type||"binary"===e.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"number"===e.type?"number":"text",name:"low",value:e.low,onChange:O,required:!0}),Object(o.jsx)("label",{children:"min"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"number"===e.type?"number":"text",name:"high",value:e.high,onChange:O,required:!0}),Object(o.jsx)("label",{children:"max"})]})})]}):"enum"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"values",value:e.values,onChange:O,required:!0}),Object(o.jsx)("label",{children:"enum"})]})}):null,Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:f}),"number"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,name:"unit",value:e.unit,onChange:O,required:!0}),Object(o.jsx)("label",{children:"unit"})]})}):null,Object(o.jsx)("div",{className:"buttons",children:Object(o.jsx)("button",{className:"normalSelection button",onClick:function(){return function(e){m(b.filter((function(t,n){return n!==e})))}(t)},children:"delete field"})})]},t)})),Object(o.jsxs)("div",{className:"buttons",children:[Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:function(){var e=b.slice();e.push({address:"",name:"",type:"text",low:"0",high:"100",values:"",control:!0,icon:"fas fa-circle-notch",unit:""}),m(e)},children:"add field"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:i,children:"Back"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:function(){v("fields",b),function(){var e=[];if(!t.address)return l("\u043d\u0435\u0442 \u0430\u0434\u0440\u0435\u0441\u0430","error"),!1;if(!b[0])return l("\u043d\u0435\u0442 \u043f\u043e\u043b\u0435\u0439","error"),!1;var n,c=Object(p.a)(b);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(!a.address||!a.name)return l("\u043d\u0435\u043a\u043e\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u043f\u043e\u043b\u0435","error"),!1;var i,r=Object(p.a)(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(a.name===s)return l("\u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u043b\u044f","error"),!1}}catch(o){r.e(o)}finally{r.f()}e.push(a.name)}}catch(o){c.e(o)}finally{c.f()}return!0}()&&a()},children:"Next"})]})]})]})},rc=function(e){var t=e.form,n=e.setForm,c=e.next,a=e.backPage,i=Y().message;return Object(o.jsxs)("div",{className:"allFon",children:[Object(o.jsxs)("div",{className:"infoElement",children:[Object(o.jsx)("p",{children:"1. \u0427\u0435\u0440\u0435\u0437 \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e LAN."}),Object(o.jsx)("p",{children:"2. \u0412\u0432\u0435\u0434\u0438\u0442\u0435 ip \u0430\u0434\u0440\u0435\u0441\u0441 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 (\u0435\u0433\u043e \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432 \u0442\u043e\u043c \u0436\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438)."})]}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return c=e.target.name,a=e.target.value,void n(Object(R.a)(Object(R.a)({},t),{},Object(V.a)({},c,a)));var c,a},required:!0,name:"address",type:"text",value:t.address}),Object(o.jsx)("label",{children:"Address"})]})}),Object(o.jsxs)("div",{className:"buttons",children:[Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:a,children:"Back"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:function(){if(!t.address)return i("\u043d\u0435\u0442 \u0430\u0434\u0440\u0435\u0441\u0430","error"),!1;c()},children:"Next"})]})]})},sc={voltage:{low:0,high:1e7},battery:{low:0,high:100},linkquality:{low:0,high:255}},lc=function(e){var t=e.form,n=e.setForm,a=e.next,i=e.backPage,r=Y().message,s=Object(c.useContext)(Me),l=Object(c.useContext)(E),u=B(),d=u.request,b=u.error,m=u.clearError,v=Object(c.useState)([]),O=Object(j.a)(v,2),f=O[0],g=O[1],y=function(e){var t,n=[],c=Object(p.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;if(a.features){var i,r=Object(p.a)(a.features);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.name=s.endpoint,s.control=!0,n.push(s)}}catch(l){r.e(l)}finally{r.f()}}else n.push(a)}}catch(l){c.e(l)}finally{c.f()}return n},N=function(e){var t,n=[],c=!0,a=Object(p.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;c=!0,i.endpoint&&i.endpoint!==i.name&&(i.name=i.name+"_"+i.endpoint);var r,s=Object(p.a)(n);try{for(s.s();!(r=s.n()).done;){var l=r.value;i.name===l&&(c=!1)}}catch(o){s.e(o)}finally{s.f()}c||(i.name=i.name+"_"+n.indexOf(i.name)),n.push(i.name)}}catch(o){a.e(o)}finally{a.f()}return e},A=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,c=Object(p.a)(t);try{for(c.s();!(e=c.n()).done;){var a=e.value;if(a)return a;if(0===a)return 0;if(!1===a)return!1}}catch(i){c.e(i)}finally{c.f()}return n},k=function(){var e=Object(x.a)(h.a.mark((function e(c){var i,r,s,l,o,u,d,j,b;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],r=Object(p.a)(N(y(c.exposes)));try{for(r.s();!(s=r.n()).done;)u=s.value,d=u.type,"numeric"===u.type&&(d="number"),j="",u.values&&(j=u.values.join(", ")),b={name:u.name,address:u.property,low:(null===(l=sc[u.name])||void 0===l?void 0:l.low)||A([u.value_min,u.value_off],0),high:(null===(o=sc[u.name])||void 0===o?void 0:o.high)||A([u.value_max,u.value_on],1e5),icon:"fas fa-circle-notch",type:d,unit:u.unit,values:j,control:u.endpoint||!1},i.push(b)}catch(m){r.e(m)}finally{r.f()}return e.next=5,n(Object(R.a)(Object(R.a)({},t),{},{address:c.root_address.topic+"/"+c.name,fields:i,valueType:"json"}));case 5:a();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){"newZigbeesDevice"===s.message.type&&g((function(e){var t=!0,n=e.map((function(e){return s.message.data.friendly_name===e.friendly_name?(t=!1,s.message.data):e}));return t&&n.push(s.message.data),n}))}),[s.message]),Object(c.useEffect)((function(){return r(b,"error"),function(){m()}}),[b,r,m]),Object(c.useEffect)((function(){return d("/api/module/zigbee2mqtt/permit_join/set","POST",{state:!0},{Authorization:"Bearer ".concat(l.token)}),function(){d("/api/module/zigbee2mqtt/permit_join/set","POST",{state:!1},{Authorization:"Bearer ".concat(l.token)})}}),[d,l.token]),Object(o.jsxs)("div",{className:"allFon",children:[Object(o.jsx)("div",{className:"infoElement",children:Object(o.jsx)("p",{children:"\u0417\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \u0441\u043e\u043f\u0440\u044f\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u043d\u0430 5\u0441\u0435\u043a."})}),Object(o.jsx)("div",{className:"zigbeeDeviceConteiner",children:f.map((function(e,t){return Object(o.jsxs)("div",{className:"zigbeeDevice",onClick:e.exposes?function(){return k(e)}:function(){},children:[Object(o.jsxs)("div",{className:"name",children:["name: ",e.name]}),Object(o.jsx)("div",{className:"dividers"}),e.exposes?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("div",{className:"model",children:["model: ",e.model]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"description",children:e.description})]}):Object(o.jsx)("div",{className:"devLoader",children:Object(o.jsx)(H,{style:{position:"absolute"}})})]},t)}))}),Object(o.jsx)("div",{className:"buttons",children:Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:i,children:"Back"})})]})},oc=function(e){var t=e.form,n=e.setForm,a=e.next,i=e.backPage,r=e.begining,s=void 0===r?[]:r,l=Y().message,u=Object(c.useState)(s),d=Object(j.a)(u,2),b=d[0],m=d[1],v=function(e){var t=e.target.dataset.id,n=b.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.value));n[t]=c,m(n)},O=function(e,t){var n=t,c=b.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,m(c)};return Object(o.jsx)("div",{className:"allFon",children:Object(o.jsxs)("div",{className:"fieldsConteiner",children:[null===b||void 0===b?void 0:b.map((function(e,t){return Object(o.jsxs)("div",{className:"fieldConteiner",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,onChange:v,required:!0,name:"name",type:"text",value:e.name}),Object(o.jsx)("label",{children:"name field"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsxs)("select",{className:"textInput","data-id":t,name:"type",value:e.type,onChange:v,children:[Object(o.jsx)("option",{value:"binary",children:"binary"}),Object(o.jsx)("option",{value:"text",children:"text"}),Object(o.jsx)("option",{value:"number",children:"number"}),Object(o.jsx)("option",{value:"enum",children:"enum"})]}),Object(o.jsx)("label",{children:"type"})]})}),"number"===e.type||"binary"===e.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"number"===e.type?"number":"text",name:"low",value:e.low,onChange:v,required:!0}),Object(o.jsx)("label",{children:"min"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"number"===e.type?"number":"text",name:"high",value:e.high,onChange:v,required:!0}),Object(o.jsx)("label",{children:"max"})]})})]}):"enum"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"values",value:e.values,onChange:v,required:!0}),Object(o.jsx)("label",{children:"enum"})]})}):null,Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:O}),"number"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,name:"unit",value:e.unit,onChange:v,required:!0}),Object(o.jsx)("label",{children:"unit"})]})}):null,Object(o.jsx)("div",{className:"buttons",children:Object(o.jsx)("button",{className:"normalSelection button",onClick:function(){return function(e){m(b.filter((function(t,n){return n!==e})))}(t)},children:"delete field"})})]},t)})),Object(o.jsxs)("div",{className:"buttons",children:[Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:function(){var e=b.slice();e.push({address:"",name:"",type:"text",low:"0",high:"100",values:"",control:!0,icon:"fas fa-circle-notch",unit:""}),m(e)},children:"add field"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:i,children:"Back"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:function(){var e,c;e="fields",c=b,n(Object(R.a)(Object(R.a)({},t),{},Object(V.a)({},e,c))),function(){var e=[];if(!b[0])return l("\u043d\u0435\u0442 \u043f\u043e\u043b\u0435\u0439","error"),!1;var t,n=Object(p.a)(b);try{for(n.s();!(t=n.n()).done;){var c=t.value;if(!c.name)return l("\u043d\u0435\u043a\u043e\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u043f\u043e\u043b\u0435","error"),!1;var a,i=Object(p.a)(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;if(c.name===r)return l("\u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u043f\u043e\u043b\u044f","error"),!1}}catch(s){i.e(s)}finally{i.f()}e.push(c.name)}}catch(s){n.e(s)}finally{n.f()}return!0}()&&a()},children:"Next"})]})]})})},uc=function(e){var t=e.form,n=e.setForm,c=e.next,a=e.backPage,i={USText:function(e){for(var t="1234567890_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;n<e.length;n++){for(var c=!1,a=0;a<t.length;a++)if(t[a]===e[n]){c=!0;break}if(!c)return!1}return!0}}.USText,r=Y().message,s=function(e,c){n(Object(R.a)(Object(R.a)({},t),{},Object(V.a)({},e,c)))};return Object(o.jsxs)("div",{className:"allFon",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return s(e.target.name,e.target.value)},required:!0,name:"name",type:"text",value:t.name}),Object(o.jsx)("label",{children:"Name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return s(e.target.name,e.target.value)},required:!0,name:"systemName",type:"text",value:t.systemName}),Object(o.jsx)("label",{children:"System name"})]})}),Object(o.jsxs)("div",{className:"buttons",children:[Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"normalSelection button",onClick:a,children:"Back"}),Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:function(){t.name&&i(t.systemName)?c():r("\u043d\u0435\u043a\u043e\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","error")},children:"Next"})]})]})},dc=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(g).setData,n=Object(Re.g)(),a=Y().clearMessage,i=B().request,r=Object(c.useState)(1),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useState)({typeConnect:"",type:"",valueType:"json",name:"",address:"",systemName:"",fields:[],token:""}),b=Object(j.a)(d,2),m=b[0],v=b[1];Object(c.useEffect)((function(){t("Add device")}),[t]),Object(c.useEffect)((function(){console.log(m)}),[m]);var O=function(){return u((function(e){return e+1}))},f=function(){var t=Object(x.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(),t.next=4,i("/api/device/add","POST",Object(R.a)({},m),{Authorization:"Bearer ".concat(e.token)});case 4:t.sent&&n.push("/devices"),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),p=function(){return u((function(e){return e-1}))};return Object(o.jsx)("div",{className:"fullScrinContainer bottom ".concat(1===l?"addDevice":""),children:1===l?Object(o.jsx)(ac,{form:m,setForm:v,backPage:p,next:O}):2===l&&"Mqtt_MQTTDevice"===m.typeConnect?Object(o.jsx)(ic,{form:m,setForm:v,backPage:p,next:O}):2===l&&"Yeelight_Yeelight"===m.typeConnect?Object(o.jsx)(rc,{form:m,setForm:v,backPage:p,next:O}):2===l&&"Zigbee_ZigbeeDevice"===m.typeConnect?Object(o.jsx)(lc,{form:m,setForm:v,backPage:p,next:O}):2===l&&"variable"===m.typeConnect?Object(o.jsx)(oc,{form:m,setForm:v,backPage:p,next:O}):3===l?Object(o.jsx)(uc,{form:m,setForm:v,backPage:p,next:f}):null})},jc=function(e){var t=e.type,n=void 0===t?"movie":t,a=e.edit,i=void 0!==a&&a,r="movie"===n?"Moviestorage":"Serialstorage",s=Object(Re.i)().id,l={title:"",tagline:"",discription:"",year:2019,country:"",regisers:[],actors:[],ganres:[],date:"",budget:0,fees_in_usa:0,fees_in_world:0,category:"",url:"",urlLocal:"",loaded:!1,quality:"",count_seasons:0,closed:!1,save_seasons:0},u=Object(c.useContext)(E),d=Object(Re.g)(),b={setData:Object(c.useCallback)((function(e,t){localStorage.setItem(e,JSON.stringify(t))}),[]),getData:Object(c.useCallback)((function(e){return JSON.parse(localStorage.getItem(e))}),[]),removeData:Object(c.useCallback)((function(e){localStorage.removeItem(e)}),[])},m=b.setData,v=b.removeData,O=b.getData,f=Y().message,p=B(),g=p.request,y=p.error,N=p.clearError,A=Object(c.useRef)(null),k=Object(c.useRef)(null),C=Object(c.useRef)(),w=Object(c.useState)([]),S=Object(j.a)(w,2),D=S[0],T=S[1],q=Object(c.useState)([]),L=Object(j.a)(q,2),I=L[0],F=L[1],z=Object(c.useState)([]),P=Object(j.a)(z,2),M=P[0],U=P[1],G=Object(c.useState)(l),H=Object(j.a)(G,2),K=H[0],J=H[1],W=function(){var e=Object(x.a)(h.a.mark((function e(){var t,c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=new FormData,v(r),C.current&&(c=C.current,t.append("poster",c)),K)t.append(a,K[a]);if("movie"!==n||i){e.next=7;break}return e.next=7,g("/api/files/movies/add","POST",t,{Authorization:"Bearer ".concat(u.token)},!0);case 7:if("serial"!==n||i){e.next=10;break}return e.next=10,g("/api/files/serials/add","POST",t,{Authorization:"Bearer ".concat(u.token)},!0);case 10:if("movie"!==n||!i){e.next=13;break}return e.next=13,g("/api/files/movies/edit/".concat(s),"POST",t,{Authorization:"Bearer ".concat(u.token)},!0);case 13:if("serial"!==n||!i){e.next=16;break}return e.next=16,g("/api/files/serials/edit/".concat(s),"POST",t,{Authorization:"Bearer ".concat(u.token)},!0);case 16:d.push("/files/".concat(n,"s"));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t,n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/files/actors/all","GET",null,{Authorization:"Bearer ".concat(u.token)});case 2:return t=e.sent,e.next=5,g("/api/files/ganres/all","GET",null,{Authorization:"Bearer ".concat(u.token)});case 5:return n=e.sent,e.next=8,g("/api/files/category/all","GET",null,{Authorization:"Bearer ".concat(u.token)});case 8:c=e.sent,t&&T(t.actors),n&&F(n.ganres),c&&U(c.category);case 12:case"end":return e.stop()}}),e)}))),[u.token,g]);var Q=function(e){J(Object(R.a)(Object(R.a)({},K),{},Object(V.a)({},e.target.name,function(e){for(var t,n=[],c=e&&e.options,a=0,i=c.length;a<i;a++)(t=c[a]).selected&&n.push(Number(t.value)||t.value);return n}(e.target))))},X=function(e){J(Object(R.a)(Object(R.a)({},K),{},Object(V.a)({},e.target.name,e.target.value)))},Z=function(e){J(Object(R.a)(Object(R.a)({},K),{},Object(V.a)({},e.target.name,e.target.checked)))},$=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/api/files/movie/".concat(s),"GET",null,{Authorization:"Bearer ".concat(u.token)});case 2:(t=e.sent)&&t[n]&&(c=t[n],J((function(e){return Object(R.a)(Object(R.a)({},e),{},{title:c.title,tagline:c.tagline,discription:c.discription,year:c.year,country:c.country,regisers:c.directors&&c.directors.map((function(e){return e.id})),actors:c.actors&&c.actors.map((function(e){return e.id})),ganres:c.genres&&c.genres.map((function(e){return e.id})),date:c.world_premiere,budget:c.budget,fees_in_usa:c.fees_in_usa,fees_in_world:c.fees_in_world,category:c.category.id,url:c.url,urlLocal:c.localUrl,loaded:c.loaded,quality:c.grade,count_seasons:c.count_seasons||0,closed:c.closed||!1,save_seasons:c.save_seasons||0})})),A.current.src=c.poster);case 4:case"end":return e.stop()}}),e)}))),[g,u.token,s,n]);return Object(c.useEffect)((function(){_()}),[_]),Object(c.useEffect)((function(){i&&$()}),[i,$]),Object(c.useEffect)((function(){var e=O(r);e&&J(e)}),[O,r]),Object(c.useEffect)((function(){m(r,K)}),[K,m,r]),Object(c.useEffect)((function(){f(y,"error"),N()}),[y,f,N]),Object(o.jsxs)("div",{className:"whiteBacground no-pg-top opacity newMovie",children:[Object(o.jsx)("p",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u0430"}),Object(o.jsx)("input",{value:K.title,type:"text",name:"title",onChange:X}),Object(o.jsx)("p",{children:"\u0421\u043b\u043e\u0433\u0430\u043d"}),Object(o.jsx)("input",{value:K.tagline,type:"text",name:"tagline",onChange:X}),Object(o.jsx)("p",{children:"\u0441\u0442\u0440\u0430\u043d\u0430"}),Object(o.jsx)("input",{value:K.country,type:"text",name:"country",onChange:X}),Object(o.jsx)("p",{children:"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(o.jsx)("textarea",{value:K.discription,name:"discription",id:"",cols:"30",rows:"10",onChange:X}),Object(o.jsx)("div",{className:"imageInput",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"Poster"}),Object(o.jsx)("input",{type:"file",name:"poster",id:"fileElem",accept:"image/*",onChange:function(e){var t=e.target.files;window.URL=window.URL||window.webkitURL;var n=k.current;if(C.current=e.target.files[0],t.length){var c=A.current;c.src=window.URL.createObjectURL(t[0]),c.onload=function(){window.URL.revokeObjectURL(this.src)}}else n.innerHTML="<p>No files selected!</p>"}}),Object(o.jsx)("div",{ref:k,className:"fileList",children:Object(o.jsx)("img",{ref:A,className:"inputImg",alt:"poster"})})]})}),Object(o.jsx)("p",{children:"\u0433\u043e\u0434 \u0432\u044b\u0445\u043e\u0434\u0430"}),Object(o.jsx)("input",{value:K.year,type:"number",name:"year",onChange:X}),Object(o.jsx)("p",{children:"\u0440\u0435\u0436\u0438\u0441\u0435\u0440"}),Object(o.jsxs)("div",{className:"selected-div",children:[Object(o.jsx)("select",{value:K.regisers,className:"actor-ganre-select",name:"regisers",multiple:!0,onChange:Q,children:D.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.name},t)}))}),Object(o.jsx)("button",{onClick:function(){return d.push("/actor/add")},className:"actor-ganre-add-btn",children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),Object(o.jsx)("p",{children:"\u0430\u043a\u0442\u0435\u0440\u044b"}),Object(o.jsxs)("div",{className:"selected-div",children:[Object(o.jsx)("select",{value:K.actors,className:"actor-ganre-select",name:"actors",multiple:!0,onChange:Q,children:D.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.name},t)}))}),Object(o.jsx)("button",{onClick:function(){return d.push("/actor/add")},className:"actor-ganre-add-btn",children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),Object(o.jsx)("p",{children:"\u0436\u0430\u043d\u0440"}),Object(o.jsxs)("div",{className:"selected-div multi",children:[Object(o.jsx)("select",{value:K.ganres,className:"actor-ganre-select",name:"ganres",multiple:!0,onChange:Q,children:I.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.name},t)}))}),Object(o.jsx)("button",{onClick:function(){return d.push("/ganre/add")},className:"actor-ganre-add-btn",children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),Object(o.jsx)("p",{children:"\u0434\u0430\u0442\u0430 \u0432\u044b\u0445\u043e\u0434\u0430"}),Object(o.jsx)("input",{value:K.date,onChange:X,type:"date",name:"date"}),Object(o.jsx)("p",{children:"\u0431\u044e\u0434\u0436\u0435\u0442"}),Object(o.jsx)("input",{value:K.budget,min:0,onChange:X,type:"number",name:"budget"}),Object(o.jsx)("p",{children:"\u0441\u0431\u043e\u0440\u044b \u0432 \u0421\u0428\u0410"}),Object(o.jsx)("input",{value:K.fees_in_usa,onChange:X,type:"number",name:"fees_in_usa"}),Object(o.jsx)("p",{children:"\u0441\u0431\u043e\u0440\u044b \u0432 \u043c\u0438\u0440\u0435"}),Object(o.jsx)("input",{value:K.fees_in_world,onChange:X,type:"number",name:"fees_in_world"}),Object(o.jsx)("p",{children:"\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"}),Object(o.jsxs)("div",{className:"selected-div",children:[Object(o.jsxs)("select",{value:K.category,onChange:X,name:"category",children:[Object(o.jsx)("option",{value:""}),M.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.name},t)}))]}),Object(o.jsx)("button",{onClick:function(){return d.push("/category/add")},className:"actor-ganre-add-btn",children:Object(o.jsx)("i",{className:"fas fa-plus"})})]}),"serial"===n?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("p",{children:"\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u0437\u043e\u043d\u043e\u0432"}),Object(o.jsx)("input",{value:K.count_seasons,min:0,onChange:X,type:"number",name:"count_seasons"}),Object(o.jsx)("p",{children:"\u0437\u0430\u043a\u0440\u044b\u0442"}),Object(o.jsx)("input",{value:K.closed,onChange:Z,type:"checkbox",name:"closed"}),Object(o.jsx)("p",{children:"\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u0441\u0435\u0437\u043e\u043d\u043e\u0432"}),Object(o.jsx)("input",{value:K.save_seasons,min:0,onChange:X,type:"number",name:"save_seasons"})]}):null,Object(o.jsx)("p",{children:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442"}),Object(o.jsx)("input",{value:K.url,onChange:X,type:"url",name:"url"}),Object(o.jsx)("p",{children:"\u0421\u043a\u0430\u0447\u0435\u043d\u043e"}),Object(o.jsx)("input",{value:K.loaded,onChange:Z,type:"checkbox",name:"loaded"}),K.loaded?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("p",{children:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u043a\u0430\u0447\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b"}),Object(o.jsx)("input",{value:K.urlLocal,onChange:X,type:"text",name:"urlLocal"}),Object(o.jsx)("p",{children:"\u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043a\u0430\u0447\u0435\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430"}),Object(o.jsx)("input",{value:K.quality,onChange:X,type:"text",name:"quality"})]}):null,Object(o.jsx)("button",{onClick:W,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),i?null:Object(o.jsx)("button",{onClick:function(){v(r),J(l)},children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"})]})},bc=function(){var e=Object(c.useContext)(E),t=Object(Re.g)().goBack,n=Y().message,a=B(),i=a.request,r=a.error,s=a.clearError,l=Object(c.useRef)(null),u=Object(c.useRef)(null),d=Object(c.useRef)(),b=Object(c.useState)({name:"",date_of_birth:"",discription:"",url:""}),m=Object(j.a)(b,2),v=m[0],O=m[1],f=function(){var n=Object(x.a)(h.a.mark((function n(){var c,a,r;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r in c=d.current,(a=new FormData).append("image",c),v)a.append(r,v[r]);return n.next=6,i("/api/files/actor/add","POST",a,{Authorization:"Bearer ".concat(e.token)},!0);case 6:t();case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();var p=function(e){O(Object(R.a)(Object(R.a)({},v),{},Object(V.a)({},e.target.name,e.target.value)))};return Object(c.useEffect)((function(){n(r,"error"),s()}),[r,n,s]),Object(o.jsxs)("div",{className:"whiteBacground no-pg-top opacity newMovie",children:[Object(o.jsx)("p",{children:"\u0418\u043c\u044f"}),Object(o.jsx)("input",{value:v.name,type:"text",name:"name",onChange:p}),Object(o.jsx)("p",{children:"\u0434\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f"}),Object(o.jsx)("input",{value:v.date_of_birth,type:"date",name:"date_of_birth",onChange:p}),Object(o.jsx)("p",{children:"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(o.jsx)("textarea",{value:v.discription,name:"discription",id:"",cols:"30",rows:"10",onChange:p}),Object(o.jsx)("div",{className:"imageInput",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"Image"}),Object(o.jsx)("input",{type:"file",name:"poster",id:"fileElem",accept:"image/*",onChange:function(e){var t=e.target.files;window.URL=window.URL||window.webkitURL;var n=u.current;if(d.current=e.target.files[0],t.length){var c=l.current;c.src=window.URL.createObjectURL(t[0]),c.onload=function(){window.URL.revokeObjectURL(this.src)}}else n.innerHTML="<p>No files selected!</p>"}}),Object(o.jsx)("div",{ref:u,className:"fileList",children:Object(o.jsx)("img",{ref:l,className:"inputImg",alt:"photoActors"})})]})}),Object(o.jsx)("p",{children:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442"}),Object(o.jsx)("input",{value:v.url,onChange:p,type:"url",name:"url"}),Object(o.jsx)("button",{onClick:f,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})},mc=function(e){var t=e.type,n=void 0===t?"ganre":t,a=Object(c.useContext)(E),i=Object(Re.g)().goBack,r=Y().message,s=B(),l=s.request,u=s.error,d=s.clearError,b=Object(c.useState)({name:"",discription:"",url:""}),m=Object(j.a)(b,2),v=m[0],O=m[1],f=function(){var e=Object(x.a)(h.a.mark((function e(){var t,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c in t=new FormData,v)t.append(c,v[c]);return e.next=4,l("/api/files/".concat(n,"/add"),"POST",t,{Authorization:"Bearer ".concat(a.token)},!0);case 4:i();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(e){O(Object(R.a)(Object(R.a)({},v),{},Object(V.a)({},e.target.name,e.target.value)))};return Object(c.useEffect)((function(){r(u,"error"),d()}),[u,r,d]),Object(o.jsxs)("div",{className:"whiteBacground no-pg-top opacity newMovie",children:[Object(o.jsx)("p",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),Object(o.jsx)("input",{value:v.name,type:"text",name:"name",onChange:p}),Object(o.jsx)("p",{children:"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(o.jsx)("textarea",{value:v.discription,name:"discription",id:"",cols:"30",rows:"10",onChange:p}),Object(o.jsx)("p",{children:"\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442"}),Object(o.jsx)("input",{value:v.url,onChange:p,type:"url",name:"url"}),Object(o.jsx)("button",{onClick:f,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})},vc=function(e){var t=e.search,n=e.name,a=e.children,i=Object(c.useState)(""),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useState)(!1),d=Object(j.a)(u,2),b=d[0],m=d[1];return Object(o.jsxs)("header",{children:[t?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"btn ".concat(b?"active":""),onClick:function(){return m((function(e){return!e}))},children:Object(o.jsx)("i",{className:"fas fa-search"})}),Object(o.jsxs)("div",{className:"search ".concat(b?"show":"hide"),children:[Object(o.jsx)("input",{type:"search",name:"search",onChange:function(e){l(e.target.value)},onKeyDown:function(e){13===e.keyCode&&"function"===typeof t&&t(s)},value:s}),Object(o.jsx)("button",{onClick:function(){return t(s)},className:"searchBtn",children:"Search"})]})]}):null,Object(o.jsx)("div",{className:"controls",children:a}),Object(o.jsx)("h1",{children:n})]})};function Oc(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],"-").concat(t.getDate()," ").concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())}var fc={number:"area",binary:"stepArea"};function hc(e){var t={theme:"light2",animationEnabled:!0,backgroundColor:"#333",title:{text:"".concat(e.deviceName,"-").concat(e.name)},axisY:{title:e.valueName||"Value"},axisX:{valueFormatString:"DD-MM-YY HH:mm:ss",margin:5},data:[{type:fc[e.type],xValueFormatString:"DDD HH:mm:ss",markerSize:5,dataPoints:e.data}]};return"binary"===e.type&&(t.axisY.interval=1,t.axisY.minimum=-.02,t.axisY.maximum=1.02),t}var xc,pc=function(){return Object(o.jsx)("div",{className:"NoContent",children:Object(o.jsx)("p",{children:"HistoryEmpty"})})},gc=function(e){var t=e.data;e.device;return Object(o.jsxs)("div",{className:"historyList",children:[Object(o.jsx)("div",{className:"title",children:"".concat(t.deviceName,"-").concat(t.name)}),t.data.map((function(e){return Object(o.jsxs)("div",{className:"historyItem",children:[Object(o.jsx)("div",{className:"date",children:Oc(e.x)}),Object(o.jsx)("div",{className:"value",children:e.y})]})}))]})},yc=function(e){var t,n=e.data,a=e.device,i=Object(c.useState)({}),r=Object(j.a)(i,2),s=r[0],l=r[1];function u(e){try{var t,n=[],c=Object(p.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;n.push({x:new Date(a.date),y:Number(a.value)})}}catch(i){c.e(i)}finally{c.f()}return n}catch(r){console.error(r)}}function d(e){try{var t,n=[],c=Object(p.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;n.push({x:new Date(a.date),y:a.value})}}catch(i){c.e(i)}finally{c.f()}return n}catch(r){console.error(r)}}function b(e){var t=n[a.DeviceSystemName][e.target.dataset.name],c=function(e,t){var n,c=Object(p.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(a.name===t)return a}}catch(i){c.e(i)}finally{c.f()}}(null===a||void 0===a?void 0:a.DeviceConfig,e.target.dataset.name);t&&c?!t||"binary"!==c.type&&"number"!==c.type?l({name:c.name,deviceName:null===a||void 0===a?void 0:a.DeviceName,type:c.type,data:d(t)}):l({name:c.name,deviceName:null===a||void 0===a?void 0:a.DeviceName,type:c.type,data:u(t)}):l({name:c.name,type:null})}return console.log(n),n[a.DeviceSystemName]?Object(o.jsx)("div",{className:"device-chart-card",children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsx)("div",{className:"canvasConteiner",children:"binary"===s.type||"number"===s.type?Object(o.jsx)(cn.a,{options:hc(s)}):s.type?Object(o.jsx)(gc,{data:s}):Object(o.jsx)(pc,{})}),Object(o.jsxs)("div",{className:"controlCanvasConteiner",children:[Object(o.jsx)("h2",{children:a.DeviceName}),Object(o.jsxs)("ul",{className:"ChartZoom",children:[Object(o.jsx)("li",{children:"All"}),Object(o.jsx)("li",{children:"Year"}),Object(o.jsx)("li",{children:"Mount"}),Object(o.jsx)("li",{children:"Day"})]}),null===a||void 0===a||null===(t=a.DeviceConfig)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsx)("div",{className:"field",children:Object(o.jsx)("button",{className:"".concat(s.name===e.name?"active":""),onClick:b,"data-name":e.name,children:e.name})},t)}))]})]})}):null},Nc=function(){var e=Object(c.useContext)(g).setData,t=Object(c.useContext)(Me).devices,n=Object(c.useContext)(E),a=B().request,i=Object(c.useState)(),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a("/api/charts/get","GET",null,{Authorization:"Bearer ".concat(n.token)});case 3:t=e.sent,l(t.charts),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[a,n.token]);Object(c.useEffect)((function(){e("Add user")}),[e]),Object(c.useEffect)((function(){u()}),[u]);return s?Object(o.jsxs)("div",{className:"conteiner top bottom",children:[Object(o.jsx)(vc,{search:function(e){},name:"Charts"}),Object(o.jsx)("div",{className:"Charts",children:t?t.map((function(e,t){return Object(o.jsx)(yc,{data:s,device:e},t)})):null})]}):null},Ac=function(e){var t=e.type,n=void 0===t?"movie":t,a=Object(c.useContext)(E),i=Object(Re.i)().id,r=Y().message,l=B(),u=l.request,d=l.error,b=l.clearError,m=Object(c.useState)({}),v=Object(j.a)(m,2),O=v[0],f=v[1],p=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u("/api/files/movie/".concat(i),"GET",null,{Authorization:"Bearer ".concat(a.token)});case 2:(t=e.sent)&&f(t.movie);case 4:case"end":return e.stop()}}),e)}))),[u,a.token,i]);return Object(c.useEffect)((function(){p()}),[p]),Object(c.useEffect)((function(){return r(d,"error"),function(){b()}}),[d,r,b]),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"z-0 backForm "}),Object(o.jsxs)("div",{className:"conteiner movie-ditail",children:[Object(o.jsxs)("div",{className:"base",children:[Object(o.jsx)("div",{className:"div-poster",children:Object(o.jsx)("img",{src:O.poster,alt:"poster"})}),Object(o.jsx)("div",{className:"div-vertical-separator"}),Object(o.jsxs)("div",{className:"div-movie-info",children:[Object(o.jsxs)("div",{className:"discription",children:[Object(o.jsx)("h2",{children:O.title}),Object(o.jsx)("p",{children:O.discription})]}),Object(o.jsxs)("div",{className:"control",children:[Object(o.jsx)("button",{className:"btn",children:"\u043e\u0442\u043a\u0440\u044b\u0442\u044c"}),Object(o.jsx)(s.b,{className:"btn",to:"/".concat(n,"/edit/").concat(i),children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]}),Object(o.jsxs)("div",{className:"about-the-film",children:[Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0433\u043e\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0441\u0442\u0432\u0430"}),Object(o.jsx)("div",{className:"value",children:O.year})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0441\u0442\u0440\u0430\u043d\u0430"}),Object(o.jsx)("div",{className:"value",children:O.country})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0436\u0430\u043d\u0440"}),Object(o.jsx)("div",{className:"value",children:O&&O.genres?O.genres.map((function(e,t,n){return Object(o.jsxs)("div",{className:"d-in",children:[Object(o.jsx)("a",{href:e.url&&"-"!==e.url?e.url:null,children:e.name}),n.length-1!==t?Object(o.jsx)("span",{children:", "}):null]},t)})):null})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0441\u043b\u043e\u0433\u0430\u043d"}),Object(o.jsx)("div",{className:"value",children:O.tagline})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0440\u0435\u0436\u0438\u0441\u0435\u0440\u044b"}),Object(o.jsx)("div",{className:"value flex div-slider",children:O&&O.directors?O.directors.map((function(e,t){return Object(o.jsxs)("div",{className:"director-or-actor-card",children:[Object(o.jsx)("div",{className:"photo-img",children:Object(o.jsx)("img",{src:e.image,alt:e.name})}),Object(o.jsx)("p",{children:e.name})]},t)})):null})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0431\u044e\u0442\u0436\u0435\u0442"}),Object(o.jsxs)("div",{className:"value",children:[O.budget,"$"]})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0441\u0431\u043e\u0440\u044b \u0432 \u0421\u0428\u0410"}),Object(o.jsxs)("div",{className:"value",children:[O.fees_in_usa,"$"]})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u0441\u0431\u043e\u0440\u044b \u0432 \u043c\u0438\u0440\u0435"}),Object(o.jsxs)("div",{className:"value",children:[O.fees_in_world,"$"]})]}),Object(o.jsxs)("div",{className:"paragraph",children:[Object(o.jsx)("div",{className:"name",children:"\u043f\u0440\u0435\u043c\u044c\u0435\u0440\u0430 \u0432 \u043c\u0438\u0440\u0435"}),Object(o.jsx)("div",{className:"value",children:O.world_premiere})]})]})]})]}),Object(o.jsxs)("div",{className:"actors",children:[Object(o.jsx)("h3",{children:"\u0410\u043a\u0442\u0435\u0440\u044b"}),Object(o.jsx)("div",{className:"flex div-slider",children:O&&O.actors?O.actors.map((function(e,t){return Object(o.jsxs)("div",{className:"director-or-actor-card",children:[Object(o.jsx)("div",{className:"photo-img",children:Object(o.jsx)("img",{src:e.image,alt:e.name})}),Object(o.jsx)("p",{children:e.name})]},t)})):null})]})]})]})},kc={state:"state",power:"state",dimmer:"brightness",brightness:"brightness",color:"color",temp:"temp",color_temp:"temp",mode:"mode"},Cc={base:{min:"0",max:"255",icon:"",type:"text"},state:{min:"0",max:"1",icon:"",type:"binary"},brightness:{min:"0",max:"100",icon:"",type:"range"},color:{min:"1600",max:"3600",icon:"",type:"range"},temp:{min:"0",max:"40",icon:"",type:"range"},mode:{min:"0",max:"2",icon:"",type:"number"}},wc=function(e){var t,n=e.data,a=e.onClickMessage,i=Object(c.useContext)(d).show,r=Object(c.useContext)(Zn),s=Object(c.useContext)(G),l=function(){var e;return null===r||void 0===r||null===(e=r.type)||void 0===e?void 0:e.map((function(e){return{title:e.title,data:e.title}}))};var u="value",j=n.message;try{j=JSON.parse(j),u="json"}catch(v){}if("object"===typeof j)t=function(e){var t=[];for(var n in e){var c=e[n];"object"!==typeof e[n]&&"boolean"!==typeof e[n]||(c=JSON.stringify(c)),c.length>100&&(c="..."),t.push({name:n,value:c})}return t}(j);else{"boolean"===typeof j&&(j=JSON.stringify(j));var b=n.topic.split("/").pop();t=[{name:b,value:j}]}function m(){var e=[];if(n.lincs){var t,c=Object(p.a)(n.lincs);try{for(c.s();!(t=c.n()).done;){var a=t.value,i=a.device,r=void 0;"json"!==i.valueType&&a.field&&(r=a.field.name),e.push("".concat(i.systemName).concat(r?".".concat(r):""))}}catch(s){c.e(s)}finally{c.f()}return e}return[]}return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("td",{children:n.topic}),Object(o.jsx)("td",{onClick:function(e){return a(Object(R.a)(Object(R.a)({},e),{},{typeMessage:u}))},children:t.map((function(e,t){return Object(o.jsxs)("span",{className:"mqttMessageStr",children:[e.name,": ",e.value,", "]},t)}))}),Object(o.jsx)("td",{children:m()&&m()[0]?m().map((function(e,t){return Object(o.jsx)("p",{className:"mqttMessageStr",children:e},t)})):"NuN"}),Object(o.jsx)("td",{children:Object(o.jsx)("button",{onClick:function(){i("confirmation",{title:"Types",items:l(),active:function(e){var c=n.topic.split("/");"set"===c[c.length-1]&&c.pop(),"value"===u&&c.pop();var a,i=c.join("/"),r=[],l="text",o=Object(p.a)(t);try{for(o.s();!(a=o.n()).done;){var d=a.value,j=kc[d.name];j||(j=d.name);var b=Cc[j];b||(b=Cc.base);var m={name:j,address:d.name,low:b.min,high:b.max,icon:b.icon||"",type:l=b.type||l,control:"sensor"!==e};r.push(m)}}catch(v){o.e(v)}finally{o.f()}s.show("LinkDevices",null,{typeConnect:"Mqtt_MQTTDevice",type:e,address:i,valueType:u,fields:r})}})},className:"iconbutton",title:"\u0441\u0432\u044f\u0437\u0430\u0442\u044c",children:Object(o.jsx)("i",{className:"fas fa-link"})})})]})},Ec=function(){var e,t=Object(c.useContext)(E),n=Object(c.useState)([]),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(c.useState)([]),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(c.useState)(""),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)(""),y=Object(j.a)(f,2),N=y[0],A=y[1],k=Object(c.useState)(null),C=Object(j.a)(k,2),w=C[0],S=C[1],D=B(),T=D.loading,q=D.request,L=D.error,I=D.clearError,F=Object(c.useContext)(Me),z=Y().message,P=Object(c.useContext)(g).setData,M=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q("/api/module/mqtt/get","GET",null,{Authorization:"Bearer ".concat(t.token)});case 3:(n=e.sent)&&(r(n),d(n)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[q,t.token]);function U(e){var t=[];if(e.lincs){var n,c=Object(p.a)(e.lincs);try{for(c.s();!(n=c.n()).done;){var a=n.value,i=a.device,r=void 0;"json"!==i.valueType&&a.field&&(r=a.field.name),t.push("".concat(i.systemName).concat(r?".".concat(r):""))}}catch(s){c.e(s)}finally{c.f()}return t}return[]}Object(c.useEffect)((function(){var e=u;""!==v&&(e=e.filter((function(e){return-1!==e.topic.indexOf(v)}))),""!==N&&(e=e.filter((function(e){var t,n=U(e),c=Object(p.a)(n);try{for(c.s();!(t=c.n()).done;){if(-1!==t.value.indexOf(N))return!0}}catch(a){c.e(a)}finally{c.f()}return!1}))),r(e)}),[v,u,N]),Object(c.useEffect)((function(){z(L,"error"),I()}),[L,z,I]),Object(c.useEffect)((function(){M()}),[M]),Object(c.useEffect)((function(){"mqtt"===F.message.type&&d(F.message.data)}),[F.message]);var G=Object(c.useCallback)((function(){q("/api/module/mqtt/clear","GET",null,{Authorization:"Bearer ".concat(t.token)}),M()}),[q,t.token,M]);return Object(c.useEffect)((function(){P("MQTT",{dopmenu:[{title:"clear",onClick:G},{title:"update",onClick:M}]})}),[P,M,G]),Object(o.jsxs)("div",{className:"conteiner bottom",children:[w?Object(o.jsx)(ee,{onClick:function(){return S(null)},children:Object(o.jsxs)("div",{className:"infoCard",children:[Object(o.jsx)("div",{className:"field",children:w.topic}),Object(o.jsx)("div",{className:"field",children:Object(o.jsx)("pre",{children:"json"===(null===w||void 0===w||null===(e=w.event)||void 0===e?void 0:e.typeMessage)?JSON.stringify(JSON.parse(w.item.message),void 0,4):w.item.message})}),Object(o.jsx)("div",{className:"field",children:U(w)})]})}):null,T||!i?Object(o.jsx)(H,{}):Object(o.jsx)("div",{children:Object(o.jsx)("div",{className:"mqttTableDiv",children:Object(o.jsxs)("table",{className:"mqttTable",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return O(e.target.value)},value:v,required:!0,name:"adress",type:"text"}),Object(o.jsx)("label",{children:"Adress"})]})}),Object(o.jsx)("th",{children:"Message"}),Object(o.jsx)("th",{children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:function(e){return A(e.target.value)},value:N,required:!0,name:"device",type:"text"}),Object(o.jsx)("label",{children:"Linc device"})]})}),Object(o.jsx)("th",{children:"Control"})]})}),Object(o.jsx)("tbody",{children:i.map((function(e,t){return Object(o.jsx)("tr",{children:Object(o.jsx)(wc,{data:e,onClickMessage:function(t){return S({event:t,item:e})}})},t)}))})]})})})]})},Bc=function(e){var t=e.data,n=Object(c.useContext)(E),a=B().request,i=Object(c.useContext)(G),r=Object(c.useContext)(Zn),s=Object(c.useContext)(d),l=s.show,u=s.hide,j=function(e){a("/api/module/zigbee2mqtt/device/rename","POST",{name:t.name,newName:e},{Authorization:"Bearer ".concat(n.token)})},b=function(){a("/api/module/zigbee2mqtt/device/delete/".concat(t.address),"GET",null,{Authorization:"Bearer ".concat(n.token)})},m=function(e){var t,n=[],c=Object(p.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;if(a.features){var i,r=Object(p.a)(a.features);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.name=s.endpoint,s.control=!0,n.push(s)}}catch(l){r.e(l)}finally{r.f()}}else n.push(a)}}catch(l){c.e(l)}finally{c.f()}return n},v=function(){var e;return null===r||void 0===r||null===(e=r.type)||void 0===e?void 0:e.map((function(e){return{title:e.title,data:e.title}}))},O=function(e,t){return 0===e?0:!1!==e&&(e||t)},f=function(){var e,n=[],c=Object(p.a)(function(e){var t,n=[],c=!0,a=Object(p.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;c=!0,i.endpoint&&i.endpoint!==i.name&&(i.name=i.name+"_"+i.endpoint);var r,s=Object(p.a)(n);try{for(s.s();!(r=s.n()).done;){var l=r.value;i.name===l&&(c=!1)}}catch(o){s.e(o)}finally{s.f()}c||(i.name=i.name+"_"+n.indexOf(i.name)),n.push(i.name)}}catch(o){a.e(o)}finally{a.f()}return e}(m(t.exposes)));try{for(c.s();!(e=c.n()).done;){var a=e.value,r=a.type;"numeric"===a.type&&(r="number");var s="";a.values&&(s=a.values.join(", "));var o={name:a.name,address:a.property,low:O(a.value_min||a.value_off,0),high:O(a.value_max||a.value_on,1e6),icon:"",type:r,unit:a.unit,values:s,control:a.endpoint||!1};n.push(o)}}catch(d){c.e(d)}finally{c.f()}l("confirmation",{title:"Types",items:v(),active:function(e){return function(e,n){console.log("dfg"),i.show("LinkDevices",null,{typeConnect:"Zigbee_ZigbeeDevice",type:e,address:t.allAddress,valueType:"json",fields:n}),u()}(e,n)}})};return Object(o.jsxs)("div",{className:"NewCardElement",children:[Object(o.jsxs)("div",{className:"NewCardHeader",children:[Object(o.jsx)("div",{className:"typeConnect zigbee",children:Object(o.jsx)("p",{children:"zigbee"})}),Object(o.jsx)("div",{className:"typeConnect zigbee",children:Object(o.jsx)("p",{children:t.address})}),Object(o.jsx)(Je,{className:"DeviceName",id:t.name,text:t.name||"NuN"}),Object(o.jsx)(I,{buttons:function(){var e=[];return t.exposes&&e.push({title:"linc",onClick:f}),"Coordinator"!==t.type&&(e.push({title:"rename",onClick:function(){return l("text",{title:"Rename",text:"input new name",placeholder:"new name",active:j})}}),e.push({title:"delete",onClick:function(){return l("alert",{title:"Delete",text:"Delete device",buttons:[{title:"cancel"},{title:"ok",action:b}]})}})),e}()})]}),t.exposes?Object(o.jsx)("div",{className:"dividers"}):null,Object(o.jsx)("div",{className:"NewCardBody",children:Object(o.jsx)("ul",{children:t.exposes?m(t.exposes).map((function(e,t){return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:e.name})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:e.type})})})]},t)})):null})})]})},Sc=function(){var e=Object(c.useContext)(E),t=Object(c.useContext)(Me).message,n=Object(c.useState)([]),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(c.useState)([]),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Object(c.useState)(""),m=Object(j.a)(b,2),v=m[0],O=m[1],f=Object(c.useState)(!1),p=Object(j.a)(f,2),y=p[0],N=p[1],A=Object(c.useContext)(g).setData,k=B(),C=k.loading,w=k.request,S=Object(c.useCallback)((function(){w("/api/module/zigbee2mqtt/reboot","GET",null,{Authorization:"Bearer ".concat(e.token)})}),[w,e.token]),D=Object(c.useCallback)((function(t){N(t),w("/api/module/zigbee2mqtt/permit_join/set","POST",{state:t},{Authorization:"Bearer ".concat(e.token)})}),[w,e.token]),T=Object(c.useCallback)(Object(x.a)(h.a.mark((function t(){var n,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w("/api/module/zigbee2mqtt/device/all","GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:return n=t.sent,console.log(n),n&&d(n),t.next=8,w("/api/module/zigbee2mqtt/permit_join/get","GET",null,{Authorization:"Bearer ".concat(e.token)});case 8:c=t.sent,N(c.state),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(0);case 14:case"end":return t.stop()}}),t,null,[[0,12]])}))),[w,e.token]);Object(c.useEffect)((function(){T()}),[T]),Object(c.useEffect)((function(){"zigbee"===t.type&&(console.log(t),d(t.data))}),[t]),Object(c.useEffect)((function(){if(""!==v){var e=u.filter((function(e){return e&&-1!==e.name.toLowerCase().indexOf(v.toLowerCase())}));r(e)}else r(u)}),[u,v]);var q=Object(c.useCallback)((function(e){O(e)}),[]);return Object(c.useEffect)((function(){A("Zigbee",{search:q,dopmenu:[{title:"update",onClick:T},{title:"reboot",onClick:S},{title:"pairing mode",active:y,onClick:function(){return D(!y)}}]})}),[A,T,y,S,D,q]),Object(o.jsx)("div",{className:"conteiner bottom",children:C?Object(o.jsx)(H,{}):Object(o.jsx)("div",{className:"Devices",children:Object(o.jsx)("div",{className:"CardConteiner",children:i.map((function(e,t){return Object(o.jsx)(Bc,{data:e},t)}))})})})},Dc=function(){var e=Object(c.useCallback)((function(e,t){try{var n,c=t.split(".").slice(1),a=e,i=Object(p.a)(c);try{for(i.s();!(n=i.n()).done;){var r=n.value;""!==r&&(a=a[r])}}catch(s){i.e(s)}finally{i.f()}return a}catch(l){return null}}),[]),t=Object(c.useCallback)((function(t,n){return"text"===t.type?t.value:"path"===t.type?e(n,t.path):"non"}),[e]);return{gettext:e,getfields:t}},Tc=function(){var e=Dc().getfields,t=Object(c.useContext)(d).show,n=Object(c.useContext)(Zn),a=Object(c.useContext)(G),i=Object(Re.i)().name,r=Object(c.useContext)(E),s=Y().message,l=B(),o=l.request,u=l.error,j=l.clearError;Object(c.useEffect)((function(){s(u,"error"),j()}),[u,s,j]);var b=Object(c.useCallback)((function(){var e;return null===n||void 0===n||null===(e=n.type)||void 0===e?void 0:e.map((function(e){return{title:e.title,data:e.title}}))}),[n]),m=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(n,c,s){var l,u,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n,i),l=Object(p.a)(n),e.prev=2,l.s();case 4:if((u=l.n()).done){e.next=21;break}if("update"!==(d=u.value).type){e.next=10;break}s(),e.next=19;break;case 10:if("request"!==d.type){e.next=15;break}return e.next=13,o(d.address,d.method,d.body,{Authorization:"Bearer ".concat(r.token)});case 13:e.next=19;break;case 15:if("linc"!==d.type||!i||!c){e.next=19;break}return e.delegateYield(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("/api/page/linc/device/".concat(i),"POST",{device:c},{Authorization:"Bearer ".concat(r.token)});case 2:n=e.sent,t("confirmation",{title:"Types",items:b(),active:function(e){a.show("LinkDevices",null,Object(R.a)(Object(R.a)({},n),{},{type:e}))}});case 4:case"end":return e.stop()}}),e)}))(),"t0",17);case 17:e.next=19;break;case 19:e.next=4;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(2),l.e(e.t1);case 26:return e.prev=26,l.f(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[2,23,26,29]])})));return function(t,n,c){return e.apply(this,arguments)}}(),[r.token,o,i,b,t,a]);return{getmenu:Object(c.useCallback)((function(t,n,c){if(null===t||void 0===t?void 0:t.menu){var a,i=[],r=Object(p.a)(t.menu);try{var s=function(){var t=a.value;i.push({title:e(t.title,n),onClick:function(){return m(t.action,n,c)},active:!1})};for(r.s();!(a=r.n()).done;)s()}catch(l){r.e(l)}finally{r.f()}return i}}),[m,e])}},qc=function(e){var t,n=e.conf,c=void 0===n?{}:n,a=e.data,i=void 0===a?{}:a,r=Dc().getfields;return Object(o.jsxs)("div",{className:"NewCardElement",children:[Object(o.jsx)("div",{className:"NewCardHeader",children:Object(o.jsx)(Je,{className:"DeviceName",id:r(null===c||void 0===c?void 0:c.title,i),text:r(null===c||void 0===c?void 0:c.title,i)})}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"NewCardBody",children:Object(o.jsx)("ul",{children:null===c||void 0===c||null===(t=c.fields)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:r(e.title,i)})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:r(e.value,i)})})})]},t)}))})})]})},Lc=function(e){var t=e.data,n=void 0===t?[]:t,c=e.conf,a=Tc().getmenu,i=Dc().getfields;return Object(o.jsx)("div",{className:"mqttTableDiv",children:Object(o.jsxs)("table",{className:"mqttTable",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[null===c||void 0===c?void 0:c.fields.map((function(e,t){return Object(o.jsx)("th",{children:e.title},t)})),c.menu?Object(o.jsx)("th",{className:"menu"}):null]})}),Object(o.jsx)("tbody",{children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(o.jsxs)("tr",{children:[c.fields.map((function(t,n){return Object(o.jsx)("td",{children:i(t.value,e)},n)})),c.menu?Object(o.jsx)("td",{className:"menu",children:Object(o.jsx)(I,{className:"table",buttons:a(c,e,(function(){}))})}):null]},t)}))})]})})},Ic=function(e){var t,n,a,i,r=e.data,s=void 0===r?{}:r,l=e.updateMenu,u=Object(c.useContext)(E),d=Object(c.useContext)(Me),b=Dc(),m=b.getfields,v=b.gettext,O=Tc().getmenu,f=Object(c.useState)([]),p=Object(j.a)(f,2),g=p[0],y=p[1],N=Y().message,A=B(),k=A.request,C=A.error,w=A.clearError,S=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===s||void 0===s?void 0:s.src){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,k(null===s||void 0===s?void 0:s.src,"GET",null,{Authorization:"Bearer ".concat(u.token)});case 4:return t=e.sent,y(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)}))),[k,u.token,s]);return Object(c.useEffect)((function(){(null===s||void 0===s?void 0:s.ws_src)&&d.message.type===(null===s||void 0===s?void 0:s.ws_src)&&y(d.message.data)}),[d.message,null===s||void 0===s?void 0:s.ws_src]),Object(c.useEffect)((function(){N(C,"error"),w()}),[C,N,w]),Object(c.useEffect)((function(){S()}),[S]),Object(c.useEffect)((function(){(null===s||void 0===s?void 0:s.menu)&&l(O(s,g,S))}),[g,s,m,l,S,O]),Object(o.jsx)("div",{className:"conteiner ".concat("table"===(null===s||void 0===s||null===(t=s.content)||void 0===t?void 0:t.typeContent)?"color-normal":""),children:"cards"===(null===s||void 0===s||null===(n=s.content)||void 0===n?void 0:n.typeContent)?Object(o.jsx)("div",{className:"Devices",children:Object(o.jsx)("div",{className:"CardConteiner",children:null===(a=v(g,s.content.rootField))||void 0===a?void 0:a.map((function(e,t){return Object(o.jsx)(qc,{data:e,conf:s.content.items},t)}))})}):"table"===(null===s||void 0===s||null===(i=s.content)||void 0===i?void 0:i.typeContent)?Object(o.jsx)(Lc,{data:v(g,s.content.rootField),conf:s.content.items}):null})},Fc=function(){var e=Object(c.useContext)(E),t=Object(Re.i)().name,n=Object(c.useState)({}),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(c.useState)({}),l=Object(j.a)(s,2),u=l[0],d=l[1],b=Y().message,m=Object(c.useContext)(g).setData,v=B(),O=v.request,f=v.error,p=v.clearError,y=Object(c.useCallback)(Object(x.a)(h.a.mark((function n(){var c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O("/api/page/get/".concat(t),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 2:c=n.sent,console.log(c,null===c||void 0===c?void 0:c.pages[0]),r(c),d(null===c||void 0===c?void 0:c.pages[0]);case 6:case"end":return n.stop()}}),n)}))),[O,t,e.token]),N=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m(null===i||void 0===i?void 0:i.name,{dopmenu:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,null===i||void 0===i?void 0:i.name]);return Object(c.useEffect)((function(){b(f,"error"),p()}),[f,b,p]),Object(c.useEffect)((function(){y()}),[y]),Object(c.useEffect)((function(){m(null===i||void 0===i?void 0:i.name)}),[m,i]),Object(o.jsx)(Ic,{data:u,updateMenu:N})},zc=Object(c.createContext)(),Pc=function(e){var t=e.group,n=e.updata,a=Object(Re.g)(),i=Object(c.useContext)(Me),r=i.devices,s=i.updateDevice,l=Object(c.useContext)(zc),u=Object(c.useContext)(E),d=Y().message,j=B(),b=j.request,m=j.error,v=j.clearError;Object(c.useEffect)((function(){return d(m,"error"),function(){v()}}),[m,d,v]);var O=function(e){return r.filter((function(t){return e.includes(t.systemName)}))},f=function(e){var n,c,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=0,r=O(null===t||void 0===t||null===(n=t.devices)||void 0===n?void 0:n.map((function(e){return e.name}))),s=Object(p.a)(r);try{for(s.s();!(c=s.n()).done;){var l,o=c.value,u=Object(p.a)(o.fields);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(d.name===e&&d.type===a)return null===o||void 0===o?void 0:o.value[e]}}catch(j){u.e(j)}finally{u.f()}}}catch(j){s.e(j)}finally{s.f()}return i},g=function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/group/value/set","POST",{systemName:t,type:n,status:c},{Authorization:"Bearer ".concat(u.token)});case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),y=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/group/delete/".concat(t.systemName),"GET",null,{Authorization:"Bearer ".concat(u.token)});case 2:"function"===typeof n&&n();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?Object(o.jsxs)("div",{className:"NewCardElement",children:[Object(o.jsxs)("div",{className:"NewCardHeader",children:[Object(o.jsx)(Je,{onClick:function(){"online"===(null===t||void 0===t?void 0:t.status)&&(null===t||void 0===t?void 0:t.value)&&a.push("/group/ditail/".concat(t.systemName))},className:"DeviceName",id:t.systemName,text:t.name||"NuN"}),u.userLevel>=3?Object(o.jsx)(I,{buttons:[{title:"edit",onClick:function(){return a.push("/groups/edit/".concat(t.systemName))}},{title:"device",onClick:function(){l.show("deviceInGroup",t,function(){var e=Object(x.a)(h.a.mark((function e(t,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/group/device/edit/".concat(c.systemName),"POST",c,{Authorization:"Bearer ".concat(u.token)});case 2:"function"===typeof n&&n();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},{title:"edit fields",onClick:function(){l.show("fieldInGroup",t,function(){var e=Object(x.a)(h.a.mark((function e(t,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/api/group/field/edit/".concat(c.systemName),"POST",c,{Authorization:"Bearer ".concat(u.token)});case 2:"function"===typeof n&&n();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},{title:"delete",onClick:y}]}):null]}),Object(o.jsx)("div",{className:"dividers"}),Object(o.jsx)("div",{className:"NewCardBody",children:Object(o.jsx)("ul",{children:function(){var e;return null===t||void 0===t||null===(e=t.fields)||void 0===e?void 0:e.map((function(e){return Object(R.a)(Object(R.a)({},e),{},{value:f(e.name,e.type)})}))}().map((function(e,n){return"binary"===e.type&&e.control?Object(o.jsx)(bn,{outValue:g,updata:s,systemName:t.systemName,value:"1"===String(e.value),type:e.name},n):"number"===e.type&&e.control?Object(o.jsx)(vn,{outValue:g,updata:s,systemName:t.systemName,value:Number(e.value),type:e.name,title:e.name,conf:{min:e.low,max:e.high}},n):"number"===e.type&&e.control?Object(o.jsx)(fn,{outValue:g,updata:s,systemName:t.systemName,value:Number(e.value),type:e.name,conf:Number(e.high)},n):"enum"===e.type&&e.control?Object(o.jsx)(xn,{outValue:g,updata:s,systemName:t.systemName,value:e.value,type:e.name,conf:e.values},n):"text"===e.type&&e.control?Object(o.jsx)(gn,{outValue:g,updata:s,systemName:t.systemName,value:e.value,type:e.name,conf:e.values,title:e.name},n):e.control?null:Object(o.jsxs)("li",{className:"DeviceControlLi",children:[Object(o.jsx)("div",{className:"DeviceControlLiName",children:Object(o.jsx)("p",{children:e.name})}),Object(o.jsx)("div",{className:"DeviceControlLiContent",children:Object(o.jsx)("div",{className:"DeviceControlLiValue",children:Object(o.jsx)("p",{children:f(e.name,e.type)})})})]},n)}))})})]}):null},Mc=(xc={},Object(V.a)(xc,pe,(function(e,t){var n=t.payload;return Object(R.a)(Object(R.a)({},n),{},{visible:!0})})),Object(V.a)(xc,ge,(function(e){return Object(R.a)(Object(R.a)({},e),{},{visible:!1})})),Object(V.a)(xc,"DEFAULT",(function(e){return e})),xc),Uc=function(e,t){return(Mc[t.type]||Mc.DEFAULT)(e,t)},Gc=function(e){},Rc=function(e){var t=e.value,n=e.onClick,a=void 0===n?Gc:n,i=Object(c.useState)(t||!1),r=Object(j.a)(i,2),s=r[0],l=r[1];return Object(o.jsx)("div",{className:"switchContainer",children:Object(o.jsxs)("label",{className:"switch",children:[Object(o.jsx)("input",{onChange:function(e){l(e.target.checked),a(e.target.checked)},name:"auteStyle",type:"checkbox",checked:s}),Object(o.jsx)("span",{}),Object(o.jsx)("i",{className:"indicator"})]})})},Hc=function(e){var t,n=e.device,a=e.onClick,i=e.setGroupDevice,r=e.groupDevice,s=e.added,l=void 0!==s&&s,u=e.field,d=void 0!==u&&u,b=Object(c.useState)(!1),m=Object(j.a)(b,2),v=m[0],O=m[1];return Object(o.jsxs)("li",{name:"HidingLi",className:"hidingLi ".concat(v?"show":"hide"),children:[Object(o.jsxs)("h3",{value:"HidingLi",className:"LiTitle",children:[null===n||void 0===n?void 0:n.name," ",null===n||void 0===n?void 0:n.systemName]}),d?Object(o.jsx)("i",{value:"HidingLi",className:"iconOpenField fas fa-chevron-down",onClick:function(e){"hidingLi"!==e.target.className.split(" ")[0]&&"hidingLi"!==e.target.parentNode.className.split(" ")[0]||O(!v)}}):null,Object(o.jsx)("i",{value:"HidingLi",className:"iconAdded ".concat(l?"added":""," fas fa-plus"),onClick:a}),d?Object(o.jsx)("div",{className:"LiContent",children:null===n||void 0===n||null===(t=n.fields)||void 0===t?void 0:t.map((function(e,t){return Object(o.jsxs)("div",{className:"devEl",children:[Object(o.jsx)("p",{children:e.name}),Object(o.jsx)(Rc,{onClick:function(t){return function(e,t,n){var c=r.fields.slice();e||(c=c.filter((function(e){return e.name!==t}))),e&&c.push({name:t,type:n}),i(Object(R.a)(Object(R.a)({},r),{},{fields:c}))}(t,e.name,e.type)},value:(n=e.name,0!==r.fields.filter((function(e){return e.name===n})).length)})]},t);var n}))}):null]})},Yc=function(){var e=Object(c.useContext)(zc),t=e.form,n=e.hide,a=Object(c.useContext)(Me).devices,i=Object(c.useState)([]),r=Object(j.a)(i,2),s=r[0],l=r[1],u=Object(c.useState)([]),d=Object(j.a)(u,2),b=d[0],m=d[1];Object(c.useEffect)((function(){l(t.group.devices),m(t.group.fields)}),[t.group]);var v=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.OK(s,Object(R.a)(Object(R.a)({},t.group),{},{devices:s,fields:b})),n();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e,t){var n,c=e.slice(),a=Object(p.a)(t);try{var i=function(){var e=r=n.value;0===c.filter((function(t){return e.name===t.name})).length&&c.push(r)};for(a.s();!(n=a.n()).done;){var r;i()}}catch(s){a.e(s)}finally{a.f()}return c},f=function(e){var t,n=function(e){return a.filter((function(t){return e.includes(t.systemName)}))}(e.map((function(e){return e.name}))),c=[],i=Object(p.a)(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;c=O(c,r.fields)}}catch(s){i.e(s)}finally{i.f()}c=c.map((function(e){return{name:e.name,type:e.type,low:e.low,high:e.high,values:e.values,control:e.control,icon:e.icon,unit:e.unit}})),console.log(c),m(c)},g=function(e){l(s.map((function(t){return t.name===e.name?e:t})))};return Object(o.jsx)("div",{className:"form",children:Object(o.jsxs)("div",{className:"editDevicesForm",children:[Object(o.jsx)("h4",{className:"form-headline",children:"added device"}),0===s.length?Object(o.jsx)("p",{children:"not element"}):s.map((function(e,t){return Object(o.jsx)(Hc,{device:(n=e.name,a.filter((function(e){return e.systemName===n}))[0]),onClick:function(){return function(e){var t=s.filter((function(t){return t.name!==e.name}));l(t),f(t)}(e)},groupDevice:e,setGroupDevice:g,added:!0},t);var n})),Object(o.jsx)("h4",{className:"form-headline",children:"other device"}),function(){var e,t=a,n=Object(p.a)(s);try{var c=function(){var n=e.value;t=t.filter((function(e){return e.systemName!==n.name}))};for(n.s();!(e=n.n()).done;){c()}}catch(i){n.e(i)}finally{n.f()}return t}().map((function(e,t){return Object(o.jsx)(Hc,{device:e,onClick:function(){return function(e){var t=s.slice();t.push({name:e.systemName,fields:e.fields.map((function(e){return{name:e.name,type:e.type}}))}),l(t),f(t)}(e)}},t)})),Object(o.jsx)("div",{className:"controlForm",children:Object(o.jsx)("button",{className:"formEditBtn",onClick:v,children:"Save"})})]})})},Vc=function(){var e=Object(c.useContext)(zc),t=e.form,n=e.hide,a=Object(c.useContext)(Me).getDevice,i=Object(c.useState)([]),r=Object(j.a)(i,2),s=r[0],l=r[1];Object(c.useEffect)((function(){l(t.group.fields)}),[t.group]);var u=function(e){var n,c=[],i=Object(p.a)(t.group.devices);try{for(i.s();!(n=i.n()).done;){var r,s=n.value,l=a(s.name),o=Object(p.a)(l.fields);try{for(o.s();!(r=o.n()).done;){var u=r.value;u.name!==e||c.includes(u.type)||c.push(u.type)}}catch(d){o.e(d)}finally{o.f()}}}catch(d){i.e(d)}finally{i.f()}return c},d=function(e){var n,c=Object(p.a)(t.group.devices);try{for(c.s();!(n=c.n()).done;){var i,r=n.value,s=a(r.name),l=Object(p.a)(s.fields);try{for(l.s();!(i=l.n()).done;){var o=i.value;if(o.name===e&&o.control)return[!0,!1]}}catch(u){l.e(u)}finally{l.f()}}}catch(u){c.e(u)}finally{c.f()}return[!1]},b=function(e){var t=e.target.dataset.id,n=s.slice(),c=Object(R.a)(Object(R.a)({},n[t]),{},Object(V.a)({},e.target.name,e.target.value));n[t]=c,l(n)},m=function(e,t){var n=t,c=s.slice(),a=Object(R.a)(Object(R.a)({},c[n]),{},{icon:e});c[n]=a,l(c)},v=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.OK(s,Object(R.a)(Object(R.a)({},t.group),{},{fields:s})),n();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsx)("div",{className:"form",children:Object(o.jsx)("div",{className:"editDevicesForm",children:Object(o.jsxs)("ul",{className:"editDevice",children:[Object(o.jsx)("li",{children:Object(o.jsxs)("label",{children:[Object(o.jsx)("h5",{children:"Name - ".concat(t.group.name)}),Object(o.jsx)("h5",{children:"systemName - ".concat(t.group.systemName)})]})}),s.map((function(e,t){return Object(o.jsxs)(K,{title:e.name,children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("select",{"data-id":t,name:"type",value:e.type,onChange:b,children:u(e.name).map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},t)}))}),Object(o.jsx)("label",{children:"type"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("select",{"data-id":t,name:"control",value:e.control,onChange:b,children:d(e.name).map((function(e,t){return Object(o.jsx)("option",{value:e,children:String(e)},t)}))}),Object(o.jsx)("label",{children:"control"})]})}),"number"===e.type||"binary"===e.type?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"low",value:e.low,onChange:b,required:!0}),Object(o.jsx)("label",{children:"min"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"range"===e.type?"number":"text",name:"high",value:e.high,onChange:b,required:!0}),Object(o.jsx)("label",{children:"max"})]})})]}):"enum"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,type:"text",name:"values",value:e.values,onChange:b,required:!0}),Object(o.jsx)("label",{children:"enum"})]})}):null,Object(o.jsx)(W,{dataId:t,value:e.icon,onChange:m}),"number"===e.type?Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{"data-id":t,name:"unit",value:e.unit,onChange:b,required:!0}),Object(o.jsx)("label",{children:"unit"})]})}):null]},t)})),Object(o.jsx)("div",{className:"controlForm",children:Object(o.jsx)("button",{className:"formEditBtn",onClick:v,children:"Save"})})]})})})},Kc=function(){var e=Object(c.useContext)(zc),t=e.form,n=e.hide;if(!t.visible)return null;var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n(),t.OK&&t.OK(e)};return"deviceInGroup"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)(Yc,{hide:a})}):"fieldInGroup"===t.type?Object(o.jsx)(ee,{onClick:n,children:Object(o.jsx)(Vc,{hide:a})}):void 0},Jc=function(e){var t=e.children,n=Object(c.useReducer)(Uc,{visible:!1}),a=Object(j.a)(n,2),i=a[0],r=a[1];return Object(o.jsxs)(zc.Provider,{value:{show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"deviceInGroup",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;r({type:pe,payload:{type:e,group:t,OK:n}})},hide:function(){r({type:ge})},form:i},children:[Object(o.jsx)(Kc,{}),t]})},Wc=function(){var e=Object(Re.g)(),t=Object(c.useContext)(E),n=Object(c.useContext)(Ue),a=n.updata,i=n.groups,r=Object(c.useState)([]),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useContext)(g).setData,b=Object(c.useState)([]),m=Object(j.a)(b,2),v=m[0],O=m[1];Object(c.useEffect)((function(){u(i),O(i)}),[i]),Object(c.useEffect)((function(){a()}),[a]);var f=Object(c.useCallback)((function(e){if(""!==e){var t=l.filter((function(t){return t&&-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}));O(t)}else O(l)}),[l]);return Object(c.useEffect)((function(){d("Groups All",{specialAction:t.userLevel>=3?{type:"add",action:function(){return e.push("/groups/add")}}:null,search:f})}),[d,e,f,t.userLevel]),Object(o.jsx)(Jc,{children:Object(o.jsx)("div",{className:"conteiner top bottom",children:Object(o.jsx)("div",{className:"Devices",children:v&&0!==v.length?Object(o.jsx)("div",{className:"CardConteiner",children:v.map((function(e,t){return Object(o.jsx)(Pc,{group:e,updata:a},t)}))}):Object(o.jsx)("h2",{className:"empty",children:"Not elements"})})})})},_c=function(){var e=Object(Re.i)().id,t=Object(Re.g)(),n=Object(c.useContext)(E),a=Object(c.useContext)(g).setData,i=Y().message,r=B(),s=r.request,l=r.error,u=r.clearError,d=Object(c.useState)({name:"",systemName:"",devices:[]}),b=Object(j.a)(d,2),m=b[0],v=b[1],O=function(e){v(Object(R.a)(Object(R.a)({},m),{},Object(V.a)({},e.target.name,e.target.value)))};Object(c.useEffect)((function(){return i(l,"error"),function(){u()}}),[l,i,u]),Object(c.useEffect)((function(){a("Groups add")}),[a]);var f=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s("/api/group/get/".concat(t),"GET",null,{Authorization:"Bearer ".concat(n.token)});case 2:(c=e.sent)&&v({name:c.name,systemName:c.systemName,devices:[]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n.token,s]);Object(c.useEffect)((function(){e&&f(e)}),[e,f]);var p=function(){var c=Object(x.a)(h.a.mark((function c(){return h.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(m.name&&m.systemName){c.next=2;break}return c.abrupt("return");case 2:if(!e){c.next=7;break}return c.next=5,s("/api/group/edit/".concat(e),"POST",m,{Authorization:"Bearer ".concat(n.token)});case 5:c.next=9;break;case 7:return c.next=9,s("/api/group/add","POST",m,{Authorization:"Bearer ".concat(n.token)});case 9:t.push("/groups");case 10:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return Object(o.jsx)("div",{className:"fullScrinContainer color-normal",children:Object(o.jsxs)("div",{className:"allFon",children:[Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:O,required:!0,name:"name",type:"text",value:m.name}),Object(o.jsx)("label",{children:"Name"})]})}),Object(o.jsx)("div",{className:"configElement",children:Object(o.jsxs)("div",{className:"input-data",children:[Object(o.jsx)("input",{onChange:O,required:!0,name:"systemName",type:"text",value:m.systemName}),Object(o.jsx)("label",{children:"System name"})]})}),Object(o.jsx)("div",{className:"buttons",children:Object(o.jsx)("button",{style:{marginLeft:"10px"},className:"highSelection button",onClick:p,children:"Next"})})]})})},Qc=n.p+"static/media/fon-base.e46203d1.jpg";function Xc(e,t){var n=!1;"#"===e[0]&&(e=e.slice(1),n=!0);var c=parseInt(e,16),a=(c>>16)+t;a>255?a=255:a<0&&(a=0);var i=(c>>8&255)+t;i>255?i=255:i<0&&(i=0);var r=(255&c)+t;return r>255?r=255:r<0&&(r=0),(n?"#":"")+(r|i<<8|a<<16).toString(16)}var Zc=function(){document.body.style="background: url(".concat(Qc,");\n    background-size: cover;\n    background-attachment: fixed;")},$c=function(){ta({c1:"#303030",c2:"#505050",c3:"#707070",active:"#1E90FF",ok:"#00d22d"})},ea=function(e){var t="gray";"#"===e[0]&&(e=e.slice(1));var n=parseInt(e,16);return(n>>16<200||(255&n)<200||(n>>8&255)<200)&&(t="#fff"),t};function ta(e){document.body.style.setProperty("--color-base",e.opasiryc1?e.c1+"dd":e.c1),document.body.style.setProperty("--color-normal",e.opasiryc2?e.c2+"dd":e.c2),document.body.style.setProperty("--color-active",e.active),document.body.style.setProperty("--color-error",e.error),document.body.style.setProperty("--color-ok",e.ok),document.body.style.setProperty("--btn-color-base",Xc(e.c1,25)),document.body.style.setProperty("--btn-color-normal",Xc(e.c2,25)),document.body.style.setProperty("--btn-color-active",Xc(e.active,25)),document.body.style.setProperty("--text-color-base-fon",ea(e.c1)),document.body.style.setProperty("--text-color-normal-fon",ea(e.c2)),document.body.style.setProperty("--text-color-active-fon","#fff"),document.body.style.setProperty("--color-glass",e.c2+"90")}var na=function(){var e=(new Date).getHours(),t=(new Date).getMonth(),n=t<3||t>8?17:20,c=t<3||t>8?15:18,a=t<3||t>8?5:3,i=t<3||t>8?10:8;return e>=a&&e<i?"sunrise":e>=i&&e<c?"day":e>=c&&e<n?"twilight":e>=0&&e<a||e>=n?"night":"sunrise"},ca=function(){var e=Object(c.useCallback)((function(e){if(!e)return $c();e.c1||(e.c1="#333"),e.c2||(e.c2="#555"),e.c3||(e.c3="#777"),e.active||(e.active="#1E90FF"),e.ok||(e.ok="#00d22d"),ta(e)}),[]),t=Object(c.useCallback)((function(e){if(!e)return Zc();document.body.style="background: url(".concat(e,");\n      background-size: cover;\n      background-attachment: fixed;")}),[]),n=Object(c.useCallback)((function(e){var n;if(!e)return Zc();t(null===(n=function(e,t){try{var n,c=Object(p.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(t===a.type)return a}}catch(i){c.e(i)}finally{c.f()}}catch(r){return}}(e,na()))||void 0===n?void 0:n.image)}),[t]),a=Object(c.useCallback)((function(t,n){if(!t||!n)return $c();"night"===na()?e(n):e(t)}),[e]);return{setStyle:e,setBackground:t,adaptiveBackground:n,avtoNightStyle:a}},aa=function(e,t){try{var n,c=Object(p.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(t===a.name)return a}}catch(i){c.e(i)}finally{c.f()}}catch(r){return}},ia=function(){var e=Object(Re.g)(),t=Object(c.useContext)(E),n=Object(c.useContext)(S),a=Object(c.useContext)(an),i=a.styles,r=a.updateConfig,s=Y().message,l=B(),u=l.request,d=l.error,b=l.clearError,m=ca().setStyle,v=Object(c.useState)(aa(i,n.Style)),O=Object(j.a)(v,2),f=O[0],p=O[1],g=function(e){p(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.value))),m(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.value)))},y=function(e){p(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.checked))),m(Object(R.a)(Object(R.a)({},f),{},Object(V.a)({},e.target.name,e.target.checked)))},N=function(){m(aa(i,n.Style)),e.goBack()};Object(c.useEffect)((function(){return s(d,"error"),function(){b()}}),[d,s,b]);var A=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.name){e.next=2;break}return e.abrupt("return",s("name empty","error"));case 2:return e.next=4,u("/api/style/add","POST",f,{Authorization:"Bearer ".concat(t.token)});case 4:r(),N();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(Wt,{}),Object(o.jsx)("div",{className:"backGlass",onClick:N}),Object(o.jsxs)("div",{className:"editStylePanel",children:[Object(o.jsxs)("div",{className:"colors",children:[Object(o.jsxs)("div",{className:"boxFieldColor",children:[Object(o.jsxs)("div",{className:"colorfield",children:[Object(o.jsx)("p",{children:"color 1"}),Object(o.jsx)("input",{type:"color",value:null===f||void 0===f?void 0:f.c1,name:"c1",onChange:g})]}),Object(o.jsxs)("div",{className:"opasityfield",children:[Object(o.jsx)("p",{children:"opasity"}),Object(o.jsx)("input",{type:"checkbox",checked:null===f||void 0===f?void 0:f.opasiryc1,name:"opasiryc1",onChange:y})]})]}),Object(o.jsxs)("div",{className:"boxFieldColor",children:[Object(o.jsxs)("div",{className:"colorfield",children:[Object(o.jsx)("p",{children:"color 2"}),Object(o.jsx)("input",{type:"color",value:null===f||void 0===f?void 0:f.c2,name:"c2",onChange:g})]}),Object(o.jsxs)("div",{className:"opasityfield",children:[Object(o.jsx)("p",{children:"opasity"}),Object(o.jsx)("input",{type:"checkbox",checked:null===f||void 0===f?void 0:f.opasiryc2,name:"opasiryc2",onChange:y})]})]}),Object(o.jsxs)("div",{className:"boxFieldColor",children:[Object(o.jsxs)("div",{className:"colorfield",children:[Object(o.jsx)("p",{children:"color active"}),Object(o.jsx)("input",{type:"color",value:null===f||void 0===f?void 0:f.active,name:"active",onChange:g})]}),Object(o.jsxs)("div",{className:"opasityfield",children:[Object(o.jsx)("p",{children:"opasity"}),Object(o.jsx)("input",{type:"checkbox",checked:null===f||void 0===f?void 0:f.opasiryActive,name:"opasiryActive",onChange:y})]})]}),Object(o.jsx)("div",{className:"boxFieldColor",children:Object(o.jsxs)("div",{className:"colorfield",children:[Object(o.jsx)("p",{children:"color ok"}),Object(o.jsx)("input",{type:"color",value:null===f||void 0===f?void 0:f.ok,name:"ok",onChange:g})]})}),Object(o.jsx)("div",{className:"boxFieldColor",children:Object(o.jsxs)("div",{className:"colorfield",children:[Object(o.jsx)("p",{children:"color error"}),Object(o.jsx)("input",{type:"color",value:null===f||void 0===f?void 0:f.error,name:"error",onChange:g})]})})]}),Object(o.jsxs)("div",{className:"nameField",children:[Object(o.jsx)("input",{type:"text",value:null===f||void 0===f?void 0:f.name,placeholder:"name",name:"name",onChange:g}),Object(o.jsx)("button",{onClick:A,children:"create"})]})]})]})};function ra(){var e=Object(c.useContext)(g).setData,t=Object(c.useContext)(E),n=Object(Re.g)(),a=B(),i=a.loading,r=a.request,s=a.error,u=a.clearError,d=Y().message,b=Object(c.useContext)(l).show,m=Object(c.useState)({name:"",password:"",email:"",mobile:""}),v=Object(j.a)(m,2),O=v[0],f=v[1];Object(c.useEffect)((function(){e("Add user")}),[e]),Object(c.useEffect)((function(){d(s,"error"),u()}),[s,d,u]);var p=function(e){f(Object(R.a)(Object(R.a)({},O),{},Object(V.a)({},e.target.name,e.target.value)))},y=function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("/api/user/add","POST",Object(R.a)({},O),{Authorization:"Bearer ".concat(t.token)});case 3:e.sent&&(n.push("/"),b("user registered","ok")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("div",{className:"conteiner top",children:[Object(o.jsx)("div",{className:"title",children:Object(o.jsx)("h1",{children:"Create user"})}),Object(o.jsx)("div",{className:"container-reg",children:Object(o.jsxs)("form",{children:[Object(o.jsxs)("div",{className:"main-reg clearfix",children:[Object(o.jsx)("div",{className:"left-reg",children:Object(o.jsxs)("div",{className:"formBox-reg",children:[Object(o.jsx)("p",{children:"userName"}),Object(o.jsx)("input",{placeholder:"UserName",id:"userName",type:"text",name:"name",required:!0,onChange:p}),Object(o.jsx)("p",{children:"password"}),Object(o.jsx)("input",{placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022",id:"password",type:"password",name:"password",required:!0,onChange:p})]})}),Object(o.jsx)("div",{className:"right-reg",children:Object(o.jsxs)("div",{className:"formBox-reg",children:[Object(o.jsx)("p",{children:"Email"}),Object(o.jsx)("input",{placeholder:"Email",id:"email",type:"email",name:"email",onChange:p}),Object(o.jsx)("p",{children:"Mobile"}),Object(o.jsx)("input",{placeholder:"mobile",id:"mobile",type:"tel",name:"mobile",maxleght:"5",onChange:p})]})})]}),Object(o.jsx)("div",{className:"footer-reg",children:Object(o.jsx)("div",{className:"formBox-reg",children:Object(o.jsx)("input",{type:"submit",onClick:y,disabled:i,value:"Create"})})})]})})]})}var sa="UserData",la=function(e){var t=e.children,n=e.token,a=e.ready,i=B(),r=i.request,s=i.error,l=i.clearError,u=Object(c.useContext)(Me).message,d=Object(c.useState)({}),b=Object(j.a)(d,2),m=b[0],v=b[1],O=Object(c.useState)({}),f=Object(j.a)(O,2),g=f[0],y=f[1],N=Object(c.useState)([]),A=Object(j.a)(N,2),k=A[0],C=A[1],w=Object(c.useState)(null),E=Object(j.a)(w,2),D=E[0],T=E[1],q=Object(c.useState)(!1),L=Object(j.a)(q,2),I=L[0],F=L[1],z=ca(),P=z.setStyle,M=z.avtoNightStyle,U=z.adaptiveBackground,G=z.setBackground,H=Object(c.useCallback)((function(e,t){try{var n,c=Object(p.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(t===a.name)return a}}catch(i){c.e(i)}finally{c.f()}}catch(r){return}}),[]),Y=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r("/api/style/all","GET",null,{Authorization:"Bearer ".concat(n)});case 2:return t=e.sent,e.next=5,r("/api/user/config/get","GET",null,{Authorization:"Bearer ".concat(n)});case 5:return c=e.sent,C(t),v(c),e.abrupt("return",{dataStyles:t,dataUserConf:c});case 9:case"end":return e.stop()}}),e)}))),[r,n]),V=Object(c.useCallback)((function(e){var t,n,c,a,i,r,s=H(null===e||void 0===e?void 0:e.dataStyles,null===e||void 0===e||null===(t=e.dataUserConf)||void 0===t?void 0:t.Style);T(s),(null===e||void 0===e||null===(n=e.dataUserConf)||void 0===n?void 0:n.staticBackground)?G(null===(a=function(e,t){try{var n,c=Object(p.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;if(t===a.type)return a}}catch(i){c.e(i)}finally{c.f()}}catch(r){return}}(null===e||void 0===e||null===(i=e.dataUserConf)||void 0===i?void 0:i.images,"base"))||void 0===a?void 0:a.image):U(null===e||void 0===e||null===(c=e.dataUserConf)||void 0===c?void 0:c.images),(null===e||void 0===e||null===(r=e.dataUserConf)||void 0===r?void 0:r.auteStyle)?M(s,H(null===e||void 0===e?void 0:e.dataStyles,"night")):P(s)}),[M,G,U,H,P]),K=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}return console.error("no authtorization"),G(),P(),e.abrupt("return");case 5:return e.next=7,Y();case 7:t=e.sent,V(t);case 9:case"end":return e.stop()}}),e)}))),[n,Y,V,P,G]);return Object(c.useEffect)((function(){(a||I)&&K()}),[a,K,I]),Object(c.useEffect)((function(){return s&&console.error(s),function(){l()}}),[s,l]),Object(c.useEffect)((function(){"server"===u.type&&(y(u.data),V({dataStyles:k,dataUserConf:m}))}),[u,V,k,m]),Object(o.jsx)(S.Provider,{value:Object(R.a)(Object(R.a)({},m),{},{getData:Y}),children:Object(o.jsx)($e.Provider,{value:Object(R.a)({},g),children:Object(o.jsx)(an.Provider,{value:{styles:k,updateConfig:function(){F(!0),setTimeout((function(){F(!1)}),400)},nawstyle:D},children:t})})})},oa=function(e){var t=e.children,n=e.token,a=Object(c.useState)([]),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Y().message,u=B(),d=u.request,b=u.error,m=u.clearError,v=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d("/api/group/all","get",null,{Authorization:"Bearer ".concat(n)});case 4:(t=e.sent)&&s(t);case 6:case"end":return e.stop()}}),e)}))),[d,n]),O=Object(c.useCallback)((function(e){return r.filter((function(t){return t.systemName===e}))[0]}),[r]);return Object(c.useEffect)((function(){v()}),[v]),Object(c.useEffect)((function(){return l(b,"error"),function(){m()}}),[b,l,m]),Object(o.jsx)(Ue.Provider,{value:{groups:r,updata:v,getGroup:O},children:t})},ua=function(){var e=Object(c.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(o.jsxs)("div",{className:"terminal",children:[Object(o.jsx)("textarea",{id:"area",readOnly:!0,onClick:function(){return document.getElementById("terminalInput").focus()}}),Object(o.jsx)("div",{className:"terminalInput",children:Object(o.jsx)("input",{id:"terminalInput",type:"text",onKeyDown:function(e){if(13===e.keyCode){if(!n)return;var t=document.getElementById("area");t.value=t.value+"You:".concat(n,"\n"),a(""),e.preventDefault()}},onChange:function(e){return a(e.target.value)},value:n})})]})},da=function(){var e=Object(c.useContext)(Le),t=e.terminal,n=e.hide;return t.visible?Object(o.jsx)(He,{hide:n,width:250,height:350,title:"terminal",children:Object(o.jsx)(ua,{})}):null},ja=function(e){var t=e.children,n=Object(c.useContext)(E),a=Object(c.useState)([]),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useRef)(null),v=Object(c.useRef)(null),O=Object(c.useCallback)((function(){try{var e="ws://".concat(window.location.host,"/ws/base");m.current=new WebSocket(e)}catch(t){setTimeout((function(){O()}),500)}}),[]),f=Object(c.useCallback)((function(){n.isAuthenticated&&(O(),m.current&&(m.current.onopen=function(){console.log("connect"),clearInterval(v.current),m.current.onmessage=function(e){var t=JSON.parse(e.data);console.log(t.message),t.message instanceof Object&&("devices"===t.message.type&&s(t.message.data),b(t.message))},m.current.onerror=function(){m.current.close()},m.current.onclose=function(){console.log("desconnect"),v.current=setInterval((function(){f()}),1e4)}}))}),[n.isAuthenticated,O]),h=Object(c.useCallback)((function(e){return r&&r[0]?r.filter((function(t){return(null===t||void 0===t?void 0:t.systemName)===e}))[0]:null}),[r]);return Object(c.useEffect)((function(){return f(),function(){if(m.current)return m.current.close()}}),[f]),Object(o.jsx)(Me.Provider,{value:{devices:r,message:d,getDevice:h},children:t})},ba=function(e){var t=e.children,n=e.token,a=e.ready,i=B().request,r=Object(c.useState)([]),s=Object(j.a)(r,2),l=s[0],u=s[1],d=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i("/api/device/types/get","GET",null,{Authorization:"Bearer ".concat(n)});case 3:t=e.sent,u(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[i,n]);return Object(c.useEffect)((function(){a&&d()}),[a,d]),Object(o.jsx)(Zn.Provider,{value:{type:l},children:t})},ma=Object(c.createContext)(),va=function(e){var t=e.children,n=e.token,a=B(),i=a.request,r=a.error,s=a.clearError,l=Object(c.useState)({}),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(c.useCallback)(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("/api/page/all","GET",null,{Authorization:"Bearer ".concat(n)});case 2:t=e.sent,console.log(t),b(t);case 5:case"end":return e.stop()}}),e)}))),[i,n]);return Object(c.useEffect)((function(){m()}),[m]),Object(c.useEffect)((function(){return r&&console.error(r),function(){s()}}),[r,s]),Object(o.jsx)(ma.Provider,{value:{pages:d,getPages:m},children:t})};n(41),n(42),n(43),n(44);var Oa=function(){var e=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(null),r=Object(j.a)(i,2),s=r[0],l=r[1],o=Object(c.useState)(null),u=Object(j.a)(o,2),d=u[0],b=u[1],m=Object(c.useState)(!1),v=Object(j.a)(m,2),O=v[0],f=v[1],p=Object(c.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t,n,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(t),l(n),b(c),e.next=5,localStorage.setItem(sa,JSON.stringify({userId:n,userLevel:c,token:t}));case 5:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),[]),g=Object(c.useCallback)((function(){a(null),l(null),b(null),localStorage.removeItem(sa)}),[]);return Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem(sa));e&&e.token&&p(e.token,e.userId,e.userLevel),f(!0)}),[p]),{login:p,logout:g,token:n,userId:s,userLevel:d,ready:O}}(),t=e.token,n=e.login,a=e.logout,i=e.userId,r=e.userLevel,l=e.ready,d=!!t,b=function(e,t){return e?Object(o.jsxs)(Re.d,{children:[Object(o.jsx)(Re.b,{path:"/home",exact:!0,children:Object(o.jsx)(Wt,{})}),Object(o.jsx)(Re.b,{path:"/devices",exact:!0,children:Object(o.jsx)(Nn,{})}),Object(o.jsx)(Re.b,{path:"/scripts",exact:!0,children:Object(o.jsx)(Tn,{})}),Object(o.jsx)(Re.b,{path:"/scripts/add",exact:!0,children:Object(o.jsx)(Kn,{})}),Object(o.jsx)(Re.b,{path:"/scripts/edit/:id",children:Object(o.jsx)(Kn,{edit:!0})}),Object(o.jsx)(Re.b,{path:"/profile",children:Object(o.jsx)(An,{})}),Object(o.jsx)(Re.b,{path:"/groups",exact:!0,children:Object(o.jsx)(Wc,{})}),Object(o.jsx)(Re.b,{path:"/groups/add",exact:!0,children:Object(o.jsx)(_c,{})}),Object(o.jsx)(Re.b,{path:"/groups/edit/:id",exact:!0,children:Object(o.jsx)(_c,{})}),Object(o.jsx)(Re.b,{path:"/config/style",exact:!0,children:Object(o.jsx)(ia,{})}),Object(o.jsx)(Re.b,{path:"/config/users",exact:!0,children:t>=3?Object(o.jsx)(Sn,{}):Object(o.jsx)(Re.a,{to:"/config"})}),Object(o.jsx)(Re.b,{path:"/config/server",exact:!0,children:t>=3?Object(o.jsx)(Sn,{}):Object(o.jsx)(Re.a,{to:"/config"})}),Object(o.jsx)(Re.b,{path:"/config",children:Object(o.jsx)(Sn,{})}),Object(o.jsx)(Re.b,{path:"/users",children:Object(o.jsx)(Wn,{})}),Object(o.jsx)(Re.b,{path:"/devices/add",exact:!0,children:Object(o.jsx)(dc,{})}),Object(o.jsx)(Re.b,{path:"/user/add",exact:!0,children:Object(o.jsx)(ra,{})}),Object(o.jsx)(Re.b,{path:"/gallery",children:Object(o.jsx)(Xn,{})}),Object(o.jsx)(Re.b,{path:"/chart",children:Object(o.jsx)(Nc,{})}),Object(o.jsx)(Re.b,{path:"/moduls/:name",children:Object(o.jsx)(Fc,{})}),Object(o.jsx)(Re.b,{path:"/movie/add",exact:!0,children:Object(o.jsx)(jc,{})}),Object(o.jsx)(Re.b,{path:"/serial/add",exact:!0,children:Object(o.jsx)(jc,{type:"serial"})}),Object(o.jsx)(Re.b,{path:"/actor/add",exact:!0,children:Object(o.jsx)(bc,{})}),Object(o.jsx)(Re.b,{path:"/ganre/add",exact:!0,children:Object(o.jsx)(mc,{})}),Object(o.jsx)(Re.b,{path:"/category/add",exact:!0,children:Object(o.jsx)(mc,{type:"category"})}),Object(o.jsx)(Re.b,{path:"/devices/ditail/:systemName",children:Object(o.jsx)(dn,{})}),Object(o.jsx)(Re.b,{path:"/mqtt",exact:!0,children:Object(o.jsx)(Ec,{})}),Object(o.jsx)(Re.b,{path:"/zigbee2mqtt",exact:!0,children:Object(o.jsx)(Sc,{})}),Object(o.jsx)(Re.b,{path:"/movie/edit/:id",children:Object(o.jsx)(jc,{edit:!0})}),Object(o.jsx)(Re.b,{path:"/serial/edit/:id",children:Object(o.jsx)(jc,{type:"serial",edit:!0})}),Object(o.jsx)(Re.b,{path:"/actor/edit/:id",children:Object(o.jsx)(bc,{edit:!0})}),Object(o.jsx)(Re.b,{path:"/ganre/edit/:id",children:Object(o.jsx)(mc,{edit:!0})}),Object(o.jsx)(Re.b,{path:"/category/edit/:id",children:Object(o.jsx)(mc,{type:"category",edit:!0})}),Object(o.jsx)(Re.b,{path:"/movie/:id",exact:!0,children:Object(o.jsx)(Ac,{})}),Object(o.jsx)(Re.b,{path:"/serial/:id",exact:!0,children:Object(o.jsx)(Ac,{type:"serial"})}),Object(o.jsx)(Re.a,{to:"/home"})]}):Object(o.jsxs)(Re.d,{children:[Object(o.jsx)(Re.b,{path:"/",exact:!0,children:Object(o.jsx)(_t,{})}),Object(o.jsx)(Re.a,{to:"/"})]})}(d,r);return l?Object(o.jsx)(E.Provider,{value:{token:t,login:n,logout:a,userId:i,userLevel:r,isAuthenticated:d},children:Object(o.jsx)(va,{token:t,children:Object(o.jsx)(Se,{children:Object(o.jsx)(ja,{children:Object(o.jsx)(Ae,{children:Object(o.jsx)(we,{children:Object(o.jsx)(la,{token:t,ready:l,children:Object(o.jsx)(ba,{token:t,ready:l,children:Object(o.jsx)(oa,{token:t,children:Object(o.jsx)(qe,{children:Object(o.jsx)(ze,{children:Object(o.jsx)(Ge,{children:Object(o.jsx)(s.a,{children:Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(O,{}),Object(o.jsx)(u,{}),Object(o.jsx)(ae,{}),Object(o.jsx)(da,{}),d?Object(o.jsx)(U,{}):null,b]})})})})})})})})})})})})})}):Object(o.jsx)("h1",{children:"Loding"})},fa=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};r.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(Oa,{})}),document.getElementById("root")),fa()}},[[45,1,2]]]);
//# sourceMappingURL=main.6862ed3c.chunk.js.map